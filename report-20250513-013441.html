
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }
                h1 { color: #2c3e50; }
                h2 { color: #34495e; }
                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }
                section { margin-bottom: 30px; }
            </style>
        </head>
        <body>
        <h1>Kubernetes 장애 점검 리포트</h1>
        <section><h2>입력된 키워드: <code>crash</code></h2></section>
        <section><h2>DEBUG: kubectl get pods 결과</h2><pre>auth                        dex-7b97f48486-q9h9v
cert-manager                cert-manager-7ddd8cdb9f-z2xzm
cert-manager                cert-manager-cainjector-57cd76c845-smrfg
cert-manager                cert-manager-webhook-cf8f9f895-grszt
istio-system                cluster-local-gateway-595b55bdb4-kgj8w
istio-system                istio-ingressgateway-66c5cb4897-l2j4l
istio-system                istiod-58fb67c76f-2znkk
istio-system                kubeflow-m2m-oidc-configurator-29118325-dm949
istio-system                kubeflow-m2m-oidc-configurator-29118330-sxsh6
istio-system                toolbox
knative-serving             activator-54c999bcbc-4vglt
knative-serving             autoscaler-776bbf9496-t5tdn
knative-serving             controller-854dcfd65b-krjgp
knative-serving             net-istio-controller-79d44bc46d-lltw8
knative-serving             net-istio-webhook-ff94788ff-tpprf
knative-serving             webhook-56bccb4b4f-67mg6
kube-flannel                kube-flannel-ds-brk8q
kube-flannel                kube-flannel-ds-clk96
kube-flannel                kube-flannel-ds-rfd8t
kube-system                 coredns-76f75df574-fcnqj
kube-system                 coredns-76f75df574-mmccd
kube-system                 etcd-k8s-kubeflow-master01
kube-system                 kube-apiserver-k8s-kubeflow-master01
kube-system                 kube-controller-manager-k8s-kubeflow-master01
kube-system                 kube-proxy-j9hkr
kube-system                 kube-proxy-m4dwc
kube-system                 kube-proxy-t7hf5
kube-system                 kube-scheduler-k8s-kubeflow-master01
kubeflow-user-example-com   ml-pipeline-ui-artifact-55f4d57d68-sb9sf
kubeflow-user-example-com   ml-pipeline-visualizationserver-57949d474-sz6pc
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-driver-2133261422
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-driver-844200209
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-impl-2852792872
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-impl-605240799
kubeflow-user-example-com   pod-log-to-github-49hjk-system-dag-driver-1399478097
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-container-driver-1929661354
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-container-impl-1277471876
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-dag-driver-1435271278
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-driver-1811512138
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-driver-451000317
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-impl-169698603
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-impl-2628596772
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-dag-driver-1135711573
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-driver-2116732566
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-impl-359698432
kubeflow-user-example-com   pod-log-to-github-w22xx-system-dag-driver-1352252338
kubeflow-user-example-com   test-0
kubeflow                    admission-webhook-deployment-6d796b475c-ttrs2
kubeflow                    cache-server-bb7c5cfb6-cwm85
kubeflow                    centraldashboard-55c548fdf4-zp6lp
kubeflow                    jupyter-web-app-deployment-576dd45d74-bxspb
kubeflow                    katib-controller-6c5684bf6b-l7bcj
kubeflow                    katib-db-manager-7866998cf9-z7lj2
kubeflow                    katib-mysql-76b79df5b5-qqfml
kubeflow                    katib-ui-657777bbff-x4tnm
kubeflow                    kserve-controller-manager-79c67d6bb-j4d86
kubeflow                    kserve-models-web-app-5ccd4b66d6-d2lcp
kubeflow                    kubeflow-pipelines-profile-controller-5dcf75b69f-g24kt
kubeflow                    metacontroller-0
kubeflow                    metadata-envoy-deployment-9c7db86d8-h96xq
kubeflow                    metadata-grpc-deployment-d94cc8676-njh69
kubeflow                    metadata-writer-d9bc4bb89-bd6nz
kubeflow                    minio-5dc6ff5b96-cf8lg
kubeflow                    ml-pipeline-5846b5b56d-l8d7n
kubeflow                    ml-pipeline-persistenceagent-7655ddbcfb-mnjmg
kubeflow                    ml-pipeline-scheduledworkflow-658b675548-8pcf8
kubeflow                    ml-pipeline-ui-5c66bf88b5-fdzr2
kubeflow                    ml-pipeline-viewer-crd-c7b78c8c-bldlh
kubeflow                    ml-pipeline-visualizationserver-7c678699d-xz9dk
kubeflow                    mysql-5b446b5744-jlr4m
kubeflow                    notebook-controller-deployment-5458bf988b-dh2kj
kubeflow                    profiles-deployment-79f5cf977d-6jvns
kubeflow                    pvcviewer-controller-manager-5b8c866b58-qz2hj
kubeflow                    tensorboard-controller-deployment-78f5598f4b-wrbqb
kubeflow                    tensorboards-web-app-deployment-568fc5687-2pdk5
kubeflow                    training-operator-7b99976c6-c2dfm
kubeflow                    volumes-web-app-deployment-6b9bd6bb8f-nf6fj
kubeflow                    workflow-controller-68d76bcb8b-d4nps
local-path-storage          local-path-provisioner-6548cc785f-xnkv4
oauth2-proxy                oauth2-proxy-59bd7c7db6-4hsw2
oauth2-proxy                oauth2-proxy-59bd7c7db6-gfwh5</pre></section><section><h2>DEBUG: 총 검사 대상 Pod 수: 81</h2></section><section><h2>Pod: dex-7b97f48486-q9h9v (Namespace: auth) - 키워드 미포함</h2></section><section><h2>Pod: cert-manager-7ddd8cdb9f-z2xzm (Namespace: cert-manager) - 키워드 미포함</h2></section><section><h2>Pod: cert-manager-cainjector-57cd76c845-smrfg (Namespace: cert-manager) - 키워드 미포함</h2></section><section><h2>Pod: cert-manager-webhook-cf8f9f895-grszt (Namespace: cert-manager) - 키워드 미포함</h2></section><section><h2>Pod: cluster-local-gateway-595b55bdb4-kgj8w (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: istio-ingressgateway-66c5cb4897-l2j4l (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: istiod-58fb67c76f-2znkk (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: kubeflow-m2m-oidc-configurator-29118325-dm949 (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: kubeflow-m2m-oidc-configurator-29118330-sxsh6 (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: toolbox (Namespace: istio-system) - 키워드 미포함</h2></section><section><h2>Pod: activator-54c999bcbc-4vglt (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: autoscaler-776bbf9496-t5tdn (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: controller-854dcfd65b-krjgp (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: net-istio-controller-79d44bc46d-lltw8 (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: net-istio-webhook-ff94788ff-tpprf (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: webhook-56bccb4b4f-67mg6 (Namespace: knative-serving) - 키워드 미포함</h2></section><section><h2>Pod: kube-flannel-ds-brk8q (Namespace: kube-flannel) - 키워드 미포함</h2></section><section><h2>Pod: kube-flannel-ds-clk96 (Namespace: kube-flannel) - 키워드 미포함</h2></section><section><h2>Pod: kube-flannel-ds-rfd8t (Namespace: kube-flannel) - 키워드 미포함</h2></section><section><h2>Pod: coredns-76f75df574-fcnqj (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: coredns-76f75df574-mmccd (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: etcd-k8s-kubeflow-master01 (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-apiserver-k8s-kubeflow-master01 (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-controller-manager-k8s-kubeflow-master01 (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-proxy-j9hkr (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-proxy-m4dwc (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-proxy-t7hf5 (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: kube-scheduler-k8s-kubeflow-master01 (Namespace: kube-system) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-ui-artifact-55f4d57d68-sb9sf (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-visualizationserver-57949d474-sz6pc (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-driver-2133261422 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-driver-844200209 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-impl-2852792872 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-impl-605240799 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-dag-driver-1399478097 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-fzpd7-system-container-driver-1929661354 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}</pre></section><section><h2>Pod: pod-log-to-github-fzpd7-system-container-impl-1277471876 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre></section><section><h2>Pod: pod-log-to-github-fzpd7-system-dag-driver-1435271278 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-driver-1811512138 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-driver-451000317 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-impl-169698603 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-impl-2628596772 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-mxzg4-system-dag-driver-1135711573 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-driver-2116732566 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-impl-359698432 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-dag-driver-1352252338 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: test-0 (Namespace: kubeflow-user-example-com) - 키워드 미포함</h2></section><section><h2>Pod: admission-webhook-deployment-6d796b475c-ttrs2 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: cache-server-bb7c5cfb6-cwm85 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: centraldashboard-55c548fdf4-zp6lp (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: jupyter-web-app-deployment-576dd45d74-bxspb (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: katib-controller-6c5684bf6b-l7bcj (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: katib-db-manager-7866998cf9-z7lj2 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: katib-mysql-76b79df5b5-qqfml (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: katib-ui-657777bbff-x4tnm (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: kserve-controller-manager-79c67d6bb-j4d86 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: kserve-models-web-app-5ccd4b66d6-d2lcp (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: kubeflow-pipelines-profile-controller-5dcf75b69f-g24kt (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: metacontroller-0 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: metadata-envoy-deployment-9c7db86d8-h96xq (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: metadata-grpc-deployment-d94cc8676-njh69 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: metadata-writer-d9bc4bb89-bd6nz (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: minio-5dc6ff5b96-cf8lg (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-5846b5b56d-l8d7n (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-persistenceagent-7655ddbcfb-mnjmg (Namespace: kubeflow)</h2><h3>Logs (최근 10줄)</h3><pre>time="2025-05-13T01:33:07Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-to-github-w22xx): CustomError (code: 0): Syncing Workflow (pod-log-to-github-w22xx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-to-github-w22xx\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ab066c-fc2d-44b2-997a-a15c1d2bd76d\",\"resourceVersion\":\"8876335\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T01:33:02Z\",\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-13T01:29:40.026Z (fba6b)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-to-github-w22xx\":{\"id\":\"pod-log-to-github-w22xx\",\"name\":\"pod-log-to-github-w22xx\",\"displayName\":\"pod-log-to-github-w22xx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-to-github-w22xx-1352252338\"]},\"pod-log-to-github-w22xx-1352252338\":{\"id\":\"pod-log-to-github-w22xx-1352252338\",\"name\":\"pod-log-to-github-w22xx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-to-github-w22xx\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ab066c-fc2d-44b2-997a-a15c1d2bd76d\",\"resourceVersion\":\"8876335\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T01:33:02Z\",\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-13T01:29:40.026Z (fba6b)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-to-github-w22xx\":{\"id\":\"pod-log-to-github-w22xx\",\"name\":\"pod-log-to-github-w22xx\",\"displayName\":\"pod-log-to-github-w22xx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-to-github-w22xx-1352252338\"]},\"pod-log-to-github-w22xx-1352252338\":{\"id\":\"pod-log-to-github-w22xx-1352252338\",\"name\":\"pod-log-to-github-w22xx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-13T01:33:15Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-to-github-w22xx): CustomError (code: 0): Syncing Workflow (pod-log-to-github-w22xx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-to-github-w22xx\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ab066c-fc2d-44b2-997a-a15c1d2bd76d\",\"resourceVersion\":\"8876411\",\"generation\":3,\"creationTimestamp\":\"2025-05-13T01:33:02Z\",\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-13T01:29:40.026Z (fba6b)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:12Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-to-github-w22xx\":{\"id\":\"pod-log-to-github-w22xx\",\"name\":\"pod-log-to-github-w22xx\",\"displayName\":\"pod-log-to-github-w22xx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-to-github-w22xx-1352252338\"]},\"pod-log-to-github-w22xx-1352252338\":{\"id\":\"pod-log-to-github-w22xx-1352252338\",\"name\":\"pod-log-to-github-w22xx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":\"2025-05-13T01:33:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"167\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-dag-driver-1352252338/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-w22xx-2218117385\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-w22xx-2116732566\":{\"id\":\"pod-log-to-github-w22xx-2116732566\",\"name\":\"pod-log-to-github-w22xx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-to-github-w22xx-2218117385\",\"startedAt\":\"2025-05-13T01:33:12Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"167\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}},\"pod-log-to-github-w22xx-2218117385\":{\"id\":\"pod-log-to-github-w22xx-2218117385\",\"name\":\"pod-log-to-github-w22xx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:12Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"167\"}]},\"children\":[\"pod-log-to-github-w22xx-2116732566\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-to-github-w22xx\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ab066c-fc2d-44b2-997a-a15c1d2bd76d\",\"resourceVersion\":\"8876411\",\"generation\":3,\"creationTimestamp\":\"2025-05-13T01:33:02Z\",\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-13T01:29:40.026Z (fba6b)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:33:12Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-to-github-w22xx\":{\"id\":\"pod-log-to-github-w22xx\",\"name\":\"pod-log-to-github-w22xx\",\"displayName\":\"pod-log-to-github-w22xx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-to-github-w22xx-1352252338\"]},\"pod-log-to-github-w22xx-1352252338\":{\"id\":\"pod-log-to-github-w22xx-1352252338\",\"name\":\"pod-log-to-github-w22xx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:02Z\",\"finishedAt\":\"2025-05-13T01:33:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"167\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-dag-driver-1352252338/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-w22xx-2218117385\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-w22xx-2116732566\":{\"id\":\"pod-log-to-github-w22xx-2116732566\",\"name\":\"pod-log-to-github-w22xx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-to-github-w22xx-2218117385\",\"startedAt\":\"2025-05-13T01:33:12Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\\\\\"crash\\\\\\\"):\\\\n    import os\\\\n    import subprocess\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # 모든 Pods 조회\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(keyword))\\\\n\\\\n        # 디버그: kubectl get pods 전체 결과\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: kubectl get pods 결과\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{pods_output}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_raw = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n            logs_last_10 = \\\\\\\"\\\\\\\\n\\\\\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\\\n\\\\n            if keyword:\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if keyword in l])\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\\\n            else:\\\\n                matched_describe = describe\\\\n                matched_logs = logs_last_10\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n            else:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 처리\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                if keyword:\\\\n                    matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events_output.splitlines() if keyword in l])\\\\n                else:\\\\n                    matched_events = events_output\\\\n\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 별 이벤트 출력\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"167\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}},\"pod-log-to-github-w22xx-2218117385\":{\"id\":\"pod-log-to-github-w22xx-2218117385\",\"name\":\"pod-log-to-github-w22xx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-to-github-w22xx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-to-github-w22xx\",\"startedAt\":\"2025-05-13T01:33:12Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"167\"}]},\"children\":[\"pod-log-to-github-w22xx-2116732566\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"</pre></section><section><h2>Pod: ml-pipeline-scheduledworkflow-658b675548-8pcf8 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-ui-5c66bf88b5-fdzr2 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-viewer-crd-c7b78c8c-bldlh (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: ml-pipeline-visualizationserver-7c678699d-xz9dk (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: mysql-5b446b5744-jlr4m (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: notebook-controller-deployment-5458bf988b-dh2kj (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: profiles-deployment-79f5cf977d-6jvns (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: pvcviewer-controller-manager-5b8c866b58-qz2hj (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: tensorboard-controller-deployment-78f5598f4b-wrbqb (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: tensorboards-web-app-deployment-568fc5687-2pdk5 (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: training-operator-7b99976c6-c2dfm (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: volumes-web-app-deployment-6b9bd6bb8f-nf6fj (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: workflow-controller-68d76bcb8b-d4nps (Namespace: kubeflow) - 키워드 미포함</h2></section><section><h2>Pod: local-path-provisioner-6548cc785f-xnkv4 (Namespace: local-path-storage) - 키워드 미포함</h2></section><section><h2>Pod: oauth2-proxy-59bd7c7db6-4hsw2 (Namespace: oauth2-proxy) - 키워드 미포함</h2></section><section><h2>Pod: oauth2-proxy-59bd7c7db6-gfwh5 (Namespace: oauth2-proxy) - 키워드 미포함</h2></section></body></html>