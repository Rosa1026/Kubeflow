
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }
                h1 { color: #2c3e50; }
                h2 { color: #34495e; }
                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }
                section { margin-bottom: 30px; }
            </style>
        </head>
        <body>
        <h1>Kubernetes 장애 점검 리포트</h1>
        <section><h2>DEBUG: kubectl get pods 결과</h2><pre>auth                        dex-7b97f48486-q9h9v                                                        Running
cert-manager                cert-manager-7ddd8cdb9f-z2xzm                                               Running
cert-manager                cert-manager-cainjector-57cd76c845-smrfg                                    Running
cert-manager                cert-manager-webhook-cf8f9f895-grszt                                        Running
istio-system                cluster-local-gateway-595b55bdb4-kgj8w                                      Running
istio-system                istio-ingressgateway-66c5cb4897-l2j4l                                       Running
istio-system                istiod-58fb67c76f-2znkk                                                     Running
istio-system                kubeflow-m2m-oidc-configurator-29118755-tzpp2                               Succeeded
istio-system                kubeflow-m2m-oidc-configurator-29118760-5hsnp                               Succeeded
istio-system                toolbox                                                                     Running
knative-serving             activator-54c999bcbc-4vglt                                                  Running
knative-serving             autoscaler-776bbf9496-t5tdn                                                 Running
knative-serving             controller-854dcfd65b-krjgp                                                 Running
knative-serving             net-istio-controller-79d44bc46d-lltw8                                       Running
knative-serving             net-istio-webhook-ff94788ff-tpprf                                           Running
knative-serving             webhook-56bccb4b4f-67mg6                                                    Running
kube-flannel                kube-flannel-ds-brk8q                                                       Running
kube-flannel                kube-flannel-ds-clk96                                                       Running
kube-flannel                kube-flannel-ds-rfd8t                                                       Running
kube-system                 coredns-76f75df574-fcnqj                                                    Running
kube-system                 coredns-76f75df574-mmccd                                                    Running
kube-system                 etcd-k8s-kubeflow-master01                                                  Running
kube-system                 kube-apiserver-k8s-kubeflow-master01                                        Running
kube-system                 kube-controller-manager-k8s-kubeflow-master01                               Running
kube-system                 kube-proxy-j9hkr                                                            Running
kube-system                 kube-proxy-m4dwc                                                            Running
kube-system                 kube-proxy-t7hf5                                                            Running
kube-system                 kube-scheduler-k8s-kubeflow-master01                                        Running
kubeflow-user-example-com   kubeflow-cluster-report-html-54j6v-system-container-driver-1370600769       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-54j6v-system-container-driver-541823454        Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-54j6v-system-container-impl-3855823672         Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-54j6v-system-dag-driver-809292929              Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-dvvqs-system-container-driver-3683375341       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434         Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-dvvqs-system-container-impl-3987505467         Failed
kubeflow-user-example-com   kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972             Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-gpnjw-system-container-driver-1112328765       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-gpnjw-system-container-driver-3716821788       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-gpnjw-system-container-impl-4134831211         Failed
kubeflow-user-example-com   kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178         Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-gpnjw-system-dag-driver-2435536036             Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-lstxq-system-container-driver-3997409308       Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-lstxq-system-container-driver-493082941        Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-lstxq-system-container-impl-3994004331         Succeeded
kubeflow-user-example-com   kubeflow-cluster-report-html-lstxq-system-dag-driver-1883122084             Succeeded
kubeflow-user-example-com   ml-pipeline-ui-artifact-55f4d57d68-sb9sf                                    Running
kubeflow-user-example-com   ml-pipeline-visualizationserver-57949d474-sz6pc                             Running
kubeflow-user-example-com   pod-log-pipeline-advance-version-4ghtw-system-container-driver-1435614314   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-4ghtw-system-container-driver-4127585743   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-4ghtw-system-container-impl-300115137      Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-4ghtw-system-dag-driver-1127347630         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-5g5dq-system-container-driver-2182329916   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-5g5dq-system-container-driver-2407725405   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-5g5dq-system-dag-driver-3484045636         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-7nshw-system-container-driver-2969399015   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-7nshw-system-container-driver-719009016    Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-7nshw-system-dag-driver-2469645371         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-8lppr-system-container-driver-3978863182   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-8lppr-system-container-driver-94920483     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-8lppr-system-container-impl-253909477      Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-8lppr-system-dag-driver-3081928554         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-b8cvw-system-container-driver-3141312681   Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-b8cvw-system-container-driver-720270776    Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-b8cvw-system-dag-driver-3183041576         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-cs852-system-container-driver-2504791682   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-cs852-system-container-driver-888646629    Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-cs852-system-dag-driver-3421844605         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-f5jll-system-container-driver-1648103050   Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-f5jll-system-container-driver-960807485    Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-f5jll-system-dag-driver-1975691797         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-fjvxx-system-container-driver-2503112002   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548      Running
kubeflow-user-example-com   pod-log-pipeline-advance-version-fjvxx-system-dag-driver-4165243590         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-jfvff-system-container-driver-2568180026   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-jfvff-system-container-driver-2694616799   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-jfvff-system-container-impl-70219057       Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-jfvff-system-dag-driver-3230713982         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-nh6wx-system-container-driver-1073766564   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-nh6wx-system-container-driver-363543251    Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-nh6wx-system-container-impl-2790915178     Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-nh6wx-system-dag-driver-1666669711         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-p4qjq-system-container-driver-3390612114   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-p4qjq-system-container-driver-3672319207   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-p4qjq-system-container-impl-1649637833     Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-p4qjq-system-dag-driver-2518136982         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-sspss-system-container-driver-4198297916   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-sspss-system-container-driver-461120093    Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-sspss-system-container-impl-83109003       Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-sspss-system-dag-driver-2424267844         Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-tcgsg-system-container-driver-1366828380   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-tcgsg-system-container-driver-3599414653   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-tcgsg-system-dag-driver-577476708          Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-twg4s-system-container-driver-3979613424   Failed
kubeflow-user-example-com   pod-log-pipeline-advance-version-twg4s-system-container-driver-4166101455   Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369     Succeeded
kubeflow-user-example-com   pod-log-pipeline-advance-version-twg4s-system-dag-driver-1446001731         Succeeded
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-driver-2133261422                  Succeeded
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-driver-844200209                   Succeeded
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-impl-2852792872                    Failed
kubeflow-user-example-com   pod-log-to-github-49hjk-system-container-impl-605240799                     Succeeded
kubeflow-user-example-com   pod-log-to-github-49hjk-system-dag-driver-1399478097                        Succeeded
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-container-driver-1929661354                  Succeeded
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-container-impl-1277471876                    Failed
kubeflow-user-example-com   pod-log-to-github-fzpd7-system-dag-driver-1435271278                        Succeeded
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-driver-1811512138                  Succeeded
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-driver-451000317                   Succeeded
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-impl-169698603                     Succeeded
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-container-impl-2628596772                    Succeeded
kubeflow-user-example-com   pod-log-to-github-mxzg4-system-dag-driver-1135711573                        Succeeded
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-driver-2116732566                  Succeeded
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-driver-2196521211                  Succeeded
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-impl-359698432                     Succeeded
kubeflow-user-example-com   pod-log-to-github-w22xx-system-container-impl-4089628493                    Succeeded
kubeflow-user-example-com   pod-log-to-github-w22xx-system-dag-driver-1352252338                        Succeeded
kubeflow-user-example-com   test-0                                                                      Running
kubeflow                    admission-webhook-deployment-6d796b475c-ttrs2                               Running
kubeflow                    cache-server-bb7c5cfb6-cwm85                                                Running
kubeflow                    centraldashboard-55c548fdf4-zp6lp                                           Running
kubeflow                    jupyter-web-app-deployment-576dd45d74-bxspb                                 Running
kubeflow                    katib-controller-6c5684bf6b-l7bcj                                           Running
kubeflow                    katib-db-manager-7866998cf9-z7lj2                                           Running
kubeflow                    katib-mysql-76b79df5b5-qqfml                                                Running
kubeflow                    katib-ui-657777bbff-x4tnm                                                   Running
kubeflow                    kserve-controller-manager-79c67d6bb-j4d86                                   Running
kubeflow                    kserve-models-web-app-5ccd4b66d6-d2lcp                                      Running
kubeflow                    kubeflow-pipelines-profile-controller-5dcf75b69f-g24kt                      Running
kubeflow                    metacontroller-0                                                            Running
kubeflow                    metadata-envoy-deployment-9c7db86d8-h96xq                                   Running
kubeflow                    metadata-grpc-deployment-d94cc8676-njh69                                    Running
kubeflow                    metadata-writer-d9bc4bb89-bd6nz                                             Running
kubeflow                    minio-5dc6ff5b96-cf8lg                                                      Running
kubeflow                    ml-pipeline-5846b5b56d-l8d7n                                                Running
kubeflow                    ml-pipeline-persistenceagent-7655ddbcfb-mnjmg                               Running
kubeflow                    ml-pipeline-scheduledworkflow-658b675548-8pcf8                              Running
kubeflow                    ml-pipeline-ui-5c66bf88b5-fdzr2                                             Running
kubeflow                    ml-pipeline-viewer-crd-c7b78c8c-bldlh                                       Running
kubeflow                    ml-pipeline-visualizationserver-7c678699d-xz9dk                             Running
kubeflow                    mysql-5b446b5744-jlr4m                                                      Running
kubeflow                    notebook-controller-deployment-5458bf988b-dh2kj                             Running
kubeflow                    profiles-deployment-79f5cf977d-6jvns                                        Running
kubeflow                    pvcviewer-controller-manager-5b8c866b58-qz2hj                               Running
kubeflow                    tensorboard-controller-deployment-78f5598f4b-wrbqb                          Running
kubeflow                    tensorboards-web-app-deployment-568fc5687-2pdk5                             Running
kubeflow                    training-operator-7b99976c6-c2dfm                                           Running
kubeflow                    volumes-web-app-deployment-6b9bd6bb8f-nf6fj                                 Running
kubeflow                    workflow-controller-68d76bcb8b-d4nps                                        Running
local-path-storage          local-path-provisioner-6548cc785f-xnkv4                                     Running
oauth2-proxy                oauth2-proxy-59bd7c7db6-4hsw2                                               Running
oauth2-proxy                oauth2-proxy-59bd7c7db6-gfwh5                                               Running</pre></section><section><h2>DEBUG: 총 검사 대상 Pod 수: 157</h2></section><section><h2>Pod: <code>kubeflow-cluster-report-html-54j6v-system-container-driver-1370600769</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;182&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;182&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-container-driver-1370600769&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;182&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;182&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-container-driver-1370600769&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash,error\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    log_keywords_list = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keywords_list = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def highlight_keywords(text, keywords):\n        for k in keywords:\n            text = text.replace(k, f&#x27;\u003cspan style=\&quot;color:red\&quot;\u003e{k}\u003c/span\u003e&#x27;)\n        return text\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_keywords = set()\n\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\n\n            for line in filtered_describe + filtered_logs:\n                for k in log_keywords_list:\n                    if k in line:\n                        matched_keywords.add(k)\n\n            if filtered_describe or filtered_logs:\n                keyword_tag = \&quot;, \&quot;.join(matched_keywords)\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\u003c/h2\u003e\\n\&quot;)\n\n                if filtered_describe:\n                    f.write(\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(filtered_describe), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                if filtered_logs:\n                    last_logs = filtered_logs[-10:]\n                    f.write(\&quot;\u003ch3\u003eLogs (last 10 lines)\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(last_logs), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\n                if filtered_events:\n                    namespace_events[namespace] = \&quot;\\n\&quot;.join(filtered_events)\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: `{ns}`\u003c/h3\u003e\u003cpre\u003e\&quot;)\n            f.write(highlight_keywords(events, event_keywords_list))\n            f.write(\&quot;\u003c/pre\u003e\u003c/section\u003e\\n\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;182&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;182&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-container-driver-1370600769&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash,error\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    log_keywords_list = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keywords_list = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def highlight_keywords(text, keywords):\n        for k in keywords:\n            text = text.replace(k, f&#x27;\u003cspan style=\&quot;color:red\&quot;\u003e{k}\u003c/span\u003e&#x27;)\n        return text\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_keywords = set()\n\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\n\n            for line in filtered_describe + filtered_logs:\n                for k in log_keywords_list:\n                    if k in line:\n                        matched_keywords.add(k)\n\n            if filtered_describe or filtered_logs:\n                keyword_tag = \&quot;, \&quot;.join(matched_keywords)\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\u003c/h2\u003e\\n\&quot;)\n\n                if filtered_describe:\n                    f.write(\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(filtered_describe), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                if filtered_logs:\n                    last_logs = filtered_logs[-10:]\n                    f.write(\&quot;\u003ch3\u003eLogs (last 10 lines)\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(last_logs), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\n                if filtered_events:\n                    namespace_events[namespace] = \&quot;\\n\&quot;.join(filtered_events)\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: `{ns}`\u003c/h3\u003e\u003cpre\u003e\&quot;)\n            f.write(highlight_keywords(events, event_keywords_list))\n            f.write(\&quot;\u003c/pre\u003e\u003c/section\u003e\\n\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 05:39:01.790453      14 driver.go:252] parent DAG: id:182  name:&quot;run/2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114731817  last_update_time_since_epoch:1747114731817
I0513 05:39:01.833484      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 05:39:01.929112      14 driver.go:310] Created execution: id:183  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;92d7d1ad841bc975059c3e84658e2bca3d2f82de556bb46388424a42363b0d63&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;180&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:182}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747114741887  last_update_time_since_epoch:1747114741887
      &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-54j6v-system-container-driver-541823454</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 05:39:11.859863      15 driver.go:252] parent DAG: id:182  name:&quot;run/2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114731817  last_update_time_since_epoch:1747114731817
I0513 05:39:11.910575      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-54j6v-system-dag-driver-809292929</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-dag-driver-809292929&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-dag-driver-809292929&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error,fail&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;crash,error,fail&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-54j6v/2025/05/13/kubeflow-cluster-report-html-54j6v-system-dag-driver-809292929&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
    &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
I0513 05:38:51.847686      15 driver.go:185] Created execution: id:182  name:&quot;run/2654f0dc-728a-44ab-86c2-2c90e7b69f77&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114731817  last_update_time_since_epoch:1747114731817</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;173&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;173&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;173&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;173&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keys = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;, encoding=\&quot;utf-8\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;173&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;173&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keys = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;, encoding=\&quot;utf-8\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 04:58:45.393955      15 driver.go:252] parent DAG: id:173  name:&quot;run/b4552194-b316-49fe-8ade-36ee4ec911fb&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747112315432  last_update_time_since_epoch:1747112315432
I0513 04:58:45.434345      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 04:58:45.519265      15 driver.go:310] Created execution: id:174  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;99919ba4da8dc7bd0e660df3cb154109cd1edad72826b01f9599f7571d5efbcb&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:173}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747112325484  last_update_time_since_epoch:1747112325484
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--execution_id&quot;,&quot;174&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;, \&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;crash\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keys = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;, encoding=\&quot;utf-8\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-dvvqs-system-container-driver-3683375341</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 04:59:57.959316      15 driver.go:252] parent DAG: id:173  name:&quot;run/b4552194-b316-49fe-8ade-36ee4ec911fb&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747112315432  last_update_time_since_epoch:1747112315432
I0513 04:59:58.000518      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;, &quot;log_keywords&quot;:&quot;crash,error,fail&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;crash&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
      def collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = &quot;crash&quot;, event_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;):
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;b4552194-b316-49fe-8ade-36ee4ec911fb\&quot;,\&quot;--execution_id\&quot;,\&quot;174\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;,
            &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error,fail&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;crash,error,fail&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;b4552194-b316-49fe-8ade-36ee4ec911fb&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
    &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
I0513 04:58:35.476506      14 driver.go:185] Created execution: id:173  name:&quot;run/b4552194-b316-49fe-8ade-36ee4ec911fb&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747112315432  last_update_time_since_epoch:1747112315432</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-gpnjw-system-container-driver-1112328765</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 05:38:07.513534      14 driver.go:252] parent DAG: id:179  name:&quot;run/72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114603019  last_update_time_since_epoch:1747114603019
I0513 05:38:07.556069      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-gpnjw-system-container-driver-3716821788</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;179&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;179&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-driver-3716821788&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;179&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;179&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-driver-3716821788&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash,error\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    log_keywords_list = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keywords_list = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def highlight_keywords(text, keywords):\n        for k in keywords:\n            text = text.replace(k, f&#x27;\u003cspan style=\&quot;color:red\&quot;\u003e{k}\u003c/span\u003e&#x27;)\n        return text\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_keywords = set()\n\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\n\n            for line in filtered_describe + filtered_logs:\n                for k in log_keywords_list:\n                    if k in line:\n                        matched_keywords.add(k)\n\n            if filtered_describe or filtered_logs:\n                keyword_tag = \&quot;, \&quot;.join(matched_keywords)\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\u003c/h2\u003e\\n\&quot;)\n\n                if filtered_describe:\n                    f.write(\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(filtered_describe), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                if filtered_logs:\n                    last_logs = filtered_logs[-10:]\n                    f.write(\&quot;\u003ch3\u003eLogs (last 10 lines)\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(last_logs), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\n                if filtered_events:\n                    namespace_events[namespace] = \&quot;\\n\&quot;.join(filtered_events)\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: `{ns}`\u003c/h3\u003e\u003cpre\u003e\&quot;)\n            f.write(highlight_keywords(events, event_keywords_list))\n            f.write(\&quot;\u003c/pre\u003e\u003c/section\u003e\\n\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;179&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;179&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-driver-3716821788&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash,error\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    log_keywords_list = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keywords_list = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def highlight_keywords(text, keywords):\n        for k in keywords:\n            text = text.replace(k, f&#x27;\u003cspan style=\&quot;color:red\&quot;\u003e{k}\u003c/span\u003e&#x27;)\n        return text\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_keywords = set()\n\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\n\n            for line in filtered_describe + filtered_logs:\n                for k in log_keywords_list:\n                    if k in line:\n                        matched_keywords.add(k)\n\n            if filtered_describe or filtered_logs:\n                keyword_tag = \&quot;, \&quot;.join(matched_keywords)\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\u003c/h2\u003e\\n\&quot;)\n\n                if filtered_describe:\n                    f.write(\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(filtered_describe), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                if filtered_logs:\n                    last_logs = filtered_logs[-10:]\n                    f.write(\&quot;\u003ch3\u003eLogs (last 10 lines)\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(last_logs), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\n                if filtered_events:\n                    namespace_events[namespace] = \&quot;\\n\&quot;.join(filtered_events)\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: `{ns}`\u003c/h3\u003e\u003cpre\u003e\&quot;)\n            f.write(highlight_keywords(events, event_keywords_list))\n            f.write(\&quot;\u003c/pre\u003e\u003c/section\u003e\\n\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 05:36:52.053234      15 driver.go:252] parent DAG: id:179  name:&quot;run/72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114603019  last_update_time_since_epoch:1747114603019
I0513 05:36:52.093757      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 05:36:52.172093      15 driver.go:310] Created execution: id:180  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;92d7d1ad841bc975059c3e84658e2bca3d2f82de556bb46388424a42363b0d63&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:179}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747114612139  last_update_time_since_epoch:1747114612139
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--execution_id&quot;,&quot;180&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;, \&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;crash,error\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash,error\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    log_keywords_list = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keywords_list = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def highlight_keywords(text, keywords):\n        for k in keywords:\n            text = text.replace(k, f&#x27;\u003cspan style=\&quot;color:red\&quot;\u003e{k}\u003c/span\u003e&#x27;)\n        return text\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_keywords = set()\n\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\n\n            for line in filtered_describe + filtered_logs:\n                for k in log_keywords_list:\n                    if k in line:\n                        matched_keywords.add(k)\n\n            if filtered_describe or filtered_logs:\n                keyword_tag = \&quot;, \&quot;.join(matched_keywords)\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\u003c/h2\u003e\\n\&quot;)\n\n                if filtered_describe:\n                    f.write(\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(filtered_describe), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                if filtered_logs:\n                    last_logs = filtered_logs[-10:]\n                    f.write(\&quot;\u003ch3\u003eLogs (last 10 lines)\u003c/h3\u003e\u003cpre\u003e\&quot;)\n                    f.write(highlight_keywords(\&quot;\\n\&quot;.join(last_logs), log_keywords_list))\n                    f.write(\&quot;\u003c/pre\u003e\\n\&quot;)\n\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\n                if filtered_events:\n                    namespace_events[namespace] = \&quot;\\n\&quot;.join(filtered_events)\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: `{ns}`\u003c/h3\u003e\u003cpre\u003e\&quot;)\n            f.write(highlight_keywords(events, event_keywords_list))\n            f.write(\&quot;\u003c/pre\u003e\u003c/section\u003e\\n\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;, &quot;log_keywords&quot;:&quot;crash,error,fail&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;crash,error&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
      def collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = &quot;crash,error&quot;, event_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;):
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-container-impl-4149860178&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;kubeflow-cluster-report-html\&quot;,\&quot;--run_id\&quot;,\&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0\&quot;,\&quot;--execution_id\&quot;,\&quot;180\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;crash,error,fail\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/72f85b13-5ff0-48ac-8889-032ba3f822b0/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;crash,error\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash,error\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    log_keywords_list = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keywords_list = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def highlight_keywords(text, keywords):\\n        for k in keywords:\\n            text = text.replace(k, f&#x27;\\u003cspan style=\\\&quot;color:red\\\&quot;\\u003e{k}\\u003c/span\\u003e&#x27;)\\n        return text\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_keywords = set()\\n\\n            filtered_describe = [l for l in describe.splitlines() if any(k in l for k in log_keywords_list)]\\n            filtered_logs = [l for l in logs.splitlines() if any(k in l for k in log_keywords_list)]\\n\\n            for line in filtered_describe + filtered_logs:\\n                for k in log_keywords_list:\\n                    if k in line:\\n                        matched_keywords.add(k)\\n\\n            if filtered_describe or filtered_logs:\\n                keyword_tag = \\\&quot;, \\\&quot;.join(matched_keywords)\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: `{pod_name}` (Namespace: `{namespace}`) [{keyword_tag}]\\u003c/h2\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_describe:\\n                    f.write(\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(filtered_describe), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                if filtered_logs:\\n                    last_logs = filtered_logs[-10:]\\n                    f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n                    f.write(highlight_keywords(\\\&quot;\\\\n\\\&quot;.join(last_logs), log_keywords_list))\\n                    f.write(\\\&quot;\\u003c/pre\\u003e\\\\n\\\&quot;)\\n\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                filtered_events = [l for l in events.splitlines() if any(k in l for k in event_keywords_list)]\\n                if filtered_events:\\n                    namespace_events[namespace] = \\\&quot;\\\\n\\\&quot;.join(filtered_events)\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: `{ns}`\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot;)\\n            f.write(highlight_keywords(events, event_keywords_list))\\n            f.write(\\\&quot;\\u003c/pre\\u003e\\u003c/section\\u003e\\\\n\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed&quot;,
            &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-gpnjw-system-dag-driver-2435536036</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-dag-driver-2435536036&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-dag-driver-2435536036&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error,fail&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;crash,error,fail&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-gpnjw/2025/05/13/kubeflow-cluster-report-html-gpnjw-system-dag-driver-2435536036&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
    &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
I0513 05:36:43.050232      14 driver.go:185] Created execution: id:179  name:&quot;run/72f85b13-5ff0-48ac-8889-032ba3f822b0&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747114603019  last_update_time_since_epoch:1747114603019</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-lstxq-system-container-driver-3997409308</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;176&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;176&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-container-driver-3997409308&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;176&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;176&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-container-driver-3997409308&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keys = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;, encoding=\&quot;utf-8\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;176&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;176&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\&quot;crash\\\&quot;, event_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;, encoding=\\\&quot;utf-8\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-container-driver-3997409308&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \&quot;crash\&quot;, event_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\&quot;,\&quot;)]\n    event_keys = [k.strip() for k in event_keywords.split(\&quot;,\&quot;)]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;, encoding=\&quot;utf-8\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 05:12:37.696302      13 driver.go:252] parent DAG: id:176  name:&quot;run/03166a1b-4161-40e6-92ea-c0452fb97123&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747113147727  last_update_time_since_epoch:1747113147727
I0513 05:12:37.741985      13 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 05:12:37.828114      13 driver.go:310] Created execution: id:177  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;99919ba4da8dc7bd0e660df3cb154109cd1edad72826b01f9599f7571d5efbcb&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;174&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:176}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747113157789  last_update_time_since_epoch:1747113157789
      &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-lstxq-system-container-driver-493082941</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 05:12:47.726821      15 driver.go:252] parent DAG: id:176  name:&quot;run/03166a1b-4161-40e6-92ea-c0452fb97123&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747113147727  last_update_time_since_epoch:1747113147727
I0513 05:12:47.770168      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;crash,error,fail&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>kubeflow-cluster-report-html-lstxq-system-dag-driver-1883122084</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-dag-driver-1883122084&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-dag-driver-1883122084&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;crash,error,fail&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;crash,error,fail&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;kubeflow-cluster-report-html&quot;,&quot;--run_id&quot;,&quot;03166a1b-4161-40e6-92ea-c0452fb97123&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;crash,error,fail\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;crash,error,fail\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/kubeflow-cluster-report-html-lstxq/2025/05/13/kubeflow-cluster-report-html-lstxq-system-dag-driver-1883122084&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
    &quot;event_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;,
I0513 05:12:27.758632      15 driver.go:185] Created execution: id:176  name:&quot;run/03166a1b-4161-40e6-92ea-c0452fb97123&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,Failed,Unhealthy&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;crash,error,fail&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747113147727  last_update_time_since_epoch:1747113147727</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-4ghtw-system-container-driver-1435614314</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;185&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;185&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-driver-1435614314&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;185&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;185&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-driver-1435614314&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;185&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;185&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-driver-1435614314&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 06:05:33.768168      14 driver.go:252] parent DAG: id:185  name:&quot;run/03e32b33-5d23-4ce5-be06-00812f5b167b&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116323803  last_update_time_since_epoch:1747116323803
I0513 06:05:33.807352      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 06:05:33.887845      14 driver.go:310] Created execution: id:186  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;f7d2838b294b9826fe0e2fb40d5b20cfcb6d695d9cd08eddd83eed493416dc60&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:185}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747116333854  last_update_time_since_epoch:1747116333854
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--execution_id&quot;,&quot;186&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-4ghtw-system-container-driver-4127585743</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 06:06:34.197660      14 driver.go:252] parent DAG: id:185  name:&quot;run/03e32b33-5d23-4ce5-be06-00812f5b167b&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116323803  last_update_time_since_epoch:1747116323803
I0513 06:06:34.244558      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-container-impl-2336668228&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;03e32b33-5d23-4ce5-be06-00812f5b167b\&quot;,\&quot;--execution_id\&quot;,\&quot;186\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/03e32b33-5d23-4ce5-be06-00812f5b167b/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-4ghtw-system-dag-driver-1127347630</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-dag-driver-1127347630&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-dag-driver-1127347630&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;03e32b33-5d23-4ce5-be06-00812f5b167b&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-4ghtw/2025/05/13/pod-log-pipeline-advance-version-4ghtw-system-dag-driver-1127347630&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 06:05:23.833494      15 driver.go:185] Created execution: id:185  name:&quot;run/03e32b33-5d23-4ce5-be06-00812f5b167b&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116323803  last_update_time_since_epoch:1747116323803</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-5g5dq-system-container-driver-2182329916</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;206&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;206&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-container-driver-2182329916&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;206&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;206&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-container-driver-2182329916&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;206&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;206&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-container-driver-2182329916&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 07:36:25.576165      15 driver.go:252] parent DAG: id:206  name:&quot;run/64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121775625  last_update_time_since_epoch:1747121775625
I0513 07:36:25.621424      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 07:36:25.702303      15 driver.go:310] Created execution: id:207  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;ec7357b8454fa3705a6ec901b80973fd1d4bf2e3f469a60a99bae7e3b4566eda&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;196&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:206}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747121785667  last_update_time_since_epoch:1747121785667
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-5g5dq-system-container-driver-2407725405</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 07:36:35.771781      15 driver.go:252] parent DAG: id:206  name:&quot;run/64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121775625  last_update_time_since_epoch:1747121775625
I0513 07:36:35.811967      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-5g5dq-system-dag-driver-3484045636</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-dag-driver-3484045636&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-dag-driver-3484045636&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-5g5dq/2025/05/13/pod-log-pipeline-advance-version-5g5dq-system-dag-driver-3484045636&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 07:36:15.655204      15 driver.go:185] Created execution: id:206  name:&quot;run/64034148-0e9a-464b-a9aa-f5dd9da7fbfa&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121775625  last_update_time_since_epoch:1747121775625</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-7nshw-system-container-driver-2969399015</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;213&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;213&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-driver-2969399015&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;213&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;213&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-driver-2969399015&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;213&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;213&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-driver-2969399015&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:19:56.685939      15 driver.go:252] parent DAG: id:213  name:&quot;run/e1569055-0952-4b02-b449-45911339fa78&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747124386690  last_update_time_since_epoch:1747124386690
I0513 08:19:56.727541      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:19:56.801733      15 driver.go:310] Created execution: id:214  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:213}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  create_time_since_epoch:1747124396764  last_update_time_since_epoch:1747124396764
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--execution_id&quot;,&quot;214&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-7nshw-system-container-driver-719009016</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 08:21:34.587747      14 driver.go:252] parent DAG: id:213  name:&quot;run/e1569055-0952-4b02-b449-45911339fa78&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747124386690  last_update_time_since_epoch:1747124386690
I0513 08:21:34.633972      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-container-impl-1314902985&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;e1569055-0952-4b02-b449-45911339fa78\&quot;,\&quot;--execution_id\&quot;,\&quot;214\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/e1569055-0952-4b02-b449-45911339fa78/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-7nshw-system-dag-driver-2469645371</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-dag-driver-2469645371&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-dag-driver-2469645371&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Collect Filtered Logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;e1569055-0952-4b02-b449-45911339fa78&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-7nshw/2025/05/13/pod-log-pipeline-advance-version-7nshw-system-dag-driver-2469645371&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:19:46.726592      14 driver.go:185] Created execution: id:213  name:&quot;run/e1569055-0952-4b02-b449-45911339fa78&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747124386690  last_update_time_since_epoch:1747124386690</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-8lppr-system-container-driver-3978863182</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;198&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;198&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-container-driver-3978863182&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;198&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;198&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-container-driver-3978863182&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;198&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;198&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-container-driver-3978863182&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 06:26:48.883964      15 driver.go:252] parent DAG: id:198  name:&quot;run/5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117598836  last_update_time_since_epoch:1747117598836
I0513 06:26:48.927786      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 06:26:49.013255      15 driver.go:310] Created execution: id:199  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;ec7357b8454fa3705a6ec901b80973fd1d4bf2e3f469a60a99bae7e3b4566eda&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;196&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:198}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747117608976  last_update_time_since_epoch:1747117608976
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-8lppr-system-container-driver-94920483</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 06:26:58.878307      15 driver.go:252] parent DAG: id:198  name:&quot;run/5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117598836  last_update_time_since_epoch:1747117598836
I0513 06:26:58.924117      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-8lppr-system-dag-driver-3081928554</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-dag-driver-3081928554&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-dag-driver-3081928554&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-8lppr/2025/05/13/pod-log-pipeline-advance-version-8lppr-system-dag-driver-3081928554&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 06:26:38.868444      13 driver.go:185] Created execution: id:198  name:&quot;run/5fa5127c-b3b5-4556-94f5-8601cdce43e6&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117598836  last_update_time_since_epoch:1747117598836</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-b8cvw-system-container-driver-3141312681</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 07:55:42.984599      15 driver.go:252] parent DAG: id:209  name:&quot;run/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747122866425  last_update_time_since_epoch:1747122866425
I0513 07:55:43.025492      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-b8cvw-system-container-driver-720270776</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;209&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;209&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-driver-720270776&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;209&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;209&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-driver-720270776&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;209&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;209&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-driver-720270776&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 07:54:36.460416      15 driver.go:252] parent DAG: id:209  name:&quot;run/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747122866425  last_update_time_since_epoch:1747122866425
I0513 07:54:36.501347      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 07:54:36.571875      15 driver.go:310] Created execution: id:210  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:209}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  create_time_since_epoch:1747122876539  last_update_time_since_epoch:1747122876539
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--execution_id&quot;,&quot;210&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-container-impl-2969120782&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68\&quot;,\&quot;--execution_id\&quot;,\&quot;210\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-b8cvw-system-dag-driver-3183041576</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-dag-driver-3183041576&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-dag-driver-3183041576&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Collect Filtered Logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Upload to GitHub&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-b8cvw/2025/05/13/pod-log-pipeline-advance-version-b8cvw-system-dag-driver-3183041576&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 07:54:26.456852      14 driver.go:185] Created execution: id:209  name:&quot;run/f480cfbe-18f9-4bdb-b0bf-71cf5fa5ae68&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747122866425  last_update_time_since_epoch:1747122866425</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-cs852-system-container-driver-2504791682</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 08:30:46.740990      15 driver.go:252] parent DAG: id:215  name:&quot;run/813cdf2b-6ff3-4126-9631-6b3b60112417&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125027682  last_update_time_since_epoch:1747125027682
I0513 08:30:46.783899      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-cs852-system-container-driver-888646629</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;215&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;215&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-container-driver-888646629&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;215&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;215&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-container-driver-888646629&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;215&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;215&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-container-driver-888646629&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:30:36.650507      14 driver.go:252] parent DAG: id:215  name:&quot;run/813cdf2b-6ff3-4126-9631-6b3b60112417&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125027682  last_update_time_since_epoch:1747125027682
I0513 08:30:36.694725      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:30:36.778749      14 driver.go:310] Created execution: id:216  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;ec7357b8454fa3705a6ec901b80973fd1d4bf2e3f469a60a99bae7e3b4566eda&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;196&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:215}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747125036746  last_update_time_since_epoch:1747125036746
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-cs852-system-dag-driver-3421844605</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-dag-driver-3421844605&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-dag-driver-3421844605&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;813cdf2b-6ff3-4126-9631-6b3b60112417&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-cs852/2025/05/13/pod-log-pipeline-advance-version-cs852-system-dag-driver-3421844605&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:30:27.717173      14 driver.go:185] Created execution: id:215  name:&quot;run/813cdf2b-6ff3-4126-9631-6b3b60112417&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125027682  last_update_time_since_epoch:1747125027682</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-f5jll-system-container-driver-1648103050</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 07:30:01.881256      14 driver.go:252] parent DAG: id:204  name:&quot;run/0590f049-909f-4de3-86a6-74d60f95de6d&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121327328  last_update_time_since_epoch:1747121327328
I0513 07:30:01.925691      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-f5jll-system-container-driver-960807485</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;204&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;204&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-driver-960807485&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;204&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;204&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-driver-960807485&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;204&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;204&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-driver-960807485&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 07:28:57.415100      15 driver.go:252] parent DAG: id:204  name:&quot;run/0590f049-909f-4de3-86a6-74d60f95de6d&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121327328  last_update_time_since_epoch:1747121327328
I0513 07:28:57.469712      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 07:28:57.539727      15 driver.go:310] Created execution: id:205  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:204}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  create_time_since_epoch:1747121337507  last_update_time_since_epoch:1747121337507
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--execution_id&quot;,&quot;205&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-container-impl-1582906475&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;0590f049-909f-4de3-86a6-74d60f95de6d\&quot;,\&quot;--execution_id\&quot;,\&quot;205\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/0590f049-909f-4de3-86a6-74d60f95de6d/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-f5jll-system-dag-driver-1975691797</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-dag-driver-1975691797&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-dag-driver-1975691797&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Collect Filtered Logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Upload to GitHub&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;0590f049-909f-4de3-86a6-74d60f95de6d&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Upload to GitHub\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-f5jll/2025/05/13/pod-log-pipeline-advance-version-f5jll-system-dag-driver-1975691797&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 07:28:47.361506      14 driver.go:185] Created execution: id:204  name:&quot;run/0590f049-909f-4de3-86a6-74d60f95de6d&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747121327328  last_update_time_since_epoch:1747121327328</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-fjvxx-system-container-driver-2503112002</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;224&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;224&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-driver-2503112002&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;224&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;224&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-driver-2503112002&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;224&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;224&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-driver-2503112002&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:41:25.294400      14 driver.go:252] parent DAG: id:224  name:&quot;run/1f730446-7f17-4602-a143-fa3db60067f9&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125675308  last_update_time_since_epoch:1747125675308
I0513 08:41:25.337371      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:41:25.412859      14 driver.go:310] Created execution: id:225  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:224}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747125685377  last_update_time_since_epoch:1747125685377
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--execution_id&quot;,&quot;225&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-container-impl-673697548&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1f730446-7f17-4602-a143-fa3db60067f9\&quot;,\&quot;--execution_id\&quot;,\&quot;225\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1f730446-7f17-4602-a143-fa3db60067f9/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-fjvxx-system-dag-driver-4165243590</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-dag-driver-4165243590&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-dag-driver-4165243590&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1f730446-7f17-4602-a143-fa3db60067f9&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-fjvxx/2025/05/13/pod-log-pipeline-advance-version-fjvxx-system-dag-driver-4165243590&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:41:15.338977      14 driver.go:185] Created execution: id:224  name:&quot;run/1f730446-7f17-4602-a143-fa3db60067f9&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125675308  last_update_time_since_epoch:1747125675308</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-jfvff-system-container-driver-2568180026</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;188&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;188&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-container-driver-2568180026&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;188&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;188&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-container-driver-2568180026&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;188&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;188&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-container-driver-2568180026&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 06:07:58.668586      15 driver.go:252] parent DAG: id:188  name:&quot;run/fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116468638  last_update_time_since_epoch:1747116468638
I0513 06:07:58.712585      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 06:07:58.801191      15 driver.go:310] Created execution: id:189  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;f7d2838b294b9826fe0e2fb40d5b20cfcb6d695d9cd08eddd83eed493416dc60&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;186&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:188}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747116478762  last_update_time_since_epoch:1747116478762
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-jfvff-system-container-driver-2694616799</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 06:08:08.768946      14 driver.go:252] parent DAG: id:188  name:&quot;run/fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116468638  last_update_time_since_epoch:1747116468638
I0513 06:08:08.815682      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-jfvff-system-dag-driver-3230713982</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-dag-driver-3230713982&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-dag-driver-3230713982&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-jfvff/2025/05/13/pod-log-pipeline-advance-version-jfvff-system-dag-driver-3230713982&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 06:07:48.674184      15 driver.go:185] Created execution: id:188  name:&quot;run/fb714a24-0df2-43cf-8cb2-06486bb9a010&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747116468638  last_update_time_since_epoch:1747116468638</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-nh6wx-system-container-driver-1073766564</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 06:24:53.037471      15 driver.go:252] parent DAG: id:195  name:&quot;run/431825e3-530c-4900-8f9b-8e0742e98294&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117420625  last_update_time_since_epoch:1747117420625
I0513 06:24:53.091168      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-nh6wx-system-container-driver-363543251</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;195&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;195&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-driver-363543251&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;195&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;195&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-driver-363543251&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;195&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;195&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-driver-363543251&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 06:23:50.589335      15 driver.go:252] parent DAG: id:195  name:&quot;run/431825e3-530c-4900-8f9b-8e0742e98294&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117420625  last_update_time_since_epoch:1747117420625
I0513 06:23:50.633272      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 06:23:50.727973      15 driver.go:310] Created execution: id:196  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;ec7357b8454fa3705a6ec901b80973fd1d4bf2e3f469a60a99bae7e3b4566eda&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:195}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747117430687  last_update_time_since_epoch:1747117430687
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--execution_id&quot;,&quot;196&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-container-impl-3635549109&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;431825e3-530c-4900-8f9b-8e0742e98294\&quot;,\&quot;--execution_id\&quot;,\&quot;196\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/431825e3-530c-4900-8f9b-8e0742e98294/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-nh6wx-system-dag-driver-1666669711</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-dag-driver-1666669711&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-dag-driver-1666669711&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;431825e3-530c-4900-8f9b-8e0742e98294&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-nh6wx/2025/05/13/pod-log-pipeline-advance-version-nh6wx-system-dag-driver-1666669711&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 06:23:40.661100      15 driver.go:185] Created execution: id:195  name:&quot;run/431825e3-530c-4900-8f9b-8e0742e98294&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747117420625  last_update_time_since_epoch:1747117420625</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-p4qjq-system-container-driver-3390612114</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;218&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;218&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-driver-3390612114&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;218&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;218&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-driver-3390612114&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;218&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;218&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-driver-3390612114&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:31:51.342880      15 driver.go:252] parent DAG: id:218  name:&quot;run/c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125101211  last_update_time_since_epoch:1747125101211
I0513 08:31:51.385090      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:31:51.456378      15 driver.go:310] Created execution: id:219  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:218}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747125111422  last_update_time_since_epoch:1747125111422
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--execution_id&quot;,&quot;219&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-p4qjq-system-container-driver-3672319207</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 08:33:00.983192      14 driver.go:252] parent DAG: id:218  name:&quot;run/c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125101211  last_update_time_since_epoch:1747125101211
I0513 08:33:01.027109      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-container-impl-3000831420&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952\&quot;,\&quot;--execution_id\&quot;,\&quot;219\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/c362aafe-13f2-4560-b80d-d0fa2ed4b952/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-p4qjq-system-dag-driver-2518136982</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-dag-driver-2518136982&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-dag-driver-2518136982&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-p4qjq/2025/05/13/pod-log-pipeline-advance-version-p4qjq-system-dag-driver-2518136982&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:31:41.241898      16 driver.go:185] Created execution: id:218  name:&quot;run/c362aafe-13f2-4560-b80d-d0fa2ed4b952&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125101211  last_update_time_since_epoch:1747125101211</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-sspss-system-container-driver-4198297916</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;221&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;221&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-driver-4198297916&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;221&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;221&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-driver-4198297916&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;221&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;221&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-driver-4198297916&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:39:23.124133      13 driver.go:252] parent DAG: id:221  name:&quot;run/1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125553097  last_update_time_since_epoch:1747125553097
I0513 08:39:23.177231      13 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:39:23.255520      13 driver.go:310] Created execution: id:222  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:221}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747125563219  last_update_time_since_epoch:1747125563219
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--execution_id&quot;,&quot;222&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-sspss-system-container-driver-461120093</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 08:40:33.875115      13 driver.go:252] parent DAG: id:221  name:&quot;run/1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125553097  last_update_time_since_epoch:1747125553097
I0513 08:40:33.918577      13 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-container-impl-1726354290&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051\&quot;,\&quot;--execution_id\&quot;,\&quot;222\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1c14d7d4-92f0-477c-83ad-b75bb4fa0051/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-sspss-system-dag-driver-2424267844</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-dag-driver-2424267844&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-dag-driver-2424267844&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-sspss/2025/05/13/pod-log-pipeline-advance-version-sspss-system-dag-driver-2424267844&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:39:13.160563      14 driver.go:185] Created execution: id:221  name:&quot;run/1c14d7d4-92f0-477c-83ad-b75bb4fa0051&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747125553097  last_update_time_since_epoch:1747125553097</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-tcgsg-system-container-driver-1366828380</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;201&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;201&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-container-driver-1366828380&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;201&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;201&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-container-driver-1366828380&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;201&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;201&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-container-driver-1366828380&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 07:02:32.969618      15 driver.go:252] parent DAG: id:201  name:&quot;run/71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747119743005  last_update_time_since_epoch:1747119743005
I0513 07:02:33.009525      15 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 07:02:33.103573      15 driver.go:310] Created execution: id:202  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;cache_fingerprint&quot;  value:{string_value:&quot;ec7357b8454fa3705a6ec901b80973fd1d4bf2e3f469a60a99bae7e3b4566eda&quot;}}  custom_properties:{key:&quot;cached_execution_id&quot;  value:{string_value:&quot;196&quot;}}  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:201}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;collect-filtered-logs&quot;}}  create_time_since_epoch:1747119753067  last_update_time_since_epoch:1747119753067
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-tcgsg-system-container-driver-3599414653</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 07:02:43.070210      14 driver.go:252] parent DAG: id:201  name:&quot;run/71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747119743005  last_update_time_since_epoch:1747119743005
I0513 07:02:43.122833      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-tcgsg-system-dag-driver-577476708</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-dag-driver-577476708&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-dag-driver-577476708&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;collect-filtered-logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-tcgsg/2025/05/13/pod-log-pipeline-advance-version-tcgsg-system-dag-driver-577476708&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 07:02:23.036897      14 driver.go:185] Created execution: id:201  name:&quot;run/71b763ed-0c79-4097-9f90-6a2500a3e6d1&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747119743005  last_update_time_since_epoch:1747119743005</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-twg4s-system-container-driver-3979613424</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Logs (마지막 10줄)</h3><pre>I0513 08:04:00.710185      14 driver.go:252] parent DAG: id:211  name:&quot;run/1e6b76a6-d927-435b-abe2-596f09f41415&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747123364024  last_update_time_since_epoch:1747123364024
I0513 08:04:00.752116      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-twg4s-system-container-driver-4166101455</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;211&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;211&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-driver-4166101455&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;211&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;211&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-driver-4166101455&quot;}}}
      {&quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;,&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}},&quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;,&quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;211&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;211&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}},\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-driver-4166101455&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
I0513 08:02:54.113877      14 driver.go:252] parent DAG: id:211  name:&quot;run/1e6b76a6-d927-435b-abe2-596f09f41415&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747123364024  last_update_time_since_epoch:1747123364024
I0513 08:02:54.158152      14 driver.go:926] parent DAG input parameters: map[branch:string_value:&quot;report&quot; event_keywords:string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot; github_token:string_value:&quot;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&quot; log_keywords:string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot; repo_url:string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;], artifacts: map[]
I0513 08:02:54.233198      14 driver.go:310] Created execution: id:212  type_id:14  type:&quot;system.ContainerExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  custom_properties:{key:&quot;image&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}}}}  custom_properties:{key:&quot;namespace&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;parent_dag_id&quot;  value:{int_value:211}}  custom_properties:{key:&quot;pod_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;pod_uid&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;Collect Filtered Logs&quot;}}  create_time_since_epoch:1747123374198  last_update_time_since_epoch:1747123374198
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--execution_id&quot;,&quot;212&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{\&quot;parameterValues\&quot;:{\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;}}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;, \&quot;isOptional\&quot;:true}, \&quot;log_keywords\&quot;:{\&quot;parameterType\&quot;:\&quot;STRING\&quot;, \&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;, \&quot;isOptional\&quot;:true}}}, \&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset],\n                          log_keywords: str = \&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\n                          event_keywords: str = \&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;):\n\n    import subprocess\n    import os\n    import html\n    import re\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\&quot;,\&quot;)]\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\&quot;,\&quot;)]\n\n    def highlight_keywords(text: str, keywords: list[str]) -\u003e tuple[str, list[str]]:\n        found = set()\n        for kw in keywords:\n            if kw in text:\n                found.add(kw)\n                text = re.sub(f\&quot;({re.escape(kw)})\&quot;, r\&quot;\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\u003e\\1\u003c/span\u003e\&quot;, text, flags=re.IGNORECASE)\n        return text, sorted(list(found))\n\n    pods_output = subprocess.getoutput(\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;)\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(f\&quot;\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\&quot;)\n\n        for line in pod_lines:\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            logs = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\&quot;)\n\n            matched_describe = \&quot;\\n\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs_raw = \&quot;\\n\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\n            matched_logs = \&quot;\\n\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\n\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\n            all_found = list(set(describe_found + log_found))\n\n            if matched_describe or matched_logs:\n                f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: \u003ccode\u003e{pod_name}\u003c/code\u003e (Namespace: \u003ccode\u003e{namespace}\u003c/code\u003e)\u003c/h2\u003e\\n\&quot;)\n                if all_found:\n                    f.write(f\&quot;\u003cp\u003e⚠️ 감지된 키워드: \u003cstrong\u003e{&#x27;, &#x27;.join(all_found)}\u003c/strong\u003e\u003c/p\u003e\&quot;)\n                if matched_describe:\n                    f.write(f\&quot;\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\\n\&quot;)\n                if matched_logs:\n                    f.write(f\&quot;\u003ch3\u003eLogs (마지막 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\\n\&quot;)\n                f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = \&quot;\\n\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\n                if matched_events:\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\n                    namespace_events[namespace] = highlighted_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eNamespace: \u003ccode\u003e{ns}\u003c/code\u003e - Events\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}
      &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      {&quot;inputs&quot;:{&quot;parameterValues&quot;:{&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}, &quot;outputs&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifacts&quot;:[{&quot;type&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}, &quot;uri&quot;:&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report&quot;}]}}, &quot;outputFile&quot;:&quot;/tmp/kfp_outputs/output_metadata.json&quot;}}
      {&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;, &quot;isOptional&quot;:true}, &quot;log_keywords&quot;:{&quot;parameterType&quot;:&quot;STRING&quot;, &quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;, &quot;isOptional&quot;:true}}}, &quot;outputDefinitions&quot;:{&quot;artifacts&quot;:{&quot;output_report&quot;:{&quot;artifactType&quot;:{&quot;schemaTitle&quot;:&quot;system.Dataset&quot;, &quot;schemaVersion&quot;:&quot;0.0.1&quot;}}}}, &quot;executorLabel&quot;:&quot;exec-collect-filtered-logs&quot;}
                                log_keywords: str = &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-container-impl-2126002369&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-pipeline-advance-version\&quot;,\&quot;--run_id\&quot;,\&quot;1e6b76a6-d927-435b-abe2-596f09f41415\&quot;,\&quot;--execution_id\&quot;,\&quot;212\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{\\\&quot;parameterValues\\\&quot;:{\\\&quot;event_keywords\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;log_keywords\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;}}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/1e6b76a6-d927-435b-abe2-596f09f41415/Collect Filtered Logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;inputDefinitions\\\&quot;:{\\\&quot;parameters\\\&quot;:{\\\&quot;event_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;, \\\&quot;isOptional\\\&quot;:true}, \\\&quot;log_keywords\\\&quot;:{\\\&quot;parameterType\\\&quot;:\\\&quot;STRING\\\&quot;, \\\&quot;defaultValue\\\&quot;:\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;, \\\&quot;isOptional\\\&quot;:true}}}, \\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset],\\n                          log_keywords: str = \\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\\\&quot;,\\n                          event_keywords: str = \\\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\\\&quot;):\\n\\n    import subprocess\\n    import os\\n    import html\\n    import re\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    log_kw_list = [kw.strip() for kw in log_keywords.split(\\\&quot;,\\\&quot;)]\\n    event_kw_list = [kw.strip() for kw in event_keywords.split(\\\&quot;,\\\&quot;)]\\n\\n    def highlight_keywords(text: str, keywords: list[str]) -\\u003e tuple[str, list[str]]:\\n        found = set()\\n        for kw in keywords:\\n            if kw in text:\\n                found.add(kw)\\n                text = re.sub(f\\\&quot;({re.escape(kw)})\\\&quot;, r\\\&quot;\\u003cspan style=&#x27;color:red; font-weight:bold;&#x27;\\u003e\\\\1\\u003c/span\\u003e\\\&quot;, text, flags=re.IGNORECASE)\\n        return text, sorted(list(found))\\n\\n    pods_output = subprocess.getoutput(\\\&quot;kubectl get pods --all-namespaces -o custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;)\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        for line in pod_lines:\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            logs = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace} --tail=100\\\&quot;)\\n\\n            matched_describe = \\\&quot;\\\\n\\\&quot;.join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs_raw = \\\&quot;\\\\n\\\&quot;.join([l for l in logs.splitlines() if any(k in l for k in log_kw_list)])\\n            matched_logs = \\\&quot;\\\\n\\\&quot;.join(matched_logs_raw.strip().splitlines()[-10:])  # 마지막 10줄\\n\\n            matched_describe, describe_found = highlight_keywords(html.escape(matched_describe), log_kw_list)\\n            matched_logs, log_found = highlight_keywords(html.escape(matched_logs), log_kw_list)\\n            all_found = list(set(describe_found + log_found))\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: \\u003ccode\\u003e{pod_name}\\u003c/code\\u003e (Namespace: \\u003ccode\\u003e{namespace}\\u003c/code\\u003e)\\u003c/h2\\u003e\\\\n\\\&quot;)\\n                if all_found:\\n                    f.write(f\\\&quot;\\u003cp\\u003e⚠️ 감지된 키워드: \\u003cstrong\\u003e{&#x27;, &#x27;.join(all_found)}\\u003c/strong\\u003e\\u003c/p\\u003e\\\&quot;)\\n                if matched_describe:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                if matched_logs:\\n                    f.write(f\\\&quot;\\u003ch3\\u003eLogs (마지막 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\\n\\\&quot;)\\n                f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = \\\&quot;\\\\n\\\&quot;.join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\n                if matched_events:\\n                    highlighted_events, _ = highlight_keywords(html.escape(matched_events), event_kw_list)\\n                    namespace_events[namespace] = highlighted_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eNamespace: \\u003ccode\\u003e{ns}\\u003c/code\\u003e - Events\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
            &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;</pre>
</section><section><h2>Pod: <code>pod-log-pipeline-advance-version-twg4s-system-dag-driver-1446001731</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>failed to start, evicted, OOMKilled, node not ready, CrashLoopBackOff, deadline exceeded</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-dag-driver-1446001731&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-dag-driver-1446001731&quot;}}}
      {&quot;dag&quot;:{&quot;tasks&quot;:{&quot;collect-filtered-logs&quot;:{&quot;cachingOptions&quot;:{},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-collect-filtered-logs&quot;},&quot;inputs&quot;:{&quot;parameters&quot;:{&quot;event_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;event_keywords&quot;},&quot;log_keywords&quot;:{&quot;componentInputParameter&quot;:&quot;log_keywords&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;Collect Filtered Logs&quot;}},&quot;upload-to-github&quot;:{&quot;cachingOptions&quot;:{&quot;enableCache&quot;:true},&quot;componentRef&quot;:{&quot;name&quot;:&quot;comp-upload-to-github&quot;},&quot;dependentTasks&quot;:[&quot;collect-filtered-logs&quot;],&quot;inputs&quot;:{&quot;artifacts&quot;:{&quot;report_file&quot;:{&quot;taskOutputArtifact&quot;:{&quot;outputArtifactKey&quot;:&quot;output_report&quot;,&quot;producerTask&quot;:&quot;collect-filtered-logs&quot;}}},&quot;parameters&quot;:{&quot;branch&quot;:{&quot;componentInputParameter&quot;:&quot;branch&quot;},&quot;github_token&quot;:{&quot;componentInputParameter&quot;:&quot;github_token&quot;},&quot;repo_url&quot;:{&quot;componentInputParameter&quot;:&quot;repo_url&quot;}}},&quot;taskInfo&quot;:{&quot;name&quot;:&quot;upload-to-github&quot;}}}},&quot;inputDefinitions&quot;:{&quot;parameters&quot;:{&quot;branch&quot;:{&quot;defaultValue&quot;:&quot;report&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;event_keywords&quot;:{&quot;defaultValue&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;github_token&quot;:{&quot;defaultValue&quot;:&quot;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&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;log_keywords&quot;:{&quot;defaultValue&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;},&quot;repo_url&quot;:{&quot;defaultValue&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;,&quot;isOptional&quot;:true,&quot;parameterType&quot;:&quot;STRING&quot;}}}}
      {&quot;parameterValues&quot;:{&quot;branch&quot;:&quot;report&quot;,&quot;event_keywords&quot;:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;,&quot;github_token&quot;:&quot;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&quot;,&quot;log_keywords&quot;:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,&quot;repo_url&quot;:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-dag-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;},{&quot;name&quot;:&quot;runtime-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;default&quot;:&quot;0&quot;,&quot;value&quot;:&quot;0&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;driver-type&quot;,&quot;default&quot;:&quot;DAG&quot;,&quot;value&quot;:&quot;ROOT_DAG&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;execution-id&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/execution-id&quot;}},{&quot;name&quot;:&quot;iteration-count&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/iteration-count&quot;,&quot;default&quot;:&quot;0&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;ROOT_DAG&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-pipeline-advance-version&quot;,&quot;--run_id&quot;,&quot;1e6b76a6-d927-435b-abe2-596f09f41415&quot;,&quot;--dag_execution_id&quot;,&quot;0&quot;,&quot;--component&quot;,&quot;{\&quot;dag\&quot;:{\&quot;tasks\&quot;:{\&quot;collect-filtered-logs\&quot;:{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;inputs\&quot;:{\&quot;parameters\&quot;:{\&quot;event_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;event_keywords\&quot;},\&quot;log_keywords\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;log_keywords\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;Collect Filtered Logs\&quot;}},\&quot;upload-to-github\&quot;:{\&quot;cachingOptions\&quot;:{\&quot;enableCache\&quot;:true},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-upload-to-github\&quot;},\&quot;dependentTasks\&quot;:[\&quot;collect-filtered-logs\&quot;],\&quot;inputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;report_file\&quot;:{\&quot;taskOutputArtifact\&quot;:{\&quot;outputArtifactKey\&quot;:\&quot;output_report\&quot;,\&quot;producerTask\&quot;:\&quot;collect-filtered-logs\&quot;}}},\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;branch\&quot;},\&quot;github_token\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;github_token\&quot;},\&quot;repo_url\&quot;:{\&quot;componentInputParameter\&quot;:\&quot;repo_url\&quot;}}},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;upload-to-github\&quot;}}}},\&quot;inputDefinitions\&quot;:{\&quot;parameters\&quot;:{\&quot;branch\&quot;:{\&quot;defaultValue\&quot;:\&quot;report\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;event_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;github_token\&quot;:{\&quot;defaultValue\&quot;:\&quot;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\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;log_keywords\&quot;:{\&quot;defaultValue\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;},\&quot;repo_url\&quot;:{\&quot;defaultValue\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;,\&quot;isOptional\&quot;:true,\&quot;parameterType\&quot;:\&quot;STRING\&quot;}}}}&quot;,&quot;--task&quot;,&quot;&quot;,&quot;--runtime_config&quot;,&quot;{\&quot;parameterValues\&quot;:{\&quot;branch\&quot;:\&quot;report\&quot;,\&quot;event_keywords\&quot;:\&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory\&quot;,\&quot;github_token\&quot;:\&quot;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\&quot;,\&quot;log_keywords\&quot;:\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>\&quot;,\&quot;repo_url\&quot;:\&quot;https://github.com/Rosa1026/Kubeflow.git\&quot;}}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--execution_id_path&quot;,&quot;/tmp/outputs/execution-id&quot;,&quot;--iteration_count_path&quot;,&quot;/tmp/outputs/iteration-count&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-pipeline-advance-version-twg4s/2025/05/13/pod-log-pipeline-advance-version-twg4s-system-dag-driver-1446001731&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;defaultValue&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
    &quot;log_keywords&quot;: &quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;,
I0513 08:02:44.054761      14 driver.go:185] Created execution: id:211  name:&quot;run/1e6b76a6-d927-435b-abe2-596f09f41415&quot;  type_id:13  type:&quot;system.DAGExecution&quot;  last_known_state:RUNNING  custom_properties:{key:&quot;display_name&quot;  value:{string_value:&quot;&quot;}}  custom_properties:{key:&quot;inputs&quot;  value:{struct_value:{fields:{key:&quot;branch&quot;  value:{string_value:&quot;report&quot;}}  fields:{key:&quot;event_keywords&quot;  value:{string_value:&quot;BackOff,FailedScheduling,NodeNotReady,<span style='color:red; font-weight:bold;'>Evicted</span>,OutOfmemory&quot;}}  fields:{key:&quot;github_token&quot;  value:{string_value:&quot;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&quot;}}  fields:{key:&quot;log_keywords&quot;  value:{string_value:&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>,<span style='color:red; font-weight:bold;'>OOMKilled</span>,<span style='color:red; font-weight:bold;'>evicted</span>,<span style='color:red; font-weight:bold;'>failed to start</span>,<span style='color:red; font-weight:bold;'>deadline exceeded</span>,<span style='color:red; font-weight:bold;'>node not ready</span>&quot;}}  fields:{key:&quot;repo_url&quot;  value:{string_value:&quot;https://github.com/Rosa1026/Kubeflow.git&quot;}}}}}  custom_properties:{key:&quot;task_name&quot;  value:{string_value:&quot;&quot;}}  create_time_since_epoch:1747123364024  last_update_time_since_epoch:1747123364024</pre>
</section><section><h2>Pod: <code>pod-log-to-github-mxzg4-system-container-driver-451000317</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>OOMKilled, CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;159&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-to-github&quot;,&quot;--run_id&quot;,&quot;a797e690-1ae3-447c-9342-aaa288deef9a&quot;,&quot;--dag_execution_id&quot;,&quot;159&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317&quot;}}}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;159&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-to-github&quot;,&quot;--run_id&quot;,&quot;a797e690-1ae3-447c-9342-aaa288deef9a&quot;,&quot;--dag_execution_id&quot;,&quot;159&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317&quot;}}}
      {&quot;args&quot;:[&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;command&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;ImagePullBackOff\&quot;, \&quot;Pending\&quot;]\n    describe_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;Back-off\&quot;]\n    log_keywords = [\&quot;Traceback\&quot;, \&quot;panic\&quot;, \&quot;exception\&quot;, \&quot;fail\&quot;, \&quot;error\&quot;]\n    event_keywords = [\&quot;Failed\&quot;, \&quot;BackOff\&quot;, \&quot;Unhealthy\&quot;, \&quot;Killing\&quot;, \&quot;Evicted\&quot;]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\n        \&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;\n    ], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;\n    )\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def match_keywords(lines, keywords):\n        return \&quot;\\n\&quot;.join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            log_output = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \&quot;\\n\&quot;.join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\&quot;)\n            if matched_describe:\n                f.write(\&quot;\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_describe + \&quot;\u003c/pre\u003e\&quot;)\n            if matched_logs:\n                f.write(\&quot;\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_logs + \&quot;\u003c/pre\u003e\&quot;)\n            f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;],&quot;image&quot;:&quot;python:3.9&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-driver&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;component&quot;,&quot;value&quot;:&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;},{&quot;name&quot;:&quot;task&quot;,&quot;value&quot;:&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;},{&quot;name&quot;:&quot;container&quot;,&quot;value&quot;:&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;},{&quot;name&quot;:&quot;parent-dag-id&quot;,&quot;value&quot;:&quot;159&quot;},{&quot;name&quot;:&quot;iteration-index&quot;,&quot;default&quot;:&quot;-1&quot;,&quot;value&quot;:&quot;-1&quot;},{&quot;name&quot;:&quot;kubernetes-config&quot;,&quot;default&quot;:&quot;&quot;,&quot;value&quot;:&quot;&quot;}]},&quot;outputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;default&quot;:&quot;&quot;}},{&quot;name&quot;:&quot;cached-decision&quot;,&quot;default&quot;:&quot;false&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/cached-decision&quot;,&quot;default&quot;:&quot;false&quot;}},{&quot;name&quot;:&quot;condition&quot;,&quot;valueFrom&quot;:{&quot;path&quot;:&quot;/tmp/outputs/condition&quot;,&quot;default&quot;:&quot;true&quot;}}]},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec&quot;,&quot;command&quot;:[&quot;driver&quot;],&quot;args&quot;:[&quot;--type&quot;,&quot;CONTAINER&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-to-github&quot;,&quot;--run_id&quot;,&quot;a797e690-1ae3-447c-9342-aaa288deef9a&quot;,&quot;--dag_execution_id&quot;,&quot;159&quot;,&quot;--component&quot;,&quot;{\&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;,\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;,\&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}}&quot;,&quot;--task&quot;,&quot;{\&quot;cachingOptions\&quot;:{},\&quot;componentRef\&quot;:{\&quot;name\&quot;:\&quot;comp-collect-filtered-logs\&quot;},\&quot;taskInfo\&quot;:{\&quot;name\&quot;:\&quot;collect-filtered-logs\&quot;}}&quot;,&quot;--container&quot;,&quot;{\&quot;args\&quot;:[\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;command\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;],\&quot;image\&quot;:\&quot;python:3.9\&quot;}&quot;,&quot;--iteration_index&quot;,&quot;-1&quot;,&quot;--cached_decision_path&quot;,&quot;/tmp/outputs/cached-decision&quot;,&quot;--pod_spec_patch_path&quot;,&quot;/tmp/outputs/pod-spec-patch&quot;,&quot;--condition_path&quot;,&quot;/tmp/outputs/condition&quot;,&quot;--kubernetes_config&quot;,&quot;&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;512Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;,&quot;memory&quot;:&quot;64Mi&quot;}}},&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317&quot;}}}</pre>
<h3>Logs (마지막 10줄)</h3><pre>&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;ImagePullBackOff\&quot;, \&quot;Pending\&quot;]\n    describe_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;Back-off\&quot;]\n    log_keywords = [\&quot;Traceback\&quot;, \&quot;panic\&quot;, \&quot;exception\&quot;, \&quot;fail\&quot;, \&quot;error\&quot;]\n    event_keywords = [\&quot;Failed\&quot;, \&quot;BackOff\&quot;, \&quot;Unhealthy\&quot;, \&quot;Killing\&quot;, \&quot;Evicted\&quot;]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\n        \&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;\n    ], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;\n    )\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def match_keywords(lines, keywords):\n        return \&quot;\\n\&quot;.join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            log_output = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \&quot;\\n\&quot;.join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\&quot;)\n            if matched_describe:\n                f.write(\&quot;\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_describe + \&quot;\u003c/pre\u003e\&quot;)\n            if matched_logs:\n                f.write(\&quot;\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_logs + \&quot;\u003c/pre\u003e\&quot;)\n            f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;
{&quot;containers&quot;:[{&quot;name&quot;:&quot;main&quot;,&quot;image&quot;:&quot;python:3.9&quot;,&quot;command&quot;:[&quot;/var/run/argo/argoexec&quot;,&quot;emissary&quot;,&quot;--&quot;,&quot;/kfp-launcher/launch&quot;,&quot;--pipeline_name&quot;,&quot;pod-log-to-github&quot;,&quot;--run_id&quot;,&quot;a797e690-1ae3-447c-9342-aaa288deef9a&quot;,&quot;--execution_id&quot;,&quot;160&quot;,&quot;--executor_input&quot;,&quot;{\&quot;inputs\&quot;:{}, \&quot;outputs\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifacts\&quot;:[{\&quot;type\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}, \&quot;uri\&quot;:\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\&quot;}]}}, \&quot;outputFile\&quot;:\&quot;/tmp/kfp_outputs/output_metadata.json\&quot;}}&quot;,&quot;--component_spec&quot;,&quot;{\&quot;outputDefinitions\&quot;:{\&quot;artifacts\&quot;:{\&quot;output_report\&quot;:{\&quot;artifactType\&quot;:{\&quot;schemaTitle\&quot;:\&quot;system.Dataset\&quot;, \&quot;schemaVersion\&quot;:\&quot;0.0.1\&quot;}}}}, \&quot;executorLabel\&quot;:\&quot;exec-collect-filtered-logs\&quot;}&quot;,&quot;--pod_name&quot;,&quot;$(KFP_POD_NAME)&quot;,&quot;--pod_uid&quot;,&quot;$(KFP_POD_UID)&quot;,&quot;--mlmd_server_address&quot;,&quot;$(METADATA_GRPC_SERVICE_HOST)&quot;,&quot;--mlmd_server_port&quot;,&quot;$(METADATA_GRPC_SERVICE_PORT)&quot;,&quot;--&quot;],&quot;args&quot;:[&quot;sh&quot;,&quot;-c&quot;,&quot;\nif ! [ -x \&quot;$(command -v pip)\&quot; ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\&quot;3.9\&quot;&#x27; \u0026\u0026 \&quot;$0\&quot; \&quot;$@\&quot;\n&quot;,&quot;sh&quot;,&quot;-ec&quot;,&quot;program_path=$(mktemp -d)\n\nprintf \&quot;%s\&quot; \&quot;$0\&quot; \u003e \&quot;$program_path/ephemeral_component.py\&quot;\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \&quot;$program_path/ephemeral_component.py\&quot;                         \&quot;$@\&quot;\n&quot;,&quot;\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \&quot;/tmp/report.html\&quot;\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;ImagePullBackOff\&quot;, \&quot;Pending\&quot;]\n    describe_keywords = [\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\&quot;, \&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\&quot;, \&quot;Error\&quot;, \&quot;Failed\&quot;, \&quot;Back-off\&quot;]\n    log_keywords = [\&quot;Traceback\&quot;, \&quot;panic\&quot;, \&quot;exception\&quot;, \&quot;fail\&quot;, \&quot;error\&quot;]\n    event_keywords = [\&quot;Failed\&quot;, \&quot;BackOff\&quot;, \&quot;Unhealthy\&quot;, \&quot;Killing\&quot;, \&quot;Evicted\&quot;]\n\n    # kubectl 설치\n    subprocess.run([\&quot;apt-get\&quot;, \&quot;update\&quot;, \&quot;-y\&quot;], check=True)\n    subprocess.run([\n        \&quot;curl\&quot;, \&quot;-LO\&quot;, \&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\&quot;\n    ], check=True)\n    subprocess.run([\&quot;chmod\&quot;, \&quot;+x\&quot;, \&quot;kubectl\&quot;], check=True)\n    subprocess.run([\&quot;mv\&quot;, \&quot;kubectl\&quot;, \&quot;/usr/local/bin/\&quot;], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\&quot;\n    )\n    pod_lines = pods_output.strip().split(\&quot;\\n\&quot;)\n\n    def match_keywords(lines, keywords):\n        return \&quot;\\n\&quot;.join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \&quot;w\&quot;) as f:\n        f.write(\&quot;\&quot;\&quot;\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\&quot;UTF-8\&quot;\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \&quot;\&quot;\&quot;)\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\&quot;kubectl describe pod {pod_name} -n {namespace}\&quot;)\n            log_output = subprocess.getoutput(f\&quot;kubectl logs {pod_name} -n {namespace}\&quot;)\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \&quot;\\n\&quot;.join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\&quot;)\n            if matched_describe:\n                f.write(\&quot;\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_describe + \&quot;\u003c/pre\u003e\&quot;)\n            if matched_logs:\n                f.write(\&quot;\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\&quot; + matched_logs + \&quot;\u003c/pre\u003e\&quot;)\n            f.write(\&quot;\u003c/section\u003e\&quot;)\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\&quot;kubectl get events -n {namespace}\&quot;)\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\&quot;\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\&quot;)\n\n        f.write(\&quot;\u003c/body\u003e\u003c/html\u003e\&quot;)\n\n    subprocess.run([\&quot;cp\&quot;, tmp_report_path, output_report.path], check=True)\n\n&quot;,&quot;--executor_input&quot;,&quot;{{$}}&quot;,&quot;--function_to_execute&quot;,&quot;collect_filtered_logs&quot;],&quot;resources&quot;:{}}]}</pre>
</section><section><h2>Pod: <code>pod-log-to-github-mxzg4-system-container-impl-169698603</code> (Namespace: <code>kubeflow-user-example-com</code>)</h2>
<p>⚠️ 감지된 키워드: <strong>OOMKilled, CrashLoopBackOff</strong></p><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}
          status_keywords = [&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;, &quot;Error&quot;, &quot;Failed&quot;, &quot;ImagePullBackOff&quot;, &quot;Pending&quot;]
          describe_keywords = [&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>&quot;, &quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>&quot;, &quot;Error&quot;, &quot;Failed&quot;, &quot;Back-off&quot;]
      ARGO_TEMPLATE:                      {&quot;name&quot;:&quot;system-container-impl&quot;,&quot;inputs&quot;:{&quot;parameters&quot;:[{&quot;name&quot;:&quot;pod-spec-patch&quot;,&quot;value&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}]},&quot;outputs&quot;:{},&quot;metadata&quot;:{&quot;annotations&quot;:{&quot;sidecar.istio.io/inject&quot;:&quot;false&quot;}},&quot;container&quot;:{&quot;name&quot;:&quot;&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/should-be-overridden-during-runtime&quot;,&quot;command&quot;:[&quot;should-be-overridden-during-runtime&quot;],&quot;envFrom&quot;:[{&quot;configMapRef&quot;:{&quot;name&quot;:&quot;metadata-grpc-configmap&quot;,&quot;optional&quot;:true}}],&quot;env&quot;:[{&quot;name&quot;:&quot;KFP_POD_NAME&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.name&quot;}}},{&quot;name&quot;:&quot;KFP_POD_UID&quot;,&quot;valueFrom&quot;:{&quot;fieldRef&quot;:{&quot;fieldPath&quot;:&quot;metadata.uid&quot;}}}],&quot;resources&quot;:{},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]},&quot;volumes&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;emptyDir&quot;:{}}],&quot;initContainers&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;image&quot;:&quot;gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f&quot;,&quot;command&quot;:[&quot;launcher-v2&quot;,&quot;--copy&quot;,&quot;/kfp-launcher/launch&quot;],&quot;resources&quot;:{&quot;limits&quot;:{&quot;cpu&quot;:&quot;500m&quot;,&quot;memory&quot;:&quot;128Mi&quot;},&quot;requests&quot;:{&quot;cpu&quot;:&quot;100m&quot;}},&quot;volumeMounts&quot;:[{&quot;name&quot;:&quot;kfp-launcher&quot;,&quot;mountPath&quot;:&quot;/kfp-launcher&quot;}]}],&quot;archiveLocation&quot;:{&quot;archiveLogs&quot;:true,&quot;s3&quot;:{&quot;endpoint&quot;:&quot;minio-service.kubeflow:9000&quot;,&quot;bucket&quot;:&quot;mlpipeline&quot;,&quot;insecure&quot;:true,&quot;accessKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;accesskey&quot;},&quot;secretKeySecret&quot;:{&quot;name&quot;:&quot;mlpipeline-minio-artifact&quot;,&quot;key&quot;:&quot;secretkey&quot;},&quot;key&quot;:&quot;artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603&quot;}},&quot;podSpecPatch&quot;:&quot;{\&quot;containers\&quot;:[{\&quot;name\&quot;:\&quot;main\&quot;,\&quot;image\&quot;:\&quot;python:3.9\&quot;,\&quot;command\&quot;:[\&quot;/var/run/argo/argoexec\&quot;,\&quot;emissary\&quot;,\&quot;--\&quot;,\&quot;/kfp-launcher/launch\&quot;,\&quot;--pipeline_name\&quot;,\&quot;pod-log-to-github\&quot;,\&quot;--run_id\&quot;,\&quot;a797e690-1ae3-447c-9342-aaa288deef9a\&quot;,\&quot;--execution_id\&quot;,\&quot;160\&quot;,\&quot;--executor_input\&quot;,\&quot;{\\\&quot;inputs\\\&quot;:{}, \\\&quot;outputs\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifacts\\\&quot;:[{\\\&quot;type\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}, \\\&quot;uri\\\&quot;:\\\&quot;minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\&quot;}]}}, \\\&quot;outputFile\\\&quot;:\\\&quot;/tmp/kfp_outputs/output_metadata.json\\\&quot;}}\&quot;,\&quot;--component_spec\&quot;,\&quot;{\\\&quot;outputDefinitions\\\&quot;:{\\\&quot;artifacts\\\&quot;:{\\\&quot;output_report\\\&quot;:{\\\&quot;artifactType\\\&quot;:{\\\&quot;schemaTitle\\\&quot;:\\\&quot;system.Dataset\\\&quot;, \\\&quot;schemaVersion\\\&quot;:\\\&quot;0.0.1\\\&quot;}}}}, \\\&quot;executorLabel\\\&quot;:\\\&quot;exec-collect-filtered-logs\\\&quot;}\&quot;,\&quot;--pod_name\&quot;,\&quot;$(KFP_POD_NAME)\&quot;,\&quot;--pod_uid\&quot;,\&quot;$(KFP_POD_UID)\&quot;,\&quot;--mlmd_server_address\&quot;,\&quot;$(METADATA_GRPC_SERVICE_HOST)\&quot;,\&quot;--mlmd_server_port\&quot;,\&quot;$(METADATA_GRPC_SERVICE_PORT)\&quot;,\&quot;--\&quot;],\&quot;args\&quot;:[\&quot;sh\&quot;,\&quot;-c\&quot;,\&quot;\\nif ! [ -x \\\&quot;$(command -v pip)\\\&quot; ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location &#x27;kfp==2.13.0&#x27; &#x27;--no-deps&#x27; &#x27;typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\&quot;3.9\\\&quot;&#x27; \\u0026\\u0026 \\\&quot;$0\\\&quot; \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;sh\&quot;,\&quot;-ec\&quot;,\&quot;program_path=$(mktemp -d)\\n\\nprintf \\\&quot;%s\\\&quot; \\\&quot;$0\\\&quot; \\u003e \\\&quot;$program_path/ephemeral_component.py\\\&quot;\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\&quot;$program_path/ephemeral_component.py\\\&quot;                         \\\&quot;$@\\\&quot;\\n\&quot;,\&quot;\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\&quot;/tmp/report.html\\\&quot;\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;ImagePullBackOff\\\&quot;, \\\&quot;Pending\\\&quot;]\\n    describe_keywords = [\\\&quot;<span style='color:red; font-weight:bold;'>CrashLoopBackOff</span>\\\&quot;, \\\&quot;<span style='color:red; font-weight:bold;'>OOMKilled</span>\\\&quot;, \\\&quot;Error\\\&quot;, \\\&quot;Failed\\\&quot;, \\\&quot;Back-off\\\&quot;]\\n    log_keywords = [\\\&quot;Traceback\\\&quot;, \\\&quot;panic\\\&quot;, \\\&quot;exception\\\&quot;, \\\&quot;fail\\\&quot;, \\\&quot;error\\\&quot;]\\n    event_keywords = [\\\&quot;Failed\\\&quot;, \\\&quot;BackOff\\\&quot;, \\\&quot;Unhealthy\\\&quot;, \\\&quot;Killing\\\&quot;, \\\&quot;Evicted\\\&quot;]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\&quot;apt-get\\\&quot;, \\\&quot;update\\\&quot;, \\\&quot;-y\\\&quot;], check=True)\\n    subprocess.run([\\n        \\\&quot;curl\\\&quot;, \\\&quot;-LO\\\&quot;, \\\&quot;https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\&quot;\\n    ], check=True)\\n    subprocess.run([\\\&quot;chmod\\\&quot;, \\\&quot;+x\\\&quot;, \\\&quot;kubectl\\\&quot;], check=True)\\n    subprocess.run([\\\&quot;mv\\\&quot;, \\\&quot;kubectl\\\&quot;, \\\&quot;/usr/local/bin/\\\&quot;], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\&quot;kubectl get pods --all-namespaces -o=custom-columns=&#x27;NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase&#x27; --no-headers\\\&quot;\\n    )\\n    pod_lines = pods_output.strip().split(\\\&quot;\\\\n\\\&quot;)\\n\\n    def match_keywords(lines, keywords):\\n        return \\\&quot;\\\\n\\\&quot;.join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\&quot;w\\\&quot;) as f:\\n        f.write(\\\&quot;\\\&quot;\\\&quot;\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\&quot;UTF-8\\\&quot;\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\&quot;\\\&quot;\\\&quot;)\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\&quot;kubectl describe pod {pod_name} -n {namespace}\\\&quot;)\\n            log_output = subprocess.getoutput(f\\\&quot;kubectl logs {pod_name} -n {namespace}\\\&quot;)\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\&quot;\\\\n\\\&quot;.join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\&quot;)\\n            if matched_describe:\\n                f.write(\\\&quot;\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_describe + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            if matched_logs:\\n                f.write(\\\&quot;\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\&quot; + matched_logs + \\\&quot;\\u003c/pre\\u003e\\\&quot;)\\n            f.write(\\\&quot;\\u003c/section\\u003e\\\&quot;)\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\&quot;kubectl get events -n {namespace}\\\&quot;)\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\&quot;\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\&quot;)\\n\\n        f.write(\\\&quot;\\u003c/body\\u003e\\u003c/html\\u003e\\\&quot;)\\n\\n    subprocess.run([\\\&quot;cp\\\&quot;, tmp_report_path, output_report.path], check=True)\\n\\n\&quot;,\&quot;--executor_input\&quot;,\&quot;{{$}}\&quot;,\&quot;--function_to_execute\&quot;,\&quot;collect_filtered_logs\&quot;],\&quot;resources\&quot;:{}}]}&quot;}</pre>
</section></body></html>