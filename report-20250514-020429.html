
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}
                h1 {{ color: #2c3e50; }}
                h2 {{ border-bottom: 1px solid #ccc; padding-bottom: 5px; }}
                h3 {{ color: #2980b9; }}
                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}
                section {{ margin-bottom: 30px; }}
                .keyword {{ color: red; font-weight: bold; }}
                .status-running {{ color: green; }}
                .status-failed {{ color: red; }}
                .status-pending {{ color: orange; }}
                .status-unknown {{ color: gray; }}
                .status-other {{ color: blue; }}
            </style>
        </head>
        <body>
        <h1>Kubernetes 장애 점검 리포트</h1>
        <section><h2>Pod: etcd-k8s-kubeflow-master01 (Namespace: kube-system, 상태: <span class='status-running'>Running</span>) - 감지된 키워드: deadline exceeded</h2>
<h3>Log 결과 (최근 10줄)</h3><pre>{"level":"warn","ts":"2025-04-25T06:04:16.458245Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.002736949s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:09:16.452199Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.007711416s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:14:16.445792Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.000352598s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:24:17.342252Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.000196896s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:24:17.444017Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"1.999925858s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
</pre>
</section>
<section><h2>Pod: ml-pipeline-persistenceagent-7655ddbcfb-mnjmg (Namespace: kubeflow, 상태: <span class='status-running'>Running</span>) - 감지된 키워드: failed to start, node not ready, deadline exceeded, evicted, crashloopbackoff, oomkilled</h2>
<h3>Log 결과 (최근 10줄)</h3><pre>time="2025-05-14T01:46:47Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/pod-log-to-github-mxzg4): CustomError (code: 1): Syncing Workflow (pod-log-to-github-mxzg4): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found): rpc error: code = NotFound desc = Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found, {\"metadata\":{\"name\":\"pod-log-to-github-mxzg4\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"dd954010-0f6c-44dd-b5a8-500703ce0bbe\",\"resourceVersion\":\"8870065\",\"generation\":9,\"creationTimestamp\":\"2025-05-13T01:13:40Z\",\"labels\":{\"pipeline/persistedFinalState\":\"true\",\"pipeline/runid\":\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Succeeded\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-08T06:42:58.914Z (66b95)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:15:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}},{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:15:03Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/persistedFinalState\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"5/5\",\"nodes\":{\"pod-log-to-github-mxzg4\":{\"id\":\"pod-log-to-github-mxzg4\",\"name\":\"pod-log-to-github-mxzg4\",\"displayName\":\"pod-log-to-github-mxzg4\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"5/5\",\"resourcesDuration\":{\"cpu\":63,\"memory\":60},\"children\":[\"pod-log-to-github-mxzg4-1135711573\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]},\"pod-log-to-github-mxzg4-1135711573\":{\"id\":\"pod-log-to-github-mxzg4-1135711573\",\"name\":\"pod-log-to-github-mxzg4.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:13:44Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"159\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-dag-driver-1135711573/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-2433661512\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-169698603\":{\"id\":\"pod-log-to-github-mxzg4-169698603\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-521090432\",\"startedAt\":\"2025-05-13T01:14:00Z\",\"finishedAt\":\"2025-05-13T01:14:19Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":32,\"memory\":32},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-1811512138\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-1811512138\":{\"id\":\"pod-log-to-github-mxzg4-1811512138\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:29Z\",\"finishedAt\":\"2025-05-13T01:14:32Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"159\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-1811512138/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-542287825\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-2433661512\":{\"id\":\"pod-log-to-github-mxzg4-2433661512\",\"name\":\"pod-log-to-github-mxzg4.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4\",\"startedAt\":\"2025-05-13T01:13:50Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"4/4\",\"resourcesDuration\":{\"cpu\":60,\"memory\":58},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"159\"}]},\"children\":[\"pod-log-to-github-mxzg4-451000317\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]},\"pod-log-to-github-mxzg4-2628596772\":{\"id\":\"pod-log-to-github-mxzg4-2628596772\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-542287825\",\"startedAt\":\"2025-05-13T01:14:39Z\",\"finishedAt\":\"2025-05-13T01:14:52Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":22,\"memory\":22},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-2628596772/main.log\"}}],\"exitCode\":\"0\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-451000317\":{\"id\":\"pod-log-to-github-mxzg4-451000317\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:13:50Z\",\"finishedAt\":\"2025-05-13T01:13:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"159\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-521090432\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-521090432\":{\"id\":\"pod-log-to-github-mxzg4-521090432\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:00Z\",\"finishedAt\":\"2025-05-13T01:14:29Z\",\"progress\":\"3/3\",\"resourcesDuration\":{\"cpu\":57,\"memory\":56},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-to-github-mxzg4-169698603\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-169698603\"]},\"pod-log-to-github-mxzg4-542287825\":{\"id\":\"pod-log-to-github-mxzg4-542287825\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:39Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":22,\"memory\":22},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-to-github-mxzg4-2628596772\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":63,\"memory\":60},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found): rpc error: code = NotFound desc = Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found, {\"metadata\":{\"name\":\"pod-log-to-github-mxzg4\",\"generateName\":\"pod-log-to-github-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"dd954010-0f6c-44dd-b5a8-500703ce0bbe\",\"resourceVersion\":\"8870065\",\"generation\":9,\"creationTimestamp\":\"2025-05-13T01:13:40Z\",\"labels\":{\"pipeline/persistedFinalState\":\"true\",\"pipeline/runid\":\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Succeeded\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-08T06:42:58.914Z (66b95)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:15:02Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}},{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T01:15:03Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/persistedFinalState\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"5/5\",\"nodes\":{\"pod-log-to-github-mxzg4\":{\"id\":\"pod-log-to-github-mxzg4\",\"name\":\"pod-log-to-github-mxzg4\",\"displayName\":\"pod-log-to-github-mxzg4\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"5/5\",\"resourcesDuration\":{\"cpu\":63,\"memory\":60},\"children\":[\"pod-log-to-github-mxzg4-1135711573\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]},\"pod-log-to-github-mxzg4-1135711573\":{\"id\":\"pod-log-to-github-mxzg4-1135711573\",\"name\":\"pod-log-to-github-mxzg4.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4\",\"startedAt\":\"2025-05-13T01:13:40Z\",\"finishedAt\":\"2025-05-13T01:13:44Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"github_token\\\":\\\"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\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"159\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-dag-driver-1135711573/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-2433661512\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-169698603\":{\"id\":\"pod-log-to-github-mxzg4-169698603\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-521090432\",\"startedAt\":\"2025-05-13T01:14:00Z\",\"finishedAt\":\"2025-05-13T01:14:19Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":32,\"memory\":32},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-1811512138\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-1811512138\":{\"id\":\"pod-log-to-github-mxzg4-1811512138\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:29Z\",\"finishedAt\":\"2025-05-13T01:14:32Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"159\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-1811512138/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-542287825\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-2433661512\":{\"id\":\"pod-log-to-github-mxzg4-2433661512\",\"name\":\"pod-log-to-github-mxzg4.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4\",\"startedAt\":\"2025-05-13T01:13:50Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"4/4\",\"resourcesDuration\":{\"cpu\":60,\"memory\":58},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"159\"}]},\"children\":[\"pod-log-to-github-mxzg4-451000317\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]},\"pod-log-to-github-mxzg4-2628596772\":{\"id\":\"pod-log-to-github-mxzg4-2628596772\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-542287825\",\"startedAt\":\"2025-05-13T01:14:39Z\",\"finishedAt\":\"2025-05-13T01:14:52Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":22,\"memory\":22},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-2628596772/main.log\"}}],\"exitCode\":\"0\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-451000317\":{\"id\":\"pod-log-to-github-mxzg4-451000317\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:13:50Z\",\"finishedAt\":\"2025-05-13T01:13:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"159\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-to-github-mxzg4-521090432\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-to-github-mxzg4-521090432\":{\"id\":\"pod-log-to-github-mxzg4-521090432\",\"name\":\"pod-log-to-github-mxzg4.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:00Z\",\"finishedAt\":\"2025-05-13T01:14:29Z\",\"progress\":\"3/3\",\"resourcesDuration\":{\"cpu\":57,\"memory\":56},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"160\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # 키워드 목록\\\\n    status_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"ImagePullBackOff\\\\\\\", \\\\\\\"Pending\\\\\\\"]\\\\n    describe_keywords = [\\\\\\\"CrashLoopBackOff\\\\\\\", \\\\\\\"OOMKilled\\\\\\\", \\\\\\\"Error\\\\\\\", \\\\\\\"Failed\\\\\\\", \\\\\\\"Back-off\\\\\\\"]\\\\n    log_keywords = [\\\\\\\"Traceback\\\\\\\", \\\\\\\"panic\\\\\\\", \\\\\\\"exception\\\\\\\", \\\\\\\"fail\\\\\\\", \\\\\\\"error\\\\\\\"]\\\\n    event_keywords = [\\\\\\\"Failed\\\\\\\", \\\\\\\"BackOff\\\\\\\", \\\\\\\"Unhealthy\\\\\\\", \\\\\\\"Killing\\\\\\\", \\\\\\\"Evicted\\\\\\\"]\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    # Get pod status\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    def match_keywords(lines, keywords):\\\\n        return \\\\\\\"\\\\\\\\n\\\\\\\".join([line for line in lines if any(k in line for k in keywords)])\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\\\n                h1 { color: #2c3e50; }\\\\n                h2 { color: #34495e; }\\\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\\\n                section { margin-bottom: 30px; }\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name, status = line.strip().split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if not any(k in status for k in status_keywords):\\\\n                continue  # 중요 상태가 아닐 경우 무시\\\\n\\\\n            describe_output = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            log_output = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\\\n            log_lines = log_output.strip().splitlines()\\\\n            last_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(log_lines[-10:])  # 마지막 10줄만\\\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\\\n\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n            if matched_describe:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe (filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_describe + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            if matched_logs:\\\\n                f.write(\\\\\\\"\\\\u003ch3\\\\u003eLogs (last 10 lines, filtered)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\" + matched_logs + \\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events_output = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-to-github-mxzg4-169698603\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-169698603\"]},\"pod-log-to-github-mxzg4-542287825\":{\"id\":\"pod-log-to-github-mxzg4-542287825\",\"name\":\"pod-log-to-github-mxzg4.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-to-github-mxzg4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-to-github-mxzg4-2433661512\",\"startedAt\":\"2025-05-13T01:14:39Z\",\"finishedAt\":\"2025-05-13T01:15:02Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":22,\"memory\":22},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-to-github\\\",\\\"--run_id\\\",\\\"a797e690-1ae3-447c-9342-aaa288deef9a\\\",\\\"--execution_id\\\",\\\"161\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"30\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-to-github-mxzg4-2628596772\"],\"outboundNodes\":[\"pod-log-to-github-mxzg4-2628596772\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":63,\"memory\":60},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: NotFoundError: Failed to add PersistedFinalState label to workflow pod-log-to-github-mxzg4: workflows.argoproj.io \"pod-log-to-github-mxzg4\" not found"
time="2025-05-14T01:47:06Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-6mjmt): CustomError (code: 1): Syncing Workflow (pod-log-pipeline-advance-version-6mjmt): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-6mjmt\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"c595bd68-8f29-41e3-9e6a-f5497f3a431a\",\"resourceVersion\":\"9356773\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:08:37Z\",\"labels\":{\"pipeline/runid\":\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T01:08:18.050Z (26bbc)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:08:37Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:10:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-6mjmt\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt\",\"name\":\"pod-log-pipeline-advance-version-6mjmt\",\"displayName\":\"pod-log-pipeline-advance-version-6mjmt\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":133,\"memory\":130},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-1071061704\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]},\"pod-log-pipeline-advance-version-6mjmt-1071061704\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-1071061704\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:08:41Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"247\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-dag-driver-1071061704/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-845231455\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-1075591460\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-1075591460\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:10:09Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]},\"pod-log-pipeline-advance-version-6mjmt-2059872728\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-2059872728\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:08:47Z\",\"finishedAt\":\"2025-05-14T01:08:51Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"247\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-driver-2059872728/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-416994863\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-3918935113\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-3918935113\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:09:59Z\",\"finishedAt\":\"2025-05-14T01:10:03Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"247\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-driver-3918935113/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-1075591460\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-416994863\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-416994863\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:08:57Z\",\"finishedAt\":\"2025-05-14T01:09:59Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":125,\"memory\":124},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-78233902\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-78233902\"]},\"pod-log-pipeline-advance-version-6mjmt-78233902\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-78233902\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-416994863\",\"startedAt\":\"2025-05-14T01:08:57Z\",\"finishedAt\":\"2025-05-14T01:09:49Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":98,\"memory\":98},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-impl-78233902/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-3918935113\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-840676871\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-840676871\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-1075591460\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:10:09Z\",\"finishedAt\":\"2025-05-14T01:10:24Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-impl-840676871/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-845231455\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt\",\"startedAt\":\"2025-05-14T01:08:47Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":129,\"memory\":127},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"247\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-2059872728\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":133,\"memory\":130},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-6mjmt\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"c595bd68-8f29-41e3-9e6a-f5497f3a431a\",\"resourceVersion\":\"9356773\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:08:37Z\",\"labels\":{\"pipeline/runid\":\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T01:08:18.050Z (26bbc)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:08:37Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:10:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"fad61689-9c69-43be-b27b-537aa60bec4c\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-6mjmt\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt\",\"name\":\"pod-log-pipeline-advance-version-6mjmt\",\"displayName\":\"pod-log-pipeline-advance-version-6mjmt\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":133,\"memory\":130},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-1071061704\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]},\"pod-log-pipeline-advance-version-6mjmt-1071061704\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-1071061704\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt\",\"startedAt\":\"2025-05-14T01:08:37Z\",\"finishedAt\":\"2025-05-14T01:08:41Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"247\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-dag-driver-1071061704/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-845231455\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-1075591460\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-1075591460\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:10:09Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]},\"pod-log-pipeline-advance-version-6mjmt-2059872728\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-2059872728\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:08:47Z\",\"finishedAt\":\"2025-05-14T01:08:51Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"247\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-driver-2059872728/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-416994863\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-3918935113\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-3918935113\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:09:59Z\",\"finishedAt\":\"2025-05-14T01:10:03Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"247\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-driver-3918935113/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-1075591460\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-416994863\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-416994863\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"startedAt\":\"2025-05-14T01:08:57Z\",\"finishedAt\":\"2025-05-14T01:09:59Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":125,\"memory\":124},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-78233902\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-78233902\"]},\"pod-log-pipeline-advance-version-6mjmt-78233902\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-78233902\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-416994863\",\"startedAt\":\"2025-05-14T01:08:57Z\",\"finishedAt\":\"2025-05-14T01:09:49Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":98,\"memory\":98},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"248\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns in seen_namespaces:\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-impl-78233902/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-3918935113\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-840676871\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-840676871\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt-1075591460\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:10:09Z\",\"finishedAt\":\"2025-05-14T01:10:24Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"fad61689-9c69-43be-b27b-537aa60bec4c\\\",\\\"--execution_id\\\",\\\"249\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"50\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/fad61689-9c69-43be-b27b-537aa60bec4c/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-6mjmt/2025/05/14/pod-log-pipeline-advance-version-6mjmt-system-container-impl-840676871/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-6mjmt-845231455\":{\"id\":\"pod-log-pipeline-advance-version-6mjmt-845231455\",\"name\":\"pod-log-pipeline-advance-version-6mjmt.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-6mjmt\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-6mjmt\",\"startedAt\":\"2025-05-14T01:08:47Z\",\"finishedAt\":\"2025-05-14T01:10:34Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":129,\"memory\":127},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"247\"}]},\"children\":[\"pod-log-pipeline-advance-version-6mjmt-2059872728\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-6mjmt-840676871\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":133,\"memory\":130},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-6mjmt\" namespace=\"kubeflow-user-example-com\" runId=\"fad61689-9c69-43be-b27b-537aa60bec4c\": Failed to fetch run fad61689-9c69-43be-b27b-537aa60bec4c: ResourceNotFoundError: Run fad61689-9c69-43be-b27b-537aa60bec4c not found"
time="2025-05-14T01:48:40Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-hp2h9): CustomError (code: 1): Syncing Workflow (pod-log-pipeline-advance-version-hp2h9): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-hp2h9\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"c9a6649c-6446-440e-8ccb-e898a55b0f0c\",\"resourceVersion\":\"9358019\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:11:54Z\",\"labels\":{\"pipeline/runid\":\"293b2239-b084-416a-bd81-d9678109359a\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T01:11:40.772Z (b3571)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:11:54Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:13:52Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"293b2239-b084-416a-bd81-d9678109359a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"293b2239-b084-416a-bd81-d9678109359a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"293b2239-b084-416a-bd81-d9678109359a\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:11:54Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-hp2h9\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9\",\"name\":\"pod-log-pipeline-advance-version-hp2h9\",\"displayName\":\"pod-log-pipeline-advance-version-hp2h9\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:11:54Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":136,\"memory\":133},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-1080812597\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-1080812597\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-1080812597\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9\",\"startedAt\":\"2025-05-14T01:11:55Z\",\"finishedAt\":\"2025-05-14T01:11:58Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"250\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-dag-driver-1080812597/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-860993320\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-1979268522\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-1979268522\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:13:17Z\",\"finishedAt\":\"2025-05-14T01:13:21Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"250\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-driver-1979268522/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-873341489\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-2712097757\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-2712097757\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:12:05Z\",\"finishedAt\":\"2025-05-14T01:12:08Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"250\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-driver-2712097757/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-336328032\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-336328032\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-336328032\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:12:15Z\",\"finishedAt\":\"2025-05-14T01:13:17Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":129,\"memory\":128},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-88240651\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-88240651\"]},\"pod-log-pipeline-advance-version-hp2h9-569372292\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-569372292\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-873341489\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:13:27Z\",\"finishedAt\":\"2025-05-14T01:13:42Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-impl-569372292/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-860993320\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9\",\"startedAt\":\"2025-05-14T01:12:05Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":133,\"memory\":131},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"250\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-2712097757\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-873341489\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-873341489\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:13:27Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-88240651\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-88240651\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-336328032\",\"startedAt\":\"2025-05-14T01:12:15Z\",\"finishedAt\":\"2025-05-14T01:13:08Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":102,\"memory\":102},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-impl-88240651/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-1979268522\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":136,\"memory\":133},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-hp2h9\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"c9a6649c-6446-440e-8ccb-e898a55b0f0c\",\"resourceVersion\":\"9358019\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:11:54Z\",\"labels\":{\"pipeline/runid\":\"293b2239-b084-416a-bd81-d9678109359a\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T01:11:40.772Z (b3571)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:11:54Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:13:52Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"293b2239-b084-416a-bd81-d9678109359a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"293b2239-b084-416a-bd81-d9678109359a\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"293b2239-b084-416a-bd81-d9678109359a\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:11:54Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-hp2h9\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9\",\"name\":\"pod-log-pipeline-advance-version-hp2h9\",\"displayName\":\"pod-log-pipeline-advance-version-hp2h9\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:11:54Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":136,\"memory\":133},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-1080812597\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-1080812597\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-1080812597\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9\",\"startedAt\":\"2025-05-14T01:11:55Z\",\"finishedAt\":\"2025-05-14T01:11:58Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"250\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-dag-driver-1080812597/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-860993320\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-1979268522\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-1979268522\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:13:17Z\",\"finishedAt\":\"2025-05-14T01:13:21Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"250\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-driver-1979268522/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-873341489\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-2712097757\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-2712097757\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:12:05Z\",\"finishedAt\":\"2025-05-14T01:12:08Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"250\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-driver-2712097757/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-336328032\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-336328032\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-336328032\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:12:15Z\",\"finishedAt\":\"2025-05-14T01:13:17Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":129,\"memory\":128},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-88240651\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-88240651\"]},\"pod-log-pipeline-advance-version-hp2h9-569372292\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-569372292\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-873341489\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:13:27Z\",\"finishedAt\":\"2025-05-14T01:13:42Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-impl-569372292/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-hp2h9-860993320\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9\",\"startedAt\":\"2025-05-14T01:12:05Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":133,\"memory\":131},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"250\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-2712097757\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-873341489\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-873341489\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-860993320\",\"startedAt\":\"2025-05-14T01:13:27Z\",\"finishedAt\":\"2025-05-14T01:13:52Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"252\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"51\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-hp2h9-569372292\"]},\"pod-log-pipeline-advance-version-hp2h9-88240651\":{\"id\":\"pod-log-pipeline-advance-version-hp2h9-88240651\",\"name\":\"pod-log-pipeline-advance-version-hp2h9.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-hp2h9\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-hp2h9-336328032\",\"startedAt\":\"2025-05-14T01:12:15Z\",\"finishedAt\":\"2025-05-14T01:13:08Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":102,\"memory\":102},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"293b2239-b084-416a-bd81-d9678109359a\\\",\\\"--execution_id\\\",\\\"251\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/293b2239-b084-416a-bd81-d9678109359a/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-hp2h9/2025/05/14/pod-log-pipeline-advance-version-hp2h9-system-container-impl-88240651/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-hp2h9-1979268522\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":136,\"memory\":133},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-hp2h9\" namespace=\"kubeflow-user-example-com\" runId=\"293b2239-b084-416a-bd81-d9678109359a\": Failed to fetch run 293b2239-b084-416a-bd81-d9678109359a: ResourceNotFoundError: Run 293b2239-b084-416a-bd81-d9678109359a not found"
time="2025-05-14T01:50:41Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-m9f6j): CustomError (code: 1): Syncing Workflow (pod-log-pipeline-advance-version-m9f6j): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-m9f6j\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"3c3f1441-a0c3-4056-944d-3cb527f9dff1\",\"resourceVersion\":\"9358847\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:13:56Z\",\"labels\":{\"pipeline/runid\":\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:13:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:15:51Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-m9f6j\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j\",\"name\":\"pod-log-pipeline-advance-version-m9f6j\",\"displayName\":\"pod-log-pipeline-advance-version-m9f6j\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":137,\"memory\":134},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-2094096536\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-1224221736\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-1224221736\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:14:06Z\",\"finishedAt\":\"2025-05-14T01:14:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"253\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-driver-1224221736/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-1878115775\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-1878115775\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-1878115775\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:14:16Z\",\"finishedAt\":\"2025-05-14T01:15:21Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":130,\"memory\":129},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3948683934\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-3948683934\"]},\"pod-log-pipeline-advance-version-m9f6j-2090866031\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j\",\"startedAt\":\"2025-05-14T01:14:06Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":134,\"memory\":132},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"253\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-1224221736\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-2094096536\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-2094096536\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:14:00Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"253\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-dag-driver-2094096536/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-2090866031\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-3160090457\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3160090457\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:15:21Z\",\"finishedAt\":\"2025-05-14T01:15:24Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"253\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-driver-3160090457/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3352850164\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-3352850164\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3352850164\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:15:31Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":25,\"memory\":25},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-3948683934\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3948683934\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-1878115775\",\"startedAt\":\"2025-05-14T01:14:16Z\",\"finishedAt\":\"2025-05-14T01:15:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":102,\"memory\":102},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-impl-3948683934/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3160090457\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-58911351\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-58911351\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-3352850164\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:15:31Z\",\"finishedAt\":\"2025-05-14T01:15:46Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":25,\"memory\":25},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-impl-58911351/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":137,\"memory\":134},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-m9f6j\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"3c3f1441-a0c3-4056-944d-3cb527f9dff1\",\"resourceVersion\":\"9358847\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T01:13:56Z\",\"labels\":{\"pipeline/runid\":\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:13:56Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T01:15:51Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-m9f6j\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j\",\"name\":\"pod-log-pipeline-advance-version-m9f6j\",\"displayName\":\"pod-log-pipeline-advance-version-m9f6j\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":137,\"memory\":134},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-2094096536\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-1224221736\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-1224221736\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:14:06Z\",\"finishedAt\":\"2025-05-14T01:14:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"253\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-driver-1224221736/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-1878115775\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-1878115775\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-1878115775\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:14:16Z\",\"finishedAt\":\"2025-05-14T01:15:21Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":130,\"memory\":129},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3948683934\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-3948683934\"]},\"pod-log-pipeline-advance-version-m9f6j-2090866031\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j\",\"startedAt\":\"2025-05-14T01:14:06Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":134,\"memory\":132},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"253\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-1224221736\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-2094096536\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-2094096536\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j\",\"startedAt\":\"2025-05-14T01:13:56Z\",\"finishedAt\":\"2025-05-14T01:14:00Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"253\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-dag-driver-2094096536/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-2090866031\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-3160090457\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3160090457\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:15:21Z\",\"finishedAt\":\"2025-05-14T01:15:24Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"253\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-driver-3160090457/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3352850164\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-3352850164\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3352850164\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-2090866031\",\"startedAt\":\"2025-05-14T01:15:31Z\",\"finishedAt\":\"2025-05-14T01:15:51Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":25,\"memory\":25},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-m9f6j-58911351\"]},\"pod-log-pipeline-advance-version-m9f6j-3948683934\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-3948683934\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-1878115775\",\"startedAt\":\"2025-05-14T01:14:16Z\",\"finishedAt\":\"2025-05-14T01:15:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":102,\"memory\":102},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"254\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    alert_pods_summary = []\\\\n\\\\n    # Pod 상태 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o json\\\\\\\"\\\\n    )\\\\n    import json\\\\n    pods_json = json.loads(pods_output)\\\\n\\\\n    pod_info_list = []\\\\n    for item in pods_json[\\\\\\\"items\\\\\\\"]:\\\\n        namespace = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"namespace\\\\\\\"]\\\\n        if namespace == excluded_namespace:\\\\n            continue\\\\n        name = item[\\\\\\\"metadata\\\\\\\"][\\\\\\\"name\\\\\\\"]\\\\n        status = item[\\\\\\\"status\\\\\\\"].get(\\\\\\\"phase\\\\\\\", \\\\\\\"Unknown\\\\\\\")\\\\n        pod_info_list.append((namespace, name, status))\\\\n\\\\n    # HTML 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n                .no-events {{ font-style: italic; color: #888; }}\\\\n                .summary-box {{ background-color: #ffeaa7; padding: 10px; border: 1px solid #e1b12c; border-radius: 10px; margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\")\\\\n\\\\n        # Pod 상태별 처리\\\\n        for namespace, pod_name, status in pod_info_list:\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            # 상태에 따른 색상 이모지\\\\n            status_lower = status.lower()\\\\n            if status_lower == \\\\\\\"running\\\\\\\":\\\\n                status_color = \\\\\\\"🟢\\\\\\\"\\\\n            elif any(w in status_lower for w in [\\\\\\\"error\\\\\\\", \\\\\\\"failed\\\\\\\", \\\\\\\"<span class='keyword'>crashloopbackoff</span>\\\\\\\", \\\\\\\"<span class='keyword'>evicted</span>\\\\\\\"]):\\\\n                status_color = \\\\\\\"🔴\\\\\\\"\\\\n            else:\\\\n                status_color = \\\\\\\"🟠\\\\\\\"\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                alert_pods_summary.append(\\\\n                    f\\\\\\\"{status_color} {namespace}/{pod_name} → 키워드 감지: {', '.join(sorted(matched_keywords))}\\\\\\\"\\\\n                )\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e{status_color} Pod: {pod_name} (Namespace: {namespace}, 상태: {status}) - 감지된 키워드: {', '.join(sorted(matched_keywords))}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            # 이벤트 수집\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace} --sort-by=.lastTimestamp\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 문제 요약 출력\\\\n        if alert_pods_summary:\\\\n            f.write(\\\\\\\"\\\\u003cdiv class='summary-box'\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 발생 Pod 요약\\\\u003c/h2\\\\u003e\\\\u003cul\\\\u003e\\\\\\\")\\\\n            for item in alert_pods_summary:\\\\n                f.write(f\\\\\\\"\\\\u003cli\\\\u003e{item}\\\\u003c/li\\\\u003e\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/ul\\\\u003e\\\\u003c/div\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        # 이벤트 출력\\\\n        for ns in sorted(seen_namespaces):\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            events = namespace_events.get(ns, [])\\\\n            if events:\\\\n                for line in events:\\\\n                    for kw in event_kw_list:\\\\n                        if kw in line.lower():\\\\n                            line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                    f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            else:\\\\n                f.write(\\\\\\\"\\\\u003cspan class='no-events'\\\\u003e🔍 감지된 이벤트 없음 (지정된 키워드 없음)\\\\u003c/span\\\\u003e\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-impl-3948683934/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-m9f6j-3160090457\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-m9f6j-58911351\":{\"id\":\"pod-log-pipeline-advance-version-m9f6j-58911351\",\"name\":\"pod-log-pipeline-advance-version-m9f6j.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-m9f6j\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-m9f6j-3352850164\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T01:15:31Z\",\"finishedAt\":\"2025-05-14T01:15:46Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":25,\"memory\":25},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\\\",\\\"--execution_id\\\",\\\"255\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"52\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/81d0b0e0-78c7-47ca-81ac-dc03c8498cf4/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-m9f6j/2025/05/14/pod-log-pipeline-advance-version-m9f6j-system-container-impl-58911351/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":137,\"memory\":134},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"pod-log-pipeline-advance-version-m9f6j\" namespace=\"kubeflow-user-example-com\" runId=\"81d0b0e0-78c7-47ca-81ac-dc03c8498cf4\": Failed to fetch run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4: ResourceNotFoundError: Run 81d0b0e0-78c7-47ca-81ac-dc03c8498cf4 not found"
</pre>
</section>
<section><h2>Pod 상태 요약</h2><pre>Running: 60
Succeeded: 2
</pre></section>
<section><h2>Pod 리소스 사용량 (kubectl top pod)</h2><pre>error: Metrics API not available
kubectl top pod 사용 불가</pre></section>
<section><h2>Namespace 이벤트: auth</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: cert-manager</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: istio-system</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: knative-serving</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: kube-flannel</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: kube-system</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: kubeflow</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: local-path-storage</h2><pre>감지된 이벤트 없음.
</pre></section>
<section><h2>Namespace 이벤트: oauth2-proxy</h2><pre>감지된 이벤트 없음.
</pre></section>
</body></html>