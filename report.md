# 장애 복기 리포트 (keyword: `crash`)

## Pod: `pod-log-to-github-kmxkl-system-container-driver-3811604332` (Namespace: `kubeflow-user-example-com`)
### describe
```text
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"102"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","b154ee1c-cfaf-4508-8b9b-ac90af9ada50","--dag_execution_id","102","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-driver-3811604332"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"102"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","b154ee1c-cfaf-4508-8b9b-ac90af9ada50","--dag_execution_id","102","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-driver-3811604332"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import subprocess\n    import shutil\n    import json\n    import os\n\n    tmp_report_path = \"/tmp/report.md\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치 방법 변경\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get all pods in all namespaces\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(f\"# 장애 복기 리포트 (keyword: `{keyword}`)\\n\\n\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if keyword in l])\n\n            if matched_describe or matched_logs:\n                f.write(f\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\n\")\n                if matched_describe:\n                    f.write(\"### describe\\n```text\\n\" + matched_describe + \"\\n```\\n\")\n                if matched_logs:\n                    f.write(\"### logs\\n```text\\n\" + matched_logs + \"\\n```\\n\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if keyword in l])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # Write filtered events grouped by namespace\n        for ns, events in namespace_events.items():\n            f.write(f\"\\n## Events in Namespace: `{ns}`\\n```text\\n{events}\\n```\\n\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"102"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","b154ee1c-cfaf-4508-8b9b-ac90af9ada50","--dag_execution_id","102","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-driver-3811604332"}}}
```
### logs
```text
        "defaultValue": "crash",
    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import subprocess\n    import shutil\n    import json\n    import os\n\n    tmp_report_path = \"/tmp/report.md\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치 방법 변경\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get all pods in all namespaces\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(f\"# 장애 복기 리포트 (keyword: `{keyword}`)\\n\\n\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if keyword in l])\n\n            if matched_describe or matched_logs:\n                f.write(f\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\n\")\n                if matched_describe:\n                    f.write(\"### describe\\n```text\\n\" + matched_describe + \"\\n```\\n\")\n                if matched_logs:\n                    f.write(\"### logs\\n```text\\n\" + matched_logs + \"\\n```\\n\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if keyword in l])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # Write filtered events grouped by namespace\n        for ns, events in namespace_events.items():\n            f.write(f\"\\n## Events in Namespace: `{ns}`\\n```text\\n{events}\\n```\\n\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","pod-log-to-github","--run_id","b154ee1c-cfaf-4508-8b9b-ac90af9ada50","--execution_id","103","--executor_input","{\"inputs\":{}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"parameterType\":\"STRING\", \"defaultValue\":\"crash\", \"isOptional\":true}}}, \"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import subprocess\n    import shutil\n    import json\n    import os\n\n    tmp_report_path = \"/tmp/report.md\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치 방법 변경\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get all pods in all namespaces\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(f\"# 장애 복기 리포트 (keyword: `{keyword}`)\\n\\n\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if keyword in l])\n\n            if matched_describe or matched_logs:\n                f.write(f\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\n\")\n                if matched_describe:\n                    f.write(\"### describe\\n```text\\n\" + matched_describe + \"\\n```\\n\")\n                if matched_logs:\n                    f.write(\"### logs\\n```text\\n\" + matched_logs + \"\\n```\\n\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if keyword in l])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # Write filtered events grouped by namespace\n        for ns, events in namespace_events.items():\n            f.write(f\"\\n## Events in Namespace: `{ns}`\\n```text\\n{events}\\n```\\n\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
```
## Pod: `pod-log-to-github-kmxkl-system-container-impl-2099142466` (Namespace: `kubeflow-user-example-com`)
### describe
```text
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-impl-2099142466"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-impl-2099142466"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-impl-2099142466"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-kmxkl/2025/05/08/pod-log-to-github-kmxkl-system-container-impl-2099142466"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"b154ee1c-cfaf-4508-8b9b-ac90af9ada50\",\"--execution_id\",\"103\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/b154ee1c-cfaf-4508-8b9b-ac90af9ada50/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import subprocess\\n    import shutil\\n    import json\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.md\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치 방법 변경\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get all pods in all namespaces\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(f\\\"# 장애 복기 리포트 (keyword: `{keyword}`)\\\\n\\\\n\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if keyword in l])\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"## Pod: `{pod_name}` (Namespace: `{namespace}`)\\\\n\\\")\\n                if matched_describe:\\n                    f.write(\\\"### describe\\\\n```text\\\\n\\\" + matched_describe + \\\"\\\\n```\\\\n\\\")\\n                if matched_logs:\\n                    f.write(\\\"### logs\\\\n```text\\\\n\\\" + matched_logs + \\\"\\\\n```\\\\n\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if keyword in l])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # Write filtered events grouped by namespace\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\\\n## Events in Namespace: `{ns}`\\\\n```text\\\\n{events}\\\\n```\\\\n\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
```
### logs
```text
        "defaultValue": "crash",
            "keyword": "crash"
```
