
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}
                h1 {{ color: #2c3e50; }}
                h2 {{ color: #34495e; }}
                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}
                section {{ margin-bottom: 30px; }}
            </style>
        </head>
        <body>
        <h1>Kubernetes 장애 점검 리포트</h1>
        <section><h2>Pod: cert-manager-7ddd8cdb9f-z2xzm (Namespace: cert-manager)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:http-healthz/livez delay=10s timeout=15s period=10s #success=1 #failure=8</pre><h3>Logs (Last 10 lines)</h3><pre>I0428 06:49:08.641065       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-key-manager" key="kubeflow/katib-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"katib-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:16.700675       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-readiness" key="kubeflow/admission-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"admission-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:16.928182       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-key-manager" key="kubeflow/admission-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"admission-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:16.998387       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-readiness" key="kubeflow/admission-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"admission-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:17.004264       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-issuing" key="kubeflow/admission-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"admission-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:17.009986       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-key-manager" key="kubeflow/admission-webhook-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"admission-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:32.870986       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-trigger" key="kubeflow/pvcviewer-serving-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"pvcviewer-serving-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:33.392302       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-key-manager" key="kubeflow/pvcviewer-serving-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"pvcviewer-serving-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:33.472544       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-readiness" key="kubeflow/pvcviewer-serving-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"pvcviewer-serving-cert\": the object has been modified; please apply your changes to the latest version and try again"
I0428 06:49:33.491700       1 controller.go:162] "re-queuing item due to optimistic locking on resource" logger="cert-manager.certificates-key-manager" key="kubeflow/pvcviewer-serving-cert" error="Operation cannot be fulfilled on certificates.cert-manager.io \"pvcviewer-serving-cert\": the object has been modified; please apply your changes to the latest version and try again"</pre></section><section><h2>Pod: cert-manager-cainjector-57cd76c845-smrfg (Namespace: cert-manager)</h2><h3>Logs (Last 10 lines)</h3><pre>E0428 06:49:33.664559       1 controller.go:329] "Reconciler error" err="Operation cannot be fulfilled on customresourcedefinitions.apiextensions.k8s.io \"pvcviewers.kubeflow.org\": the object has been modified; please apply your changes to the latest version and try again" logger="cert-manager" controller="customresourcedefinition" controllerGroup="apiextensions.k8s.io" controllerKind="CustomResourceDefinition" CustomResourceDefinition="pvcviewers.kubeflow.org" namespace="" name="pvcviewers.kubeflow.org" reconcileID="b678024f-63fc-4c38-91fe-27b2611ec1e0"</pre></section><section><h2>Pod: cert-manager-webhook-cf8f9f895-grszt (Namespace: cert-manager)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:6080/livez delay=60s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:6080/healthz delay=5s timeout=1s period=5s #success=1 #failure=3</pre></section><section><h2>Pod: cluster-local-gateway-595b55bdb4-kgj8w (Namespace: istio-system)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=1s timeout=1s period=2s #success=1 #failure=30</pre><h3>Logs (Last 10 lines)</h3><pre>2025-04-28T06:43:50.319069Z	info	FLAG: --proxyComponentLogLevel="misc:error"
2025-04-28T06:43:50.560230Z	info	Envoy command: [-c etc/istio/proxy/envoy-rev.json --drain-time-s 45 --drain-strategy immediate --local-address-ip-version v4 --file-flush-interval-msec 1000 --disable-hot-restart --allow-unknown-static-fields -l warning --component-log-level misc:error --concurrency 2]</pre></section><section><h2>Pod: istio-ingressgateway-66c5cb4897-l2j4l (Namespace: istio-system)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=1s timeout=1s period=2s #success=1 #failure=30</pre></section><section><h2>Pod: istiod-58fb67c76f-2znkk (Namespace: istio-system)</h2><h3>Describe</h3><pre>    Readiness:  http-get http://:8080/ready delay=1s timeout=5s period=3s #success=1 #failure=3</pre></section><section><h2>Pod: activator-54c999bcbc-4vglt (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/activator/livez delay=15s timeout=1s period=10s #success=1 #failure=12
    Readiness:  http-get http://:15020/app-health/activator/readyz delay=0s timeout=1s period=5s #success=1 #failure=5
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>{"severity":"ERROR","timestamp":"2025-05-10T18:45:19.238783334Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"read tcp 10.244.1.242:36922->10.96.80.146:8080: read: connection reset by peer","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-11T00:45:20.953003322Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"websocket: close 1006 (abnormal closure): unexpected EOF","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-11T06:45:22.447622265Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"read tcp 10.244.1.242:48528->10.96.80.146:8080: read: connection reset by peer","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-11T12:45:24.07681127Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"websocket: close 1006 (abnormal closure): unexpected EOF","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-11T18:45:25.732047863Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"read tcp 10.244.1.242:45052->10.96.80.146:8080: read: connection reset by peer","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-12T00:45:27.416778704Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"websocket: close 1006 (abnormal closure): unexpected EOF","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-12T06:45:29.159584115Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"read tcp 10.244.1.242:48940->10.96.80.146:8080: read: connection reset by peer","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-12T12:45:30.860826418Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"websocket: close 1006 (abnormal closure): unexpected EOF","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-12T18:45:32.302683181Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"read tcp 10.244.1.242:53620->10.96.80.146:8080: read: connection reset by peer","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}
{"severity":"ERROR","timestamp":"2025-05-13T00:45:34.092003687Z","logger":"activator","caller":"websocket/connection.go:168","message":"Connection to ws://autoscaler.knative-serving.svc.cluster.local:8080 broke down, reconnecting...","commit":"9d21588","knative.dev/controller":"activator","knative.dev/pod":"activator-54c999bcbc-4vglt","error":"websocket: close 1006 (abnormal closure): unexpected EOF","stacktrace":"knative.dev/pkg/websocket.NewDurableConnection.func2\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/websocket/connection.go:168"}</pre></section><section><h2>Pod: autoscaler-776bbf9496-t5tdn (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/autoscaler/livez delay=0s timeout=1s period=10s #success=1 #failure=6
    Readiness:  http-get http://:15020/app-health/autoscaler/readyz delay=0s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: controller-854dcfd65b-krjgp (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/controller/livez delay=0s timeout=1s period=5s #success=1 #failure=6
    Readiness:  http-get http://:15020/app-health/controller/readyz delay=0s timeout=1s period=5s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.889603183Z","logger":"controller","caller":"reconciler/reconciler.go:280","message":"Returned an error","commit":"9d21588","knative.dev/pod":"controller-854dcfd65b-krjgp","knative.dev/controller":"knative.dev.networking.pkg.certificates.reconciler.reconciler","knative.dev/kind":"core.Secret","knative.dev/traceid":"7893f51f-b9ad-43b6-84c3-c157cc2605f3","knative.dev/key":"knative-serving/knative-serving-certs","targetMethod":"ReconcileKind","error":"Operation cannot be fulfilled on secrets \"serving-certs-ctrl-ca\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/networking/pkg/certificates/reconciler.(*reconcilerImpl).Reconcile\n\tknative.dev/networking@v0.0.0-20231017124814-2a7676e912b7/pkg/certificates/reconciler/reconciler.go:280\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:542\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.889695755Z","logger":"controller","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"controller-854dcfd65b-krjgp","knative.dev/controller":"knative.dev.networking.pkg.certificates.reconciler.reconciler","knative.dev/kind":"core.Secret","knative.dev/traceid":"7893f51f-b9ad-43b6-84c3-c157cc2605f3","knative.dev/key":"knative-serving/knative-serving-certs","duration":"973.741199ms","error":"Operation cannot be fulfilled on secrets \"serving-certs-ctrl-ca\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}</pre></section><section><h2>Pod: net-istio-controller-79d44bc46d-lltw8 (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/controller/livez delay=0s timeout=1s period=5s #success=1 #failure=6
    Readiness:  http-get http://:15020/app-health/controller/readyz delay=0s timeout=1s period=5s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: net-istio-webhook-ff94788ff-tpprf (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/webhook/livez delay=20s timeout=1s period=1s #success=1 #failure=6
    Readiness:  http-get http://:15020/app-health/webhook/readyz delay=0s timeout=1s period=1s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.055966191Z","logger":"net-istio-webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"64667191-6185-4573-8148-d64120b741a3","knative.dev/key":"webhook.istio.networking.internal.knative.dev","duration":"21.795µs","error":"secret \"net-istio-webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.056139811Z","logger":"net-istio-webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"57d391cb-44f1-4590-8854-cf50e16d2986","knative.dev/key":"config.webhook.istio.networking.internal.knative.dev","duration":"17.524µs","error":"secret \"net-istio-webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.109091056Z","logger":"net-istio-webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"c9dd2221-b909-4f04-80dd-5cf27c64eb89","knative.dev/key":"config.webhook.istio.networking.internal.knative.dev","duration":"47.088851ms","error":"failed to update webhook: Operation cannot be fulfilled on validatingwebhookconfigurations.admissionregistration.k8s.io \"config.webhook.istio.networking.internal.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.109662177Z","logger":"net-istio-webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"a2e7648b-2071-463c-a6ea-c391160c510c","knative.dev/key":"webhook.istio.networking.internal.knative.dev","duration":"44.649004ms","error":"failed to update webhook: Operation cannot be fulfilled on mutatingwebhookconfigurations.admissionregistration.k8s.io \"webhook.istio.networking.internal.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-05-04T12:43:46.310938126Z","logger":"net-istio-webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"60eadb95-8143-453e-9e54-631844d7f7f4","knative.dev/key":"webhook.istio.networking.internal.knative.dev","duration":"286.069301ms","error":"failed to update webhook: Operation cannot be fulfilled on mutatingwebhookconfigurations.admissionregistration.k8s.io \"webhook.istio.networking.internal.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-05-10T18:43:46.32250771Z","logger":"net-istio-webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"85829465-8639-4ec7-a605-268c71083e43","knative.dev/key":"knative-serving/net-istio-webhook-certs","duration":"308.810042ms","error":"failed to update webhook: Operation cannot be fulfilled on validatingwebhookconfigurations.admissionregistration.k8s.io \"config.webhook.istio.networking.internal.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-05-10T18:43:46.322738383Z","logger":"net-istio-webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"916ac51-dirty","knative.dev/traceid":"63f560bf-88d5-4a51-a402-6c2c69dae20f","knative.dev/key":"webhook.istio.networking.internal.knative.dev","duration":"201.024969ms","error":"failed to update webhook: Operation cannot be fulfilled on mutatingwebhookconfigurations.admissionregistration.k8s.io \"webhook.istio.networking.internal.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}</pre></section><section><h2>Pod: webhook-56bccb4b4f-67mg6 (Namespace: knative-serving)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/webhook/livez delay=20s timeout=1s period=1s #success=1 #failure=6
    Readiness:  http-get http://:15020/app-health/webhook/readyz delay=0s timeout=1s period=1s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.542567994Z","logger":"webhook.ValidationWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"ce7b47ff-b988-42d0-be3c-76804d0344c0","knative.dev/key":"validation.webhook.serving.knative.dev","duration":"39.112µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.54278926Z","logger":"webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"3c16c2f8-cd8d-4ba7-8f9e-3a3bf2d2e46b","knative.dev/key":"webhook.serving.knative.dev","duration":"17.099µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.54298686Z","logger":"webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"8dd2f27d-7153-4654-9a6a-832ff8660416","knative.dev/key":"config.webhook.serving.knative.dev","duration":"19.735µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.548755013Z","logger":"webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"9b1554b5-a8fd-4914-b218-fb36dbe2502c","knative.dev/key":"config.webhook.serving.knative.dev","duration":"20.216µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.548861054Z","logger":"webhook.ValidationWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"f2150e03-8cf5-4649-8403-163e2d50e3c0","knative.dev/key":"validation.webhook.serving.knative.dev","duration":"15.561µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.549027881Z","logger":"webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"ee6e01f7-ada7-4c5d-9bb6-6caff00c9bea","knative.dev/key":"webhook.serving.knative.dev","duration":"16.321µs","error":"secret \"webhook-certs\" is missing \"ca-cert.pem\" key","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.592489349Z","logger":"webhook.DefaultingWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"31b481db-aba7-4c20-9330-9e222a437670","knative.dev/key":"webhook.serving.knative.dev","duration":"32.420573ms","error":"failed to update webhook: Operation cannot be fulfilled on mutatingwebhookconfigurations.admissionregistration.k8s.io \"webhook.serving.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.593002794Z","logger":"webhook.ValidationWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"9ae080ef-f2bb-492a-9207-d426dd6995f8","knative.dev/key":"validation.webhook.serving.knative.dev","duration":"32.442371ms","error":"failed to update webhook: Operation cannot be fulfilled on validatingwebhookconfigurations.admissionregistration.k8s.io \"validation.webhook.serving.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}
{"severity":"ERROR","timestamp":"2025-04-28T06:43:46.593451992Z","logger":"webhook.ConfigMapWebhook","caller":"controller/controller.go:566","message":"Reconcile error","commit":"9d21588","knative.dev/pod":"webhook-56bccb4b4f-67mg6","knative.dev/traceid":"1d12fb99-d4fd-4381-97b7-d1e6508b5491","knative.dev/key":"config.webhook.serving.knative.dev","duration":"33.082878ms","error":"failed to update webhook: Operation cannot be fulfilled on validatingwebhookconfigurations.admissionregistration.k8s.io \"config.webhook.serving.knative.dev\": the object has been modified; please apply your changes to the latest version and try again","stacktrace":"knative.dev/pkg/controller.(*Impl).handleErr\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:566\nknative.dev/pkg/controller.(*Impl).processNextWorkItem\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:543\nknative.dev/pkg/controller.(*Impl).RunContext.func3\n\tknative.dev/pkg@v0.0.0-20231023151236-29775d7c9e5c/controller/controller.go:491"}</pre></section><section><h2>Pod: kube-flannel-ds-brk8q (Namespace: kube-flannel)</h2><h3>Logs (Last 10 lines)</h3><pre>W0425 06:37:37.487615       1 reflector.go:462] pkg/subnet/kube/kube.go:470: watch of *v1.Node ended with: an error on the server ("unable to decode an event from the watch stream: http2: client connection lost") has prevented the request from succeeding
W0425 06:38:43.365286       1 reflector.go:539] pkg/subnet/kube/kube.go:470: failed to list *v1.Node: Get "https://10.96.0.1:443/api/v1/nodes?resourceVersion=90263": net/http: TLS handshake timeout
E0425 06:38:56.368289       1 reflector.go:147] pkg/subnet/kube/kube.go:470: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://10.96.0.1:443/api/v1/nodes?resourceVersion=90263": net/http: TLS handshake timeout
W0425 06:40:34.672461       1 reflector.go:539] pkg/subnet/kube/kube.go:470: failed to list *v1.Node: Get "https://10.96.0.1:443/api/v1/nodes?resourceVersion=90263": net/http: TLS handshake timeout
E0425 06:40:59.760522       1 reflector.go:147] pkg/subnet/kube/kube.go:470: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://10.96.0.1:443/api/v1/nodes?resourceVersion=90263": net/http: TLS handshake timeout</pre></section><section><h2>Pod: kube-flannel-ds-clk96 (Namespace: kube-flannel)</h2><h3>Logs (Last 10 lines)</h3><pre>E0513 03:46:40.845970       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 03:52:50.848121       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:01:57.850626       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:11:20.852921       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:21:09.855954       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:27:34.858578       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:34:02.861072       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:42:19.864064       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:48:15.866469       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:54:13.868340       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory</pre></section><section><h2>Pod: kube-flannel-ds-rfd8t (Namespace: kube-flannel)</h2><h3>Logs (Last 10 lines)</h3><pre>E0513 03:53:17.922050       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:00:12.924227       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:07:18.926878       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:15:01.929599       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:20:55.932534       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:30:37.934890       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:39:42.937432       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:46:02.939472       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:52:06.942375       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:57:24.944509       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory</pre></section><section><h2>Pod: coredns-76f75df574-fcnqj (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get http://:8080/health delay=60s timeout=5s period=10s #success=1 #failure=5
    Readiness:    http-get http://:8181/ready delay=0s timeout=1s period=10s #success=1 #failure=3</pre><h3>Logs (Last 10 lines)</h3><pre>[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.1.239:52017->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.1.239:34928->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.1.239:60650->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.1.239:59513->8.8.8.8:53: i/o timeout</pre></section><section><h2>Pod: coredns-76f75df574-mmccd (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get http://:8080/health delay=60s timeout=5s period=10s #success=1 #failure=5
    Readiness:    http-get http://:8181/ready delay=0s timeout=1s period=10s #success=1 #failure=3</pre><h3>Logs (Last 10 lines)</h3><pre>[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:52759->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:38892->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:54437->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:40837->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:45915->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:59168->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:57768->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:38889->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:41296->8.8.8.8:53: i/o timeout
[ERROR] plugin/errors: 2 metadata-grpc-service. AAAA: read udp 10.244.2.198:60368->8.8.8.8:53: i/o timeout</pre></section><section><h2>Pod: etcd-k8s-kubeflow-master01 (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get http://127.0.0.1:2381/health%3Fexclude=NOSPACE&serializable=true delay=10s timeout=15s period=10s #success=1 #failure=8
    Startup:      http-get http://127.0.0.1:2381/health%3Fserializable=false delay=10s timeout=15s period=10s #success=1 #failure=24</pre><h3>Logs (Last 10 lines)</h3><pre>{"level":"warn","ts":"2025-04-25T06:48:25.152649Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:48:55.153111Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:49:25.154504Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:49:55.155716Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:50:25.156686Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:50:55.157368Z","caller":"fileutil/purge.go:80","msg":"failed to lock file","path":"/var/lib/etcd/member/wal/0000000000000061-0000000000015f42.wal","error":"fileutil: file already locked"}
{"level":"warn","ts":"2025-04-25T06:53:48.880009Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.286368286s","expected-duration":"100ms","prefix":"","request":"header:<ID:1683667219982052766 username:\"kube-apiserver-etcd-client\" auth_revision:1 > txn:<compare:<target:MOD key:\"/registry/leases/kube-system/kube-scheduler\" mod_revision:96391 > success:<request_put:<key:\"/registry/leases/kube-system/kube-scheduler\" value_size:425 >> failure:<request_range:<key:\"/registry/leases/kube-system/kube-scheduler\" > >>","response":"size:18"}
{"level":"warn","ts":"2025-04-25T06:53:48.880348Z","caller":"v3rpc/interceptor.go:197","msg":"request stats","start time":"2025-04-25T06:53:46.593071Z","time spent":"2.287205811s","remote":"127.0.0.1:51896","response type":"/etcdserverpb.KV/Txn","request count":1,"request size":476,"response count":0,"response size":40,"request content":"compare:<target:MOD key:\"/registry/leases/kube-system/kube-scheduler\" mod_revision:96391 > success:<request_put:<key:\"/registry/leases/kube-system/kube-scheduler\" value_size:425 >> failure:<request_range:<key:\"/registry/leases/kube-system/kube-scheduler\" > >"}
{"level":"warn","ts":"2025-04-25T06:53:48.956456Z","caller":"v3rpc/interceptor.go:197","msg":"request stats","start time":"2025-04-25T06:53:46.831488Z","time spent":"2.124870821s","remote":"127.0.0.1:51718","response type":"/etcdserverpb.KV/Txn","request count":1,"request size":881,"response count":0,"response size":40,"request content":"compare:<target:MOD key:\"/registry/events/kubeflow/tensorboards-web-app-deployment-568fc5687-cq62c.18397d3be7e0c28e\" mod_revision:0 > success:<request_put:<key:\"/registry/events/kubeflow/tensorboards-web-app-deployment-568fc5687-cq62c.18397d3be7e0c28e\" value_size:773 lease:1683667219982052290 >> failure:<>"}
{"level":"warn","ts":"2025-04-25T06:53:48.966733Z","caller":"v3rpc/interceptor.go:197","msg":"request stats","start time":"2025-04-25T06:53:47.912857Z","time spent":"1.053834044s","remote":"127.0.0.1:55612","response type":"/etcdserverpb.KV/Txn","request count":1,"request size":950,"response count":0,"response size":40,"request content":"compare:<target:MOD key:\"/registry/dex.coreos.com/authrequests/auth/poym4n6i37d2tn32y6zyetnkm\" mod_revision:0 > success:<request_put:<key:\"/registry/dex.coreos.com/authrequests/auth/poym4n6i37d2tn32y6zyetnkm\" value_size:874 >> failure:<>"}</pre></section><section><h2>Pod: kube-apiserver-k8s-kubeflow-master01 (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get https://192.168.2.231:6443/livez delay=10s timeout=15s period=10s #success=1 #failure=8
    Readiness:    http-get https://192.168.2.231:6443/readyz delay=0s timeout=15s period=1s #success=1 #failure=3
    Startup:      http-get https://192.168.2.231:6443/livez delay=10s timeout=15s period=10s #success=1 #failure=24</pre><h3>Logs (Last 10 lines)</h3><pre>W0428 05:53:02.030076       1 dispatcher.go:225] rejected by webhook "rev.validation.istio.io": &errors.StatusError{ErrStatus:v1.Status{TypeMeta:v1.TypeMeta{Kind:"", APIVersion:""}, ListMeta:v1.ListMeta{SelfLink:"", ResourceVersion:"", Continue:"", RemainingItemCount:(*int64)(nil)}, Status:"Failure", Message:"admission webhook \"rev.validation.istio.io\" denied the request: configuration is invalid: \"internal.istio.io/webhook-always-reject\" annotation found, rejecting", Reason:"", Details:(*v1.StatusDetails)(nil), Code:400}}
W0428 06:45:47.975700       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:48.999798       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:50.023804       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:51.047740       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:52.071755       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:53.095615       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:54.119748       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:55.143772       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused
W0428 06:45:56.168648       1 dispatcher.go:217] Failed calling webhook, failing closed clusterservingruntime.kserve-webhook-server.validator: failed calling webhook "clusterservingruntime.kserve-webhook-server.validator": failed to call webhook: Post "https://kserve-webhook-server-service.kubeflow.svc:443/validate-serving-kserve-io-v1alpha1-clusterservingruntime?timeout=10s": dial tcp 10.111.163.159:443: connect: connection refused</pre></section><section><h2>Pod: kube-controller-manager-k8s-kubeflow-master01 (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get https://127.0.0.1:10257/healthz delay=10s timeout=15s period=10s #success=1 #failure=8
    Startup:      http-get https://127.0.0.1:10257/healthz delay=10s timeout=15s period=10s #success=1 #failure=24</pre><h3>Logs (Last 10 lines)</h3><pre>I0513 04:59:12.107538       1 event.go:376] "Event occurred" object="istio-system/istio-ingressgateway" fieldPath="" kind="HorizontalPodAutoscaler" apiVersion="autoscaling/v2" type="Warning" reason="FailedComputeMetricsReplicas" message="invalid metrics (1 invalid out of 1), first error is: failed to get cpu resource metric value: failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)"
E0513 04:59:12.107846       1 horizontal.go:274] failed to compute desired number of replicas based on listed metrics for Deployment/knative-serving/activator: invalid metrics (1 invalid out of 1), first error is: failed to get cpu resource metric value: failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)
I0513 04:59:12.107887       1 event.go:376] "Event occurred" object="knative-serving/activator" fieldPath="" kind="HorizontalPodAutoscaler" apiVersion="autoscaling/v2" type="Warning" reason="FailedGetResourceMetric" message="failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)"
I0513 04:59:12.107906       1 event.go:376] "Event occurred" object="knative-serving/activator" fieldPath="" kind="HorizontalPodAutoscaler" apiVersion="autoscaling/v2" type="Warning" reason="FailedComputeMetricsReplicas" message="invalid metrics (1 invalid out of 1), first error is: failed to get cpu resource metric value: failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)"
W0513 04:59:12.606337       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource
E0513 04:59:12.606397       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.PartialObjectMetadata: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource
W0513 04:59:13.985175       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource
E0513 04:59:13.985216       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.PartialObjectMetadata: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource
W0513 04:59:16.390190       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource
E0513 04:59:16.390227       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.PartialObjectMetadata: failed to list *v1.PartialObjectMetadata: the server could not find the requested resource</pre></section><section><h2>Pod: kube-proxy-j9hkr (Namespace: kube-system)</h2><h3>Logs (Last 10 lines)</h3><pre>W0425 06:40:54.046473       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90225": net/http: TLS handshake timeout
Trace[76351691]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90225": net/http: TLS handshake timeout 104975ms (06:40:52.699)
Trace[794795268]: ---"Objects listed" error:Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90233": net/http: TLS handshake timeout 104561ms (06:40:52.699)
E0425 06:41:17.362947       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.EndpointSlice: failed to list *v1.EndpointSlice: Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90233": net/http: TLS handshake timeout
E0425 06:41:21.378630       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Service: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90225": net/http: TLS handshake timeout
W0425 06:42:23.349732       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-master01&resourceVersion=90296": net/http: TLS handshake timeout
Trace[102776452]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-master01&resourceVersion=90296": net/http: TLS handshake timeout 166636ms (06:42:23.023)
E0425 06:42:25.229373       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-master01&resourceVersion=90296": net/http: TLS handshake timeout
Trace[124830391]: ---"Objects listed" error:<nil> 60794ms (06:42:26.267)
Trace[1360826250]: ---"Objects listed" error:<nil> 62825ms (06:42:26.270)</pre></section><section><h2>Pod: kube-proxy-m4dwc (Namespace: kube-system)</h2><h3>Logs (Last 10 lines)</h3><pre>E0425 06:40:54.932347       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker01&resourceVersion=90230": net/http: TLS handshake timeout
W0425 06:41:28.672390       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90314": net/http: TLS handshake timeout
Trace[1238649649]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90314": net/http: TLS handshake timeout 10001ms (06:41:28.672)
E0425 06:41:28.672507       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Service: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90314": net/http: TLS handshake timeout
W0425 06:41:31.512106       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.EndpointSlice: Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90287": net/http: TLS handshake timeout
Trace[1433389425]: ---"Objects listed" error:Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90287": net/http: TLS handshake timeout 10001ms (06:41:31.512)
E0425 06:41:31.512251       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.EndpointSlice: failed to list *v1.EndpointSlice: Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90287": net/http: TLS handshake timeout
W0425 06:41:59.172328       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker01&resourceVersion=90230": net/http: TLS handshake timeout
Trace[1340810292]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker01&resourceVersion=90230": net/http: TLS handshake timeout 10002ms (06:41:59.172)
E0425 06:41:59.172427       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker01&resourceVersion=90230": net/http: TLS handshake timeout</pre></section><section><h2>Pod: kube-proxy-t7hf5 (Namespace: kube-system)</h2><h3>Logs (Last 10 lines)</h3><pre>E0425 06:41:29.131868       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Service: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90243": net/http: TLS handshake timeout
W0425 06:41:34.139904       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker02&resourceVersion=90280": net/http: TLS handshake timeout
Trace[1668996479]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker02&resourceVersion=90280": net/http: TLS handshake timeout 10004ms (06:41:34.139)
E0425 06:41:34.139992       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Node: failed to list *v1.Node: Get "https://192.168.2.231:6443/api/v1/nodes?fieldSelector=metadata.name%3Dk8s-kubeflow-worker02&resourceVersion=90280": net/http: TLS handshake timeout
W0425 06:41:55.876596       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.EndpointSlice: Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90164": net/http: TLS handshake timeout
Trace[201211911]: ---"Objects listed" error:Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90164": net/http: TLS handshake timeout 10001ms (06:41:55.876)
E0425 06:41:55.876700       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.EndpointSlice: failed to list *v1.EndpointSlice: Get "https://192.168.2.231:6443/apis/discovery.k8s.io/v1/endpointslices?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90164": net/http: TLS handshake timeout
W0425 06:42:11.177108       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90243": net/http: TLS handshake timeout
Trace[913053617]: ---"Objects listed" error:Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90243": net/http: TLS handshake timeout 10001ms (06:42:11.177)
E0425 06:42:11.177211       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.Service: failed to list *v1.Service: Get "https://192.168.2.231:6443/api/v1/services?labelSelector=%21service.kubernetes.io%2Fheadless%2C%21service.kubernetes.io%2Fservice-proxy-name&resourceVersion=90243": net/http: TLS handshake timeout</pre></section><section><h2>Pod: kube-scheduler-k8s-kubeflow-master01 (Namespace: kube-system)</h2><h3>Describe</h3><pre>    Liveness:     http-get https://127.0.0.1:10259/healthz delay=10s timeout=15s period=10s #success=1 #failure=8
    Startup:      http-get https://127.0.0.1:10259/healthz delay=10s timeout=15s period=10s #success=1 #failure=24</pre><h3>Logs (Last 10 lines)</h3><pre>W0425 06:43:47.448161       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.ConfigMap: configmaps "extension-apiserver-authentication" is forbidden: User "system:kube-scheduler" cannot list resource "configmaps" in API group "" in the namespace "kube-system"
E0425 06:43:47.448189       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.ConfigMap: failed to list *v1.ConfigMap: configmaps "extension-apiserver-authentication" is forbidden: User "system:kube-scheduler" cannot list resource "configmaps" in API group "" in the namespace "kube-system"
W0425 06:43:47.448285       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.StatefulSet: statefulsets.apps is forbidden: User "system:kube-scheduler" cannot list resource "statefulsets" in API group "apps" at the cluster scope
E0425 06:43:47.448307       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.StatefulSet: failed to list *v1.StatefulSet: statefulsets.apps is forbidden: User "system:kube-scheduler" cannot list resource "statefulsets" in API group "apps" at the cluster scope
W0425 06:43:47.448370       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.CSIDriver: csidrivers.storage.k8s.io is forbidden: User "system:kube-scheduler" cannot list resource "csidrivers" in API group "storage.k8s.io" at the cluster scope
E0425 06:43:47.448411       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.CSIDriver: failed to list *v1.CSIDriver: csidrivers.storage.k8s.io is forbidden: User "system:kube-scheduler" cannot list resource "csidrivers" in API group "storage.k8s.io" at the cluster scope
W0425 06:43:47.448371       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.PodDisruptionBudget: poddisruptionbudgets.policy is forbidden: User "system:kube-scheduler" cannot list resource "poddisruptionbudgets" in API group "policy" at the cluster scope
W0425 06:43:47.448432       1 reflector.go:539] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: failed to list *v1.StorageClass: storageclasses.storage.k8s.io is forbidden: User "system:kube-scheduler" cannot list resource "storageclasses" in API group "storage.k8s.io" at the cluster scope
E0425 06:43:47.448462       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.StorageClass: failed to list *v1.StorageClass: storageclasses.storage.k8s.io is forbidden: User "system:kube-scheduler" cannot list resource "storageclasses" in API group "storage.k8s.io" at the cluster scope
E0425 06:43:47.448435       1 reflector.go:147] k8s.io/client-go@v0.0.0/tools/cache/reflector.go:229: Failed to watch *v1.PodDisruptionBudget: failed to list *v1.PodDisruptionBudget: poddisruptionbudgets.policy is forbidden: User "system:kube-scheduler" cannot list resource "poddisruptionbudgets" in API group "policy" at the cluster scope</pre></section><section><h2>Pod: kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"173"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","173","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"173"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","173","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"event_keywords":{"defaultValue":"CrashLoopBackOff","isOptional":true,"parameterType":"STRING"},"log_keywords":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \"crash\", event_keywords: str = \"CrashLoopBackOff\"):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\",\")]\n    event_keys = [k.strip() for k in event_keywords.split(\",\")]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\", encoding=\"utf-8\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"173"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","173","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-driver-2270300684"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \"crash\", event_keywords: str = \"CrashLoopBackOff\"):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\",\")]\n    event_keys = [k.strip() for k in event_keywords.split(\",\")]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\", encoding=\"utf-8\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
I0513 04:58:45.393955      15 driver.go:252] parent DAG: id:173  name:"run/b4552194-b316-49fe-8ade-36ee4ec911fb"  type_id:13  type:"system.DAGExecution"  last_known_state:RUNNING  custom_properties:{key:"display_name"  value:{string_value:""}}  custom_properties:{key:"inputs"  value:{struct_value:{fields:{key:"branch"  value:{string_value:"report"}}  fields:{key:"event_keywords"  value:{string_value:"CrashLoopBackOff,Failed,Unhealthy"}}  fields:{key:"github_token"  value:{string_value:"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"}}  fields:{key:"log_keywords"  value:{string_value:"crash,error,fail"}}  fields:{key:"repo_url"  value:{string_value:"https://github.com/Rosa1026/Kubeflow.git"}}}}}  custom_properties:{key:"task_name"  value:{string_value:""}}  create_time_since_epoch:1747112315432  last_update_time_since_epoch:1747112315432
I0513 04:58:45.434345      15 driver.go:926] parent DAG input parameters: map[branch:string_value:"report" event_keywords:string_value:"CrashLoopBackOff,Failed,Unhealthy" github_token:string_value:"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" log_keywords:string_value:"crash,error,fail" repo_url:string_value:"https://github.com/Rosa1026/Kubeflow.git"], artifacts: map[]
I0513 04:58:45.519265      15 driver.go:310] Created execution: id:174  type_id:14  type:"system.ContainerExecution"  last_known_state:RUNNING  custom_properties:{key:"cache_fingerprint"  value:{string_value:"99919ba4da8dc7bd0e660df3cb154109cd1edad72826b01f9599f7571d5efbcb"}}  custom_properties:{key:"display_name"  value:{string_value:"collect-filtered-logs"}}  custom_properties:{key:"image"  value:{string_value:""}}  custom_properties:{key:"inputs"  value:{struct_value:{fields:{key:"event_keywords"  value:{string_value:"CrashLoopBackOff,Failed,Unhealthy"}}  fields:{key:"log_keywords"  value:{string_value:"crash,error,fail"}}}}}  custom_properties:{key:"namespace"  value:{string_value:""}}  custom_properties:{key:"parent_dag_id"  value:{int_value:173}}  custom_properties:{key:"pod_name"  value:{string_value:""}}  custom_properties:{key:"pod_uid"  value:{string_value:""}}  custom_properties:{key:"task_name"  value:{string_value:"collect-filtered-logs"}}  create_time_since_epoch:1747112325484  last_update_time_since_epoch:1747112325484
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--execution_id","174","--executor_input","{\"inputs\":{\"parameterValues\":{\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\", \"log_keywords\":\"crash,error,fail\"}}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"inputDefinitions\":{\"parameters\":{\"event_keywords\":{\"parameterType\":\"STRING\", \"defaultValue\":\"CrashLoopBackOff\", \"isOptional\":true}, \"log_keywords\":{\"parameterType\":\"STRING\", \"defaultValue\":\"crash\", \"isOptional\":true}}}, \"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \"crash\", event_keywords: str = \"CrashLoopBackOff\"):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 안전한 keyword 파싱\n    log_keys = [k.strip() for k in log_keywords.split(\",\")]\n    event_keys = [k.strip() for k in event_keywords.split(\",\")]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\", encoding=\"utf-8\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = \"\\n\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\n            matched_logs = \"\\n\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (Last 10 lines)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = \"\\n\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch3\u003eEvents in Namespace: {ns}\u003c/h3\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
      "log_keywords": "crash,error,fail"
time="2025-05-13T04:58:46.144Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputs":{"parameterValues":{"event_keywords":"CrashLoopBackOff,Failed,Unhealthy", "log_keywords":"crash,error,fail"}}, "outputs":{"artifacts":{"output_report":{"artifacts":[{"type":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}, "uri":"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report"}]}}, "outputFile":"/tmp/kfp_outputs/output_metadata.json"}}
      {"inputDefinitions":{"parameters":{"event_keywords":{"parameterType":"STRING", "defaultValue":"CrashLoopBackOff", "isOptional":true}, "log_keywords":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = "crash", event_keywords: str = "CrashLoopBackOff"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-container-impl-1230814434"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"b4552194-b316-49fe-8ade-36ee4ec911fb\",\"--execution_id\",\"174\",\"--executor_input\",\"{\\\"inputs\\\":{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\", \\\"log_keywords\\\":\\\"crash,error,fail\\\"}}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/kubeflow-cluster-report-html/b4552194-b316-49fe-8ade-36ee4ec911fb/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"CrashLoopBackOff\\\", \\\"isOptional\\\":true}, \\\"log_keywords\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\"crash\\\", event_keywords: str = \\\"CrashLoopBackOff\\\"):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 안전한 keyword 파싱\\n    log_keys = [k.strip() for k in log_keywords.split(\\\",\\\")]\\n    event_keys = [k.strip() for k in event_keywords.split(\\\",\\\")]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\", encoding=\\\"utf-8\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if any(k in l for k in log_keys)])\\n            matched_logs = \\\"\\\\n\\\".join([l for l in logs.splitlines() if any(k in l for k in log_keys)][-10:])  # 마지막 10줄\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (Last 10 lines)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = \\\"\\\\n\\\".join([l for l in events.splitlines() if any(k in l for k in event_keys)])\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch3\\u003eEvents in Namespace: {ns}\\u003c/h3\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
            "log_keywords": "crash,error,fail"</pre></section><section><h2>Pod: kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-dag-driver","inputs":{"parameters":[{"name":"component","value":"{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}"},{"name":"runtime-config","default":"","value":"{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}"},{"name":"task","default":"","value":""},{"name":"parent-dag-id","default":"0","value":"0"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"driver-type","default":"DAG","value":"ROOT_DAG"}]},"outputs":{"parameters":[{"name":"execution-id","valueFrom":{"path":"/tmp/outputs/execution-id"}},{"name":"iteration-count","valueFrom":{"path":"/tmp/outputs/iteration-count","default":"0"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","ROOT_DAG","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","0","--component","{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}","--task","","--runtime_config","{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}","--iteration_index","-1","--execution_id_path","/tmp/outputs/execution-id","--iteration_count_path","/tmp/outputs/iteration-count","--condition_path","/tmp/outputs/condition"],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972"}}}
      ARGO_TEMPLATE:                      {"name":"system-dag-driver","inputs":{"parameters":[{"name":"component","value":"{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}"},{"name":"runtime-config","default":"","value":"{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}"},{"name":"task","default":"","value":""},{"name":"parent-dag-id","default":"0","value":"0"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"driver-type","default":"DAG","value":"ROOT_DAG"}]},"outputs":{"parameters":[{"name":"execution-id","valueFrom":{"path":"/tmp/outputs/execution-id"}},{"name":"iteration-count","valueFrom":{"path":"/tmp/outputs/iteration-count","default":"0"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","ROOT_DAG","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","0","--component","{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}","--task","","--runtime_config","{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}","--iteration_index","-1","--execution_id_path","/tmp/outputs/execution-id","--iteration_count_path","/tmp/outputs/iteration-count","--condition_path","/tmp/outputs/condition"],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972"}}}
      {"dag":{"tasks":{"collect-filtered-logs":{"cachingOptions":{"enableCache":true},"componentRef":{"name":"comp-collect-filtered-logs"},"inputs":{"parameters":{"event_keywords":{"componentInputParameter":"event_keywords"},"log_keywords":{"componentInputParameter":"log_keywords"}}},"taskInfo":{"name":"collect-filtered-logs"}},"upload-to-github":{"cachingOptions":{"enableCache":true},"componentRef":{"name":"comp-upload-to-github"},"dependentTasks":["collect-filtered-logs"],"inputs":{"artifacts":{"report_file":{"taskOutputArtifact":{"outputArtifactKey":"output_report","producerTask":"collect-filtered-logs"}}},"parameters":{"branch":{"componentInputParameter":"branch"},"github_token":{"componentInputParameter":"github_token"},"repo_url":{"componentInputParameter":"repo_url"}}},"taskInfo":{"name":"upload-to-github"}}}},"inputDefinitions":{"parameters":{"branch":{"defaultValue":"report","isOptional":true,"parameterType":"STRING"},"event_keywords":{"defaultValue":"CrashLoopBackOff,Failed,Unhealthy","isOptional":true,"parameterType":"STRING"},"github_token":{"defaultValue":"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","isOptional":true,"parameterType":"STRING"},"log_keywords":{"defaultValue":"crash,error,fail","isOptional":true,"parameterType":"STRING"},"repo_url":{"defaultValue":"https://github.com/Rosa1026/Kubeflow.git","isOptional":true,"parameterType":"STRING"}}}}
      {"parameterValues":{"branch":"report","event_keywords":"CrashLoopBackOff,Failed,Unhealthy","github_token":"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","log_keywords":"crash,error,fail","repo_url":"https://github.com/Rosa1026/Kubeflow.git"}}
      ARGO_TEMPLATE:                      {"name":"system-dag-driver","inputs":{"parameters":[{"name":"component","value":"{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}"},{"name":"runtime-config","default":"","value":"{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}"},{"name":"task","default":"","value":""},{"name":"parent-dag-id","default":"0","value":"0"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"driver-type","default":"DAG","value":"ROOT_DAG"}]},"outputs":{"parameters":[{"name":"execution-id","valueFrom":{"path":"/tmp/outputs/execution-id"}},{"name":"iteration-count","valueFrom":{"path":"/tmp/outputs/iteration-count","default":"0"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","ROOT_DAG","--pipeline_name","kubeflow-cluster-report-html","--run_id","b4552194-b316-49fe-8ade-36ee4ec911fb","--dag_execution_id","0","--component","{\"dag\":{\"tasks\":{\"collect-filtered-logs\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"inputs\":{\"parameters\":{\"event_keywords\":{\"componentInputParameter\":\"event_keywords\"},\"log_keywords\":{\"componentInputParameter\":\"log_keywords\"}}},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}},\"upload-to-github\":{\"cachingOptions\":{\"enableCache\":true},\"componentRef\":{\"name\":\"comp-upload-to-github\"},\"dependentTasks\":[\"collect-filtered-logs\"],\"inputs\":{\"artifacts\":{\"report_file\":{\"taskOutputArtifact\":{\"outputArtifactKey\":\"output_report\",\"producerTask\":\"collect-filtered-logs\"}}},\"parameters\":{\"branch\":{\"componentInputParameter\":\"branch\"},\"github_token\":{\"componentInputParameter\":\"github_token\"},\"repo_url\":{\"componentInputParameter\":\"repo_url\"}}},\"taskInfo\":{\"name\":\"upload-to-github\"}}}},\"inputDefinitions\":{\"parameters\":{\"branch\":{\"defaultValue\":\"report\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"event_keywords\":{\"defaultValue\":\"CrashLoopBackOff,Failed,Unhealthy\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"github_token\":{\"defaultValue\":\"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\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"log_keywords\":{\"defaultValue\":\"crash,error,fail\",\"isOptional\":true,\"parameterType\":\"STRING\"},\"repo_url\":{\"defaultValue\":\"https://github.com/Rosa1026/Kubeflow.git\",\"isOptional\":true,\"parameterType\":\"STRING\"}}}}","--task","","--runtime_config","{\"parameterValues\":{\"branch\":\"report\",\"event_keywords\":\"CrashLoopBackOff,Failed,Unhealthy\",\"github_token\":\"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\",\"log_keywords\":\"crash,error,fail\",\"repo_url\":\"https://github.com/Rosa1026/Kubeflow.git\"}}","--iteration_index","-1","--execution_id_path","/tmp/outputs/execution-id","--iteration_count_path","/tmp/outputs/iteration-count","--condition_path","/tmp/outputs/condition"],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/kubeflow-cluster-report-html-dvvqs/2025/05/13/kubeflow-cluster-report-html-dvvqs-system-dag-driver-1885421972"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash,error,fail",
    "log_keywords": "crash,error,fail",
I0513 04:58:35.476506      14 driver.go:185] Created execution: id:173  name:"run/b4552194-b316-49fe-8ade-36ee4ec911fb"  type_id:13  type:"system.DAGExecution"  last_known_state:RUNNING  custom_properties:{key:"display_name"  value:{string_value:""}}  custom_properties:{key:"inputs"  value:{struct_value:{fields:{key:"branch"  value:{string_value:"report"}}  fields:{key:"event_keywords"  value:{string_value:"CrashLoopBackOff,Failed,Unhealthy"}}  fields:{key:"github_token"  value:{string_value:"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"}}  fields:{key:"log_keywords"  value:{string_value:"crash,error,fail"}}  fields:{key:"repo_url"  value:{string_value:"https://github.com/Rosa1026/Kubeflow.git"}}}}}  custom_properties:{key:"task_name"  value:{string_value:""}}  create_time_since_epoch:1747112315432  last_update_time_since_epoch:1747112315432
time="2025-05-13T04:58:36.124Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: ml-pipeline-ui-artifact-55f4d57d68-sb9sf (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>[HPM] Subscribed to http-proxy events:  [ 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'proxyReq', 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'proxyReq', 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'proxyReq', 'error', 'close' ]
[HPM] Subscribed to http-proxy events:  [ 'proxyReq', 'error', 'close' ]</pre></section><section><h2>Pod: ml-pipeline-visualizationserver-57949d474-sz6pc (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-driver-2133261422 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:31:26.914Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-driver-844200209 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"164"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--dag_execution_id","164","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-driver-844200209"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","pod-log-to-github","--run_id","e091a3f3-7e7e-468a-8d4d-77a2bee20a87","--execution_id","165","--executor_input","{\"inputs\":{}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"parameterType\":\"STRING\", \"defaultValue\":\"crash\", \"isOptional\":true}}}, \"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
time="2025-05-13T01:30:17.528Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-impl-2852792872 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>remote: error: GH013: Repository rule violations found for refs/heads/report.        
error: failed to push some refs to 'https://github.com/Rosa1026/Kubeflow.git'
F0513 01:31:47.207807      23 main.go:49] failed to execute component: exit status 1
time="2025-05-13T01:31:48.020Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:31:48.954Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-container-impl-605240799 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-49hjk/2025/05/13/pod-log-to-github-49hjk-system-container-impl-605240799"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"e091a3f3-7e7e-468a-8d4d-77a2bee20a87\",\"--execution_id\",\"165\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/e091a3f3-7e7e-468a-8d4d-77a2bee20a87/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
            "keyword": "crash"
time="2025-05-13T01:31:13.723Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:31:14.643Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-49hjk-system-dag-driver-1399478097 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:30:07.519Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-fzpd7-system-container-driver-1929661354 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"162"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--dag_execution_id","162","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-driver-1929661354"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","pod-log-to-github","--run_id","c136dcc0-32cc-427f-9abb-577e4e56381c","--execution_id","163","--executor_input","{\"inputs\":{}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"parameterType\":\"STRING\", \"defaultValue\":\"crash\", \"isOptional\":true}}}, \"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
time="2025-05-13T01:24:52.126Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-fzpd7-system-container-impl-1277471876 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-fzpd7/2025/05/13/pod-log-to-github-fzpd7-system-container-impl-1277471876"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c136dcc0-32cc-427f-9abb-577e4e56381c\",\"--execution_id\",\"163\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c136dcc0-32cc-427f-9abb-577e4e56381c/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
            "keyword": "crash"
F0513 01:25:17.105146      24 main.go:49] failed to execute component: exit status 1
time="2025-05-13T01:25:17.325Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:25:18.263Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-fzpd7-system-dag-driver-1435271278 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:24:42.126Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-driver-1811512138 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:14:31.722Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-driver-451000317 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"159"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","a797e690-1ae3-447c-9342-aaa288deef9a","--dag_execution_id","159","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"159"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","a797e690-1ae3-447c-9342-aaa288deef9a","--dag_execution_id","159","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317"}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\"CrashLoopBackOff\", \"Error\", \"Failed\", \"ImagePullBackOff\", \"Pending\"]\n    describe_keywords = [\"CrashLoopBackOff\", \"OOMKilled\", \"Error\", \"Failed\", \"Back-off\"]\n    log_keywords = [\"Traceback\", \"panic\", \"exception\", \"fail\", \"error\"]\n    event_keywords = [\"Failed\", \"BackOff\", \"Unhealthy\", \"Killing\", \"Evicted\"]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\"\n    )\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    def match_keywords(lines, keywords):\n        return \"\\n\".join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            log_output = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \"\\n\".join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\")\n            if matched_describe:\n                f.write(\"\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_describe + \"\u003c/pre\u003e\")\n            if matched_logs:\n                f.write(\"\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_logs + \"\u003c/pre\u003e\")\n            f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"159"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","a797e690-1ae3-447c-9342-aaa288deef9a","--dag_execution_id","159","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-driver-451000317"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\"CrashLoopBackOff\", \"Error\", \"Failed\", \"ImagePullBackOff\", \"Pending\"]\n    describe_keywords = [\"CrashLoopBackOff\", \"OOMKilled\", \"Error\", \"Failed\", \"Back-off\"]\n    log_keywords = [\"Traceback\", \"panic\", \"exception\", \"fail\", \"error\"]\n    event_keywords = [\"Failed\", \"BackOff\", \"Unhealthy\", \"Killing\", \"Evicted\"]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\"\n    )\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    def match_keywords(lines, keywords):\n        return \"\\n\".join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            log_output = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \"\\n\".join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\")\n            if matched_describe:\n                f.write(\"\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_describe + \"\u003c/pre\u003e\")\n            if matched_logs:\n                f.write(\"\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_logs + \"\u003c/pre\u003e\")\n            f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","pod-log-to-github","--run_id","a797e690-1ae3-447c-9342-aaa288deef9a","--execution_id","160","--executor_input","{\"inputs\":{}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset]):\n    import subprocess\n    import os\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # 키워드 목록\n    status_keywords = [\"CrashLoopBackOff\", \"Error\", \"Failed\", \"ImagePullBackOff\", \"Pending\"]\n    describe_keywords = [\"CrashLoopBackOff\", \"OOMKilled\", \"Error\", \"Failed\", \"Back-off\"]\n    log_keywords = [\"Traceback\", \"panic\", \"exception\", \"fail\", \"error\"]\n    event_keywords = [\"Failed\", \"BackOff\", \"Unhealthy\", \"Killing\", \"Evicted\"]\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # Get pod status\n    pods_output = subprocess.getoutput(\n        \"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\"\n    )\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    def match_keywords(lines, keywords):\n        return \"\\n\".join([line for line in lines if any(k in line for k in keywords)])\n\n    with open(tmp_report_path, \"w\") as f:\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\n                h1 { color: #2c3e50; }\n                h2 { color: #34495e; }\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\n                section { margin-bottom: 30px; }\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \"\"\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name, status = line.strip().split()\n            except ValueError:\n                continue\n\n            if not any(k in status for k in status_keywords):\n                continue  # 중요 상태가 아닐 경우 무시\n\n            describe_output = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            log_output = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\n            log_lines = log_output.strip().splitlines()\n            last_logs = \"\\n\".join(log_lines[-10:])  # 마지막 10줄만\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\n\n            f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\u003c/h2\u003e\")\n            if matched_describe:\n                f.write(\"\u003ch3\u003eDescribe (filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_describe + \"\u003c/pre\u003e\")\n            if matched_logs:\n                f.write(\"\u003ch3\u003eLogs (last 10 lines, filtered)\u003c/h3\u003e\u003cpre\u003e\" + matched_logs + \"\u003c/pre\u003e\")\n            f.write(\"\u003c/section\u003e\")\n\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
time="2025-05-13T01:13:53.614Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-impl-169698603 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
          log_keywords = ["Traceback", "panic", "exception", "fail", "error"]
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-mxzg4/2025/05/13/pod-log-to-github-mxzg4-system-container-impl-169698603"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"a797e690-1ae3-447c-9342-aaa288deef9a\",\"--execution_id\",\"160\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/a797e690-1ae3-447c-9342-aaa288deef9a/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset]):\\n    import subprocess\\n    import os\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # 키워드 목록\\n    status_keywords = [\\\"CrashLoopBackOff\\\", \\\"Error\\\", \\\"Failed\\\", \\\"ImagePullBackOff\\\", \\\"Pending\\\"]\\n    describe_keywords = [\\\"CrashLoopBackOff\\\", \\\"OOMKilled\\\", \\\"Error\\\", \\\"Failed\\\", \\\"Back-off\\\"]\\n    log_keywords = [\\\"Traceback\\\", \\\"panic\\\", \\\"exception\\\", \\\"fail\\\", \\\"error\\\"]\\n    event_keywords = [\\\"Failed\\\", \\\"BackOff\\\", \\\"Unhealthy\\\", \\\"Killing\\\", \\\"Evicted\\\"]\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # Get pod status\\n    pods_output = subprocess.getoutput(\\n        \\\"kubectl get pods --all-namespaces -o=custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,STATUS:.status.phase' --no-headers\\\"\\n    )\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    def match_keywords(lines, keywords):\\n        return \\\"\\\\n\\\".join([line for line in lines if any(k in line for k in keywords)])\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }\\n                h1 { color: #2c3e50; }\\n                h2 { color: #34495e; }\\n                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }\\n                section { margin-bottom: 30px; }\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\\"\\\"\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name, status = line.strip().split()\\n            except ValueError:\\n                continue\\n\\n            if not any(k in status for k in status_keywords):\\n                continue  # 중요 상태가 아닐 경우 무시\\n\\n            describe_output = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            log_output = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n\\n            matched_describe = match_keywords(describe_output.splitlines(), describe_keywords)\\n            log_lines = log_output.strip().splitlines()\\n            last_logs = \\\"\\\\n\\\".join(log_lines[-10:])  # 마지막 10줄만\\n            matched_logs = match_keywords(last_logs.splitlines(), log_keywords)\\n\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}, Status: {status})\\u003c/h2\\u003e\\\")\\n            if matched_describe:\\n                f.write(\\\"\\u003ch3\\u003eDescribe (filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_describe + \\\"\\u003c/pre\\u003e\\\")\\n            if matched_logs:\\n                f.write(\\\"\\u003ch3\\u003eLogs (last 10 lines, filtered)\\u003c/h3\\u003e\\u003cpre\\u003e\\\" + matched_logs + \\\"\\u003c/pre\\u003e\\\")\\n            f.write(\\\"\\u003c/section\\u003e\\\")\\n\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                matched_events = match_keywords(events_output.splitlines(), event_keywords)\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:14:18.720Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:14:19.651Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-mxzg4-system-container-impl-2628596772 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:14:51.859Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:14:52.789Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-mxzg4-system-dag-driver-1135711573 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:13:43.527Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-driver-2116732566 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}
      {"executorLabel":"exec-collect-filtered-logs","inputDefinitions":{"parameters":{"keyword":{"defaultValue":"crash","isOptional":true,"parameterType":"STRING"}}},"outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset","schemaVersion":"0.0.1"}}}}}
      {"args":["--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"command":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"],"image":"python:3.9"}
      ARGO_TEMPLATE:                      {"name":"system-container-driver","inputs":{"parameters":[{"name":"component","value":"{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}"},{"name":"task","value":"{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}"},{"name":"container","value":"{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}"},{"name":"parent-dag-id","value":"167"},{"name":"iteration-index","default":"-1","value":"-1"},{"name":"kubernetes-config","default":"","value":""}]},"outputs":{"parameters":[{"name":"pod-spec-patch","valueFrom":{"path":"/tmp/outputs/pod-spec-patch","default":""}},{"name":"cached-decision","default":"false","valueFrom":{"path":"/tmp/outputs/cached-decision","default":"false"}},{"name":"condition","valueFrom":{"path":"/tmp/outputs/condition","default":"true"}}]},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec","command":["driver"],"args":["--type","CONTAINER","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--dag_execution_id","167","--component","{\"executorLabel\":\"exec-collect-filtered-logs\",\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"defaultValue\":\"crash\",\"isOptional\":true,\"parameterType\":\"STRING\"}}},\"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\",\"schemaVersion\":\"0.0.1\"}}}}}","--task","{\"cachingOptions\":{},\"componentRef\":{\"name\":\"comp-collect-filtered-logs\"},\"taskInfo\":{\"name\":\"collect-filtered-logs\"}}","--container","{\"args\":[\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"command\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\"],\"image\":\"python:3.9\"}","--iteration_index","-1","--cached_decision_path","/tmp/outputs/cached-decision","--pod_spec_patch_path","/tmp/outputs/pod-spec-patch","--condition_path","/tmp/outputs/condition","--kubernetes_config",""],"resources":{"limits":{"cpu":"500m","memory":"512Mi"},"requests":{"cpu":"100m","memory":"64Mi"}}},"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-driver-2116732566"}}}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
    "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n"
{"containers":[{"name":"main","image":"python:3.9","command":["/var/run/argo/argoexec","emissary","--","/kfp-launcher/launch","--pipeline_name","pod-log-to-github","--run_id","c060888e-844f-4dc0-a7ee-32d1caf0d0c0","--execution_id","168","--executor_input","{\"inputs\":{}, \"outputs\":{\"artifacts\":{\"output_report\":{\"artifacts\":[{\"type\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}, \"uri\":\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\"}]}}, \"outputFile\":\"/tmp/kfp_outputs/output_metadata.json\"}}","--component_spec","{\"inputDefinitions\":{\"parameters\":{\"keyword\":{\"parameterType\":\"STRING\", \"defaultValue\":\"crash\", \"isOptional\":true}}}, \"outputDefinitions\":{\"artifacts\":{\"output_report\":{\"artifactType\":{\"schemaTitle\":\"system.Dataset\", \"schemaVersion\":\"0.0.1\"}}}}, \"executorLabel\":\"exec-collect-filtered-logs\"}","--pod_name","$(KFP_POD_NAME)","--pod_uid","$(KFP_POD_UID)","--mlmd_server_address","$(METADATA_GRPC_SERVICE_HOST)","--mlmd_server_port","$(METADATA_GRPC_SERVICE_PORT)","--"],"args":["sh","-c","\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\u003e=3.7.4,\u003c5; python_version\u003c\"3.9\"' \u0026\u0026 \"$0\" \"$@\"\n","sh","-ec","program_path=$(mktemp -d)\n\nprintf \"%s\" \"$0\" \u003e \"$program_path/ephemeral_component.py\"\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n","\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \"crash\"):\n    import os\n    import subprocess\n\n    tmp_report_path = \"/tmp/report.html\"\n    seen_namespaces = set()\n    namespace_events = {}\n\n    # kubectl 설치\n    subprocess.run([\"apt-get\", \"update\", \"-y\"], check=True)\n    subprocess.run([\n        \"curl\", \"-LO\", \"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\"\n    ], check=True)\n    subprocess.run([\"chmod\", \"+x\", \"kubectl\"], check=True)\n    subprocess.run([\"mv\", \"kubectl\", \"/usr/local/bin/\"], check=True)\n\n    # 모든 Pods 조회\n    pods_output = subprocess.getoutput(\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\")\n    pod_lines = pods_output.strip().split(\"\\n\")\n\n    with open(tmp_report_path, \"w\") as f:\n        # HTML 시작\n        f.write(\"\"\"\n        \u003chtml\u003e\n        \u003chead\u003e\n            \u003cmeta charset=\"UTF-8\"\u003e\n            \u003cstyle\u003e\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\n                h1 {{ color: #2c3e50; }}\n                h2 {{ color: #34495e; }}\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\n                section {{ margin-bottom: 30px; }}\n            \u003c/style\u003e\n        \u003c/head\u003e\n        \u003cbody\u003e\n        \u003ch1\u003eKubernetes 장애 점검 리포트\u003c/h1\u003e\n        \u003csection\u003e\u003ch2\u003e입력된 키워드: \u003ccode\u003e{}\u003c/code\u003e\u003c/h2\u003e\u003c/section\u003e\n        \"\"\".format(keyword))\n\n        # 디버그: kubectl get pods 전체 결과\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: kubectl get pods 결과\u003c/h2\u003e\u003cpre\u003e{pods_output}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(f\"\u003csection\u003e\u003ch2\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\u003c/h2\u003e\u003c/section\u003e\")\n\n        for line in pod_lines:\n            if not line.strip():\n                continue\n            try:\n                namespace, pod_name = line.split()\n            except ValueError:\n                continue\n\n            describe = subprocess.getoutput(f\"kubectl describe pod {pod_name} -n {namespace}\")\n            logs_raw = subprocess.getoutput(f\"kubectl logs {pod_name} -n {namespace}\")\n            logs_last_10 = \"\\n\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\n\n            if keyword:\n                matched_describe = \"\\n\".join([l for l in describe.splitlines() if keyword in l])\n                matched_logs = \"\\n\".join([l for l in logs_last_10.splitlines() if keyword in l])\n            else:\n                matched_describe = describe\n                matched_logs = logs_last_10\n\n            if matched_describe or matched_logs:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace})\u003c/h2\u003e\")\n                if matched_describe:\n                    f.write(f\"\u003ch3\u003eDescribe\u003c/h3\u003e\u003cpre\u003e{matched_describe}\u003c/pre\u003e\")\n                if matched_logs:\n                    f.write(f\"\u003ch3\u003eLogs (최근 10줄)\u003c/h3\u003e\u003cpre\u003e{matched_logs}\u003c/pre\u003e\")\n                f.write(\"\u003c/section\u003e\")\n            else:\n                f.write(f\"\u003csection\u003e\u003ch2\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\u003c/h2\u003e\u003c/section\u003e\")\n\n            # 이벤트 처리\n            if namespace not in seen_namespaces:\n                events_output = subprocess.getoutput(f\"kubectl get events -n {namespace}\")\n                if keyword:\n                    matched_events = \"\\n\".join([l for l in events_output.splitlines() if keyword in l])\n                else:\n                    matched_events = events_output\n\n                if matched_events:\n                    namespace_events[namespace] = matched_events\n                seen_namespaces.add(namespace)\n\n        # 네임스페이스 별 이벤트 출력\n        for ns, events in namespace_events.items():\n            f.write(f\"\u003csection\u003e\u003ch2\u003eEvents in Namespace: {ns}\u003c/h2\u003e\u003cpre\u003e{events}\u003c/pre\u003e\u003c/section\u003e\")\n\n        f.write(\"\u003c/body\u003e\u003c/html\u003e\")\n\n    subprocess.run([\"cp\", tmp_report_path, output_report.path], check=True)\n\n","--executor_input","{{$}}","--function_to_execute","collect_filtered_logs"],"resources":{}}]}
time="2025-05-13T01:33:14.412Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-driver-2196521211 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:34:24.815Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-impl-359698432 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}
      {"inputDefinitions":{"parameters":{"keyword":{"parameterType":"STRING", "defaultValue":"crash", "isOptional":true}}}, "outputDefinitions":{"artifacts":{"output_report":{"artifactType":{"schemaTitle":"system.Dataset", "schemaVersion":"0.0.1"}}}}, "executorLabel":"exec-collect-filtered-logs"}
      def collect_filtered_logs(output_report: Output[Dataset], keyword: str = "crash"):
      ARGO_TEMPLATE:                      {"name":"system-container-impl","inputs":{"parameters":[{"name":"pod-spec-patch","value":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}]},"outputs":{},"metadata":{"annotations":{"sidecar.istio.io/inject":"false"}},"container":{"name":"","image":"gcr.io/ml-pipeline/should-be-overridden-during-runtime","command":["should-be-overridden-during-runtime"],"envFrom":[{"configMapRef":{"name":"metadata-grpc-configmap","optional":true}}],"env":[{"name":"KFP_POD_NAME","valueFrom":{"fieldRef":{"fieldPath":"metadata.name"}}},{"name":"KFP_POD_UID","valueFrom":{"fieldRef":{"fieldPath":"metadata.uid"}}}],"resources":{},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]},"volumes":[{"name":"kfp-launcher","emptyDir":{}}],"initContainers":[{"name":"kfp-launcher","image":"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f","command":["launcher-v2","--copy","/kfp-launcher/launch"],"resources":{"limits":{"cpu":"500m","memory":"128Mi"},"requests":{"cpu":"100m"}},"volumeMounts":[{"name":"kfp-launcher","mountPath":"/kfp-launcher"}]}],"archiveLocation":{"archiveLogs":true,"s3":{"endpoint":"minio-service.kubeflow:9000","bucket":"mlpipeline","insecure":true,"accessKeySecret":{"name":"mlpipeline-minio-artifact","key":"accesskey"},"secretKeySecret":{"name":"mlpipeline-minio-artifact","key":"secretkey"},"key":"artifacts/pod-log-to-github-w22xx/2025/05/13/pod-log-to-github-w22xx-system-container-impl-359698432"}},"podSpecPatch":"{\"containers\":[{\"name\":\"main\",\"image\":\"python:3.9\",\"command\":[\"/var/run/argo/argoexec\",\"emissary\",\"--\",\"/kfp-launcher/launch\",\"--pipeline_name\",\"pod-log-to-github\",\"--run_id\",\"c060888e-844f-4dc0-a7ee-32d1caf0d0c0\",\"--execution_id\",\"168\",\"--executor_input\",\"{\\\"inputs\\\":{}, \\\"outputs\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifacts\\\":[{\\\"type\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}, \\\"uri\\\":\\\"minio://mlpipeline/v2/artifacts/pod-log-to-github/c060888e-844f-4dc0-a7ee-32d1caf0d0c0/collect-filtered-logs/output_report\\\"}]}}, \\\"outputFile\\\":\\\"/tmp/kfp_outputs/output_metadata.json\\\"}}\",\"--component_spec\",\"{\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"keyword\\\":{\\\"parameterType\\\":\\\"STRING\\\", \\\"defaultValue\\\":\\\"crash\\\", \\\"isOptional\\\":true}}}, \\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\", \\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}, \\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\"}\",\"--pod_name\",\"$(KFP_POD_NAME)\",\"--pod_uid\",\"$(KFP_POD_UID)\",\"--mlmd_server_address\",\"$(METADATA_GRPC_SERVICE_HOST)\",\"--mlmd_server_port\",\"$(METADATA_GRPC_SERVICE_PORT)\",\"--\"],\"args\":[\"sh\",\"-c\",\"\\nif ! [ -x \\\"$(command -v pip)\\\" ]; then\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\nfi\\n\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\u003e=3.7.4,\\u003c5; python_version\\u003c\\\"3.9\\\"' \\u0026\\u0026 \\\"$0\\\" \\\"$@\\\"\\n\",\"sh\",\"-ec\",\"program_path=$(mktemp -d)\\n\\nprintf \\\"%s\\\" \\\"$0\\\" \\u003e \\\"$program_path/ephemeral_component.py\\\"\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\"$program_path/ephemeral_component.py\\\"                         \\\"$@\\\"\\n\",\"\\nimport kfp\\nfrom kfp import dsl\\nfrom kfp.dsl import *\\nfrom typing import *\\n\\ndef collect_filtered_logs(output_report: Output[Dataset], keyword: str = \\\"crash\\\"):\\n    import os\\n    import subprocess\\n\\n    tmp_report_path = \\\"/tmp/report.html\\\"\\n    seen_namespaces = set()\\n    namespace_events = {}\\n\\n    # kubectl 설치\\n    subprocess.run([\\\"apt-get\\\", \\\"update\\\", \\\"-y\\\"], check=True)\\n    subprocess.run([\\n        \\\"curl\\\", \\\"-LO\\\", \\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\"\\n    ], check=True)\\n    subprocess.run([\\\"chmod\\\", \\\"+x\\\", \\\"kubectl\\\"], check=True)\\n    subprocess.run([\\\"mv\\\", \\\"kubectl\\\", \\\"/usr/local/bin/\\\"], check=True)\\n\\n    # 모든 Pods 조회\\n    pods_output = subprocess.getoutput(\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\")\\n    pod_lines = pods_output.strip().split(\\\"\\\\n\\\")\\n\\n    with open(tmp_report_path, \\\"w\\\") as f:\\n        # HTML 시작\\n        f.write(\\\"\\\"\\\"\\n        \\u003chtml\\u003e\\n        \\u003chead\\u003e\\n            \\u003cmeta charset=\\\"UTF-8\\\"\\u003e\\n            \\u003cstyle\\u003e\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\n                h1 {{ color: #2c3e50; }}\\n                h2 {{ color: #34495e; }}\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\n                section {{ margin-bottom: 30px; }}\\n            \\u003c/style\\u003e\\n        \\u003c/head\\u003e\\n        \\u003cbody\\u003e\\n        \\u003ch1\\u003eKubernetes 장애 점검 리포트\\u003c/h1\\u003e\\n        \\u003csection\\u003e\\u003ch2\\u003e입력된 키워드: \\u003ccode\\u003e{}\\u003c/code\\u003e\\u003c/h2\\u003e\\u003c/section\\u003e\\n        \\\"\\\"\\\".format(keyword))\\n\\n        # 디버그: kubectl get pods 전체 결과\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: kubectl get pods 결과\\u003c/h2\\u003e\\u003cpre\\u003e{pods_output}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eDEBUG: 총 검사 대상 Pod 수: {len(pod_lines)}\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n        for line in pod_lines:\\n            if not line.strip():\\n                continue\\n            try:\\n                namespace, pod_name = line.split()\\n            except ValueError:\\n                continue\\n\\n            describe = subprocess.getoutput(f\\\"kubectl describe pod {pod_name} -n {namespace}\\\")\\n            logs_raw = subprocess.getoutput(f\\\"kubectl logs {pod_name} -n {namespace}\\\")\\n            logs_last_10 = \\\"\\\\n\\\".join(logs_raw.splitlines()[-10:])  # 마지막 10줄\\n\\n            if keyword:\\n                matched_describe = \\\"\\\\n\\\".join([l for l in describe.splitlines() if keyword in l])\\n                matched_logs = \\\"\\\\n\\\".join([l for l in logs_last_10.splitlines() if keyword in l])\\n            else:\\n                matched_describe = describe\\n                matched_logs = logs_last_10\\n\\n            if matched_describe or matched_logs:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace})\\u003c/h2\\u003e\\\")\\n                if matched_describe:\\n                    f.write(f\\\"\\u003ch3\\u003eDescribe\\u003c/h3\\u003e\\u003cpre\\u003e{matched_describe}\\u003c/pre\\u003e\\\")\\n                if matched_logs:\\n                    f.write(f\\\"\\u003ch3\\u003eLogs (최근 10줄)\\u003c/h3\\u003e\\u003cpre\\u003e{matched_logs}\\u003c/pre\\u003e\\\")\\n                f.write(\\\"\\u003c/section\\u003e\\\")\\n            else:\\n                f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003ePod: {pod_name} (Namespace: {namespace}) - 키워드 미포함\\u003c/h2\\u003e\\u003c/section\\u003e\\\")\\n\\n            # 이벤트 처리\\n            if namespace not in seen_namespaces:\\n                events_output = subprocess.getoutput(f\\\"kubectl get events -n {namespace}\\\")\\n                if keyword:\\n                    matched_events = \\\"\\\\n\\\".join([l for l in events_output.splitlines() if keyword in l])\\n                else:\\n                    matched_events = events_output\\n\\n                if matched_events:\\n                    namespace_events[namespace] = matched_events\\n                seen_namespaces.add(namespace)\\n\\n        # 네임스페이스 별 이벤트 출력\\n        for ns, events in namespace_events.items():\\n            f.write(f\\\"\\u003csection\\u003e\\u003ch2\\u003eEvents in Namespace: {ns}\\u003c/h2\\u003e\\u003cpre\\u003e{events}\\u003c/pre\\u003e\\u003c/section\\u003e\\\")\\n\\n        f.write(\\\"\\u003c/body\\u003e\\u003c/html\\u003e\\\")\\n\\n    subprocess.run([\\\"cp\\\", tmp_report_path, output_report.path], check=True)\\n\\n\",\"--executor_input\",\"{{$}}\",\"--function_to_execute\",\"collect_filtered_logs\"],\"resources\":{}}]}"}</pre><h3>Logs (Last 10 lines)</h3><pre>        "defaultValue": "crash",
            "keyword": "crash"
time="2025-05-13T01:34:11.581Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:34:12.519Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-container-impl-4089628493 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:34:44.910Z" level=info msg="sub-process exited" argo=true error="<nil>"
time="2025-05-13T01:34:45.843Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: pod-log-to-github-w22xx-system-dag-driver-1352252338 (Namespace: kubeflow-user-example-com)</h2><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:33:04.323Z" level=info msg="sub-process exited" argo=true error="<nil>"</pre></section><section><h2>Pod: test-0 (Namespace: kubeflow-user-example-com)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: admission-webhook-deployment-6d796b475c-ttrs2 (Namespace: kubeflow)</h2><h3>Logs (Last 10 lines)</h3><pre>I0428 06:49:17.823488       1 main.go:771] About to start serving webhooks: &http.Server{Addr:":4443", Handler:http.Handler(nil), DisableGeneralOptionsHandler:false, TLSConfig:(*tls.Config)(0xc0003031e0), ReadTimeout:0, ReadHeaderTimeout:0, WriteTimeout:0, IdleTimeout:0, MaxHeaderBytes:0, TLSNextProto:map[string]func(*http.Server, *tls.Conn, http.Handler)(nil), ConnState:(func(net.Conn, http.ConnState))(nil), ErrorLog:(*log.Logger)(nil), BaseContext:(func(net.Listener) context.Context)(nil), ConnContext:(func(context.Context, net.Conn) context.Context)(nil), inShutdown:atomic.Bool{_:atomic.noCopy{}, v:0x0}, disableKeepAlives:atomic.Bool{_:atomic.noCopy{}, v:0x0}, nextProtoOnce:sync.Once{done:0x0, m:sync.Mutex{state:0, sema:0x0}}, nextProtoErr:error(nil), mu:sync.Mutex{state:0, sema:0x0}, listeners:map[*net.Listener]struct {}(nil), activeConn:map[*http.conn]struct {}(nil), onShutdown:[]func()(nil), listenerGroup:sync.WaitGroup{noCopy:sync.noCopy{}, state:atomic.Uint64{_:atomic.noCopy{}, _:atomic.align64{}, v:0x0}, sema:0x0}}</pre></section><section><h2>Pod: cache-server-bb7c5cfb6-cwm85 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: centraldashboard-55c548fdf4-zp6lp (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:15020/app-health/centraldashboard/livez delay=30s timeout=1s period=30s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: jupyter-web-app-deployment-576dd45d74-bxspb (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: katib-controller-6c5684bf6b-l7bcj (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:healthz/healthz delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:healthz/readyz delay=0s timeout=1s period=10s #success=1 #failure=3</pre><h3>Logs (Last 10 lines)</h3><pre>{"level":"info","ts":"2025-04-28T06:49:09Z","logger":"trial-controller","msg":"Job watch error. CRD might be missing. Please install CRD and restart katib-controller","CRD Group":"kubeflow.org","CRD Version":"v1","CRD Kind":"TFJob"}
{"level":"info","ts":"2025-04-28T06:49:09Z","logger":"trial-controller","msg":"Job watch error. CRD might be missing. Please install CRD and restart katib-controller","CRD Group":"kubeflow.org","CRD Version":"v1","CRD Kind":"PyTorchJob"}
{"level":"info","ts":"2025-04-28T06:49:09Z","logger":"trial-controller","msg":"Job watch error. CRD might be missing. Please install CRD and restart katib-controller","CRD Group":"kubeflow.org","CRD Version":"v1","CRD Kind":"MPIJob"}
{"level":"info","ts":"2025-04-28T06:49:09Z","logger":"trial-controller","msg":"Job watch error. CRD might be missing. Please install CRD and restart katib-controller","CRD Group":"kubeflow.org","CRD Version":"v1","CRD Kind":"XGBoostJob"}
{"level":"info","ts":"2025-04-28T06:49:09Z","logger":"trial-controller","msg":"Job watch error. CRD might be missing. Please install CRD and restart katib-controller","CRD Group":"kubeflow.org","CRD Version":"v1","CRD Kind":"MXJob"}</pre></section><section><h2>Pod: katib-db-manager-7866998cf9-z7lj2 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       grpc <pod>:6789  delay=10s timeout=1s period=60s #success=1 #failure=5</pre><h3>Logs (Last 10 lines)</h3><pre>E0428 06:49:14.661177       1 connection.go:40] Ping to Katib db failed: dial tcp 10.100.199.151:3306: connect: connection refused
E0428 06:49:19.717249       1 connection.go:40] Ping to Katib db failed: dial tcp 10.100.199.151:3306: connect: connection refused
E0428 06:49:24.709335       1 connection.go:40] Ping to Katib db failed: dial tcp 10.100.199.151:3306: connect: connection refused</pre></section><section><h2>Pod: katib-mysql-76b79df5b5-qqfml (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       exec [/bin/bash -c mysqladmin ping -u root -p${MYSQL_ROOT_PASSWORD}] delay=10s timeout=1s period=5s #success=1 #failure=10
    Readiness:      exec [/bin/bash -c mysql -D ${MYSQL_DATABASE} -u root -p${MYSQL_ROOT_PASSWORD} -e 'SELECT 1'] delay=10s timeout=1s period=5s #success=1 #failure=10
    Startup:        exec [/bin/bash -c mysqladmin ping -u root -p${MYSQL_ROOT_PASSWORD}] delay=0s timeout=1s period=15s #success=1 #failure=60</pre></section><section><h2>Pod: katib-ui-657777bbff-x4tnm (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: kserve-controller-manager-79c67d6bb-j4d86 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:8081/healthz delay=10s timeout=5s period=10s #success=1 #failure=5
    Readiness:  http-get http://:8081/readyz delay=10s timeout=5s period=5s #success=1 #failure=10</pre></section><section><h2>Pod: kserve-models-web-app-5ccd4b66d6-d2lcp (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:15020/app-health/kserve-models-web-app/livez delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:15020/app-health/kserve-models-web-app/readyz delay=0s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: metacontroller-0 (Namespace: kubeflow)</h2><h3>Logs (Last 10 lines)</h3><pre>{"level":"error","ts":1745823050.650512,"msg":"failed to sync Namespace 'kubeflow-user-example-com': can't reconcile children for Namespace /kubeflow-user-example-com: [Operation cannot be fulfilled on deployments.apps \"ml-pipeline-visualizationserver\": the object has been modified; please apply your changes to the latest version and try again, Operation cannot be fulfilled on deployments.apps \"ml-pipeline-ui-artifact\": the object has been modified; please apply your changes to the latest version and try again]\n","stacktrace":"metacontroller/pkg/controller/composite.(*parentController).worker\n\t/go/src/metacontroller/pkg/controller/composite/controller.go:287\nk8s.io/apimachinery/pkg/util/wait.BackoffUntil.func1\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:155\nk8s.io/apimachinery/pkg/util/wait.BackoffUntil\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:156\nk8s.io/apimachinery/pkg/util/wait.JitterUntil\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:133\nk8s.io/apimachinery/pkg/util/wait.Until\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:90\nmetacontroller/pkg/controller/composite.(*parentController).Start.func1.1\n\t/go/src/metacontroller/pkg/controller/composite/controller.go:263"}
{"level":"error","ts":1745823053.7898242,"msg":"failed to sync Namespace 'kubeflow-user-example-com': can't reconcile children for Namespace /kubeflow-user-example-com: Operation cannot be fulfilled on deployments.apps \"ml-pipeline-ui-artifact\": the object has been modified; please apply your changes to the latest version and try again\n","stacktrace":"metacontroller/pkg/controller/composite.(*parentController).worker\n\t/go/src/metacontroller/pkg/controller/composite/controller.go:287\nk8s.io/apimachinery/pkg/util/wait.BackoffUntil.func1\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:155\nk8s.io/apimachinery/pkg/util/wait.BackoffUntil\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:156\nk8s.io/apimachinery/pkg/util/wait.JitterUntil\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:133\nk8s.io/apimachinery/pkg/util/wait.Until\n\t/go/pkg/mod/k8s.io/apimachinery@v0.21.3/pkg/util/wait/wait.go:90\nmetacontroller/pkg/controller/composite.(*parentController).Start.func1.1\n\t/go/src/metacontroller/pkg/controller/composite/controller.go:263"}</pre></section><section><h2>Pod: metadata-envoy-deployment-9c7db86d8-h96xq (Namespace: kubeflow)</h2><h3>Logs (Last 10 lines)</h3><pre>[2025-04-28 06:44:47.431][1][info][main] [source/server/server.cc:473]   response header map: 440 bytes: :status,access-control-allow-credentials,access-control-allow-headers,access-control-allow-methods,access-control-allow-origin,access-control-allow-private-network,access-control-expose-headers,access-control-max-age,age,cache-control,connection,content-encoding,content-length,content-type,date,etag,expires,grpc-message,grpc-status,keep-alive,last-modified,location,proxy-connection,proxy-status,server,transfer-encoding,upgrade,vary,via,x-envoy-attempt-count,x-envoy-decorator-operation,x-envoy-degraded,x-envoy-immediate-health-check-fail,x-envoy-ratelimited,x-envoy-upstream-canary,x-envoy-upstream-healthchecked-cluster,x-envoy-upstream-service-time,x-request-id</pre></section><section><h2>Pod: metadata-grpc-deployment-d94cc8676-njh69 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:15020/app-health/container/livez delay=3s timeout=2s period=5s #success=1 #failure=3
    Readiness:      http-get http://:15020/app-health/container/readyz delay=3s timeout=2s period=5s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>W0429 01:07:06.953629    11 metadata_store_service_impl.cc:239] GetContextType failed: No type found for query, name: `system.Pipeline`, version: `nullopt`
W0429 01:07:07.075496    11 metadata_store_service_impl.cc:239] GetContextType failed: No type found for query, name: `system.PipelineRun`, version: `nullopt`</pre></section><section><h2>Pod: metadata-writer-d9bc4bb89-bd6nz (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: minio-5dc6ff5b96-cf8lg (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: ml-pipeline-5846b5b56d-l8d7n (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:   exec [wget -q -S -O - http://localhost:8888/apis/v1beta1/healthz] delay=3s timeout=2s period=5s #success=1 #failure=3
    Readiness:  exec [wget -q -S -O - http://localhost:8888/apis/v1beta1/healthz] delay=3s timeout=2s period=5s #success=1 #failure=3
    Startup:    exec [wget -q -S -O - http://localhost:8888/apis/v1beta1/healthz] delay=0s timeout=2s period=5s #success=1 #failure=12
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:170
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:266
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:337
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:266
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:337
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:271
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:350
/api.ReportService/ReportWorkflowV1 call failed
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:266
	/go/src/github.com/kubeflow/pipelines/backend/src/common/util/error.go:337</pre></section><section><h2>Pod: ml-pipeline-persistenceagent-7655ddbcfb-mnjmg (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T02:08:31Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-t28kp): CustomError (code: 1): Syncing Workflow (kubeflow-cluster-report-html-t28kp): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-t28kp\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"7b9a777f-4bfc-42cc-8bd7-5b357aec648b\",\"resourceVersion\":\"8888418\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T02:08:30Z\",\"labels\":{\"pipeline/runid\":\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Using Event keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T02:08:07.475Z (d9200)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T02:08:30Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T02:08:30Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-t28kp\":{\"id\":\"kubeflow-cluster-report-html-t28kp\",\"name\":\"kubeflow-cluster-report-html-t28kp\",\"displayName\":\"kubeflow-cluster-report-html-t28kp\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-t28kp\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-t28kp-4217643333\"]},\"kubeflow-cluster-report-html-t28kp-4217643333\":{\"id\":\"kubeflow-cluster-report-html-t28kp-4217643333\",\"name\":\"kubeflow-cluster-report-html-t28kp.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-t28kp\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-t28kp\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-t28kp\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"7b9a777f-4bfc-42cc-8bd7-5b357aec648b\",\"resourceVersion\":\"8888418\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T02:08:30Z\",\"labels\":{\"pipeline/runid\":\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Using Event keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T02:08:07.475Z (d9200)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T02:08:30Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T02:08:30Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"ba5c40c2-42a6-4419-b018-faf829d8d81f\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-t28kp\":{\"id\":\"kubeflow-cluster-report-html-t28kp\",\"name\":\"kubeflow-cluster-report-html-t28kp\",\"displayName\":\"kubeflow-cluster-report-html-t28kp\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-t28kp\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-t28kp-4217643333\"]},\"kubeflow-cluster-report-html-t28kp-4217643333\":{\"id\":\"kubeflow-cluster-report-html-t28kp-4217643333\",\"name\":\"kubeflow-cluster-report-html-t28kp.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-t28kp\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-t28kp\",\"startedAt\":\"2025-05-13T02:08:30Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-t28kp\" namespace=\"kubeflow-user-example-com\" runId=\"ba5c40c2-42a6-4419-b018-faf829d8d81f\": Failed to fetch run ba5c40c2-42a6-4419-b018-faf829d8d81f: ResourceNotFoundError: Run ba5c40c2-42a6-4419-b018-faf829d8d81f not found"
time="2025-05-13T02:08:31Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-t28kp): CustomError (code: 1): Workflow (kubeflow-user-example-com/kubeflow-cluster-report-html-t28kp) in work queue no longer exists: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: Error retrieving workflow (kubeflow-cluster-report-html-t28kp) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-t28kp\" not found"
time="2025-05-13T04:12:45Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-vprhl): CustomError (code: 1): Syncing Workflow (kubeflow-cluster-report-html-vprhl): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-vprhl\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"72a68dfa-08e4-49c1-945c-5e049dff52c7\",\"resourceVersion\":\"8930247\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:12:44Z\",\"labels\":{\"pipeline/runid\":\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Using Event keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T02:08:07.475Z (d9200)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:12:44Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:12:44Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-vprhl\":{\"id\":\"kubeflow-cluster-report-html-vprhl\",\"name\":\"kubeflow-cluster-report-html-vprhl\",\"displayName\":\"kubeflow-cluster-report-html-vprhl\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-vprhl\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-vprhl-865999012\"]},\"kubeflow-cluster-report-html-vprhl-865999012\":{\"id\":\"kubeflow-cluster-report-html-vprhl-865999012\",\"name\":\"kubeflow-cluster-report-html-vprhl.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-vprhl\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-vprhl\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-vprhl\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"72a68dfa-08e4-49c1-945c-5e049dff52c7\",\"resourceVersion\":\"8930247\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:12:44Z\",\"labels\":{\"pipeline/runid\":\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Using Event keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T02:08:07.475Z (d9200)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:12:44Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:12:44Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"464e7a59-4c23-46c2-ba59-f12ec046816b\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-vprhl\":{\"id\":\"kubeflow-cluster-report-html-vprhl\",\"name\":\"kubeflow-cluster-report-html-vprhl\",\"displayName\":\"kubeflow-cluster-report-html-vprhl\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-vprhl\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-vprhl-865999012\"]},\"kubeflow-cluster-report-html-vprhl-865999012\":{\"id\":\"kubeflow-cluster-report-html-vprhl-865999012\",\"name\":\"kubeflow-cluster-report-html-vprhl.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-vprhl\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-vprhl\",\"startedAt\":\"2025-05-13T04:12:44Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-vprhl\" namespace=\"kubeflow-user-example-com\" runId=\"464e7a59-4c23-46c2-ba59-f12ec046816b\": Failed to fetch run 464e7a59-4c23-46c2-ba59-f12ec046816b: ResourceNotFoundError: Run 464e7a59-4c23-46c2-ba59-f12ec046816b not found"
time="2025-05-13T04:12:45Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-vprhl): CustomError (code: 1): Workflow (kubeflow-user-example-com/kubeflow-cluster-report-html-vprhl) in work queue no longer exists: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: Error retrieving workflow (kubeflow-cluster-report-html-vprhl) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-vprhl\" not found"
time="2025-05-13T04:41:35Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-btd68): CustomError (code: 1): Syncing Workflow (kubeflow-cluster-report-html-btd68): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-btd68\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"27d6b6f6-4d9c-4d07-8be2-5460cf645b31\",\"resourceVersion\":\"8939975\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:41:34Z\",\"labels\":{\"pipeline/runid\":\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:41:18.708Z (477f9)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:41:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:41:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-btd68\":{\"id\":\"kubeflow-cluster-report-html-btd68\",\"name\":\"kubeflow-cluster-report-html-btd68\",\"displayName\":\"kubeflow-cluster-report-html-btd68\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-btd68\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-btd68-3155183040\"]},\"kubeflow-cluster-report-html-btd68-3155183040\":{\"id\":\"kubeflow-cluster-report-html-btd68-3155183040\",\"name\":\"kubeflow-cluster-report-html-btd68.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-btd68\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-btd68\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-btd68\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"27d6b6f6-4d9c-4d07-8be2-5460cf645b31\",\"resourceVersion\":\"8939975\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:41:34Z\",\"labels\":{\"pipeline/runid\":\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:41:18.708Z (477f9)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:41:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:41:34Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-btd68\":{\"id\":\"kubeflow-cluster-report-html-btd68\",\"name\":\"kubeflow-cluster-report-html-btd68\",\"displayName\":\"kubeflow-cluster-report-html-btd68\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-btd68\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-btd68-3155183040\"]},\"kubeflow-cluster-report-html-btd68-3155183040\":{\"id\":\"kubeflow-cluster-report-html-btd68-3155183040\",\"name\":\"kubeflow-cluster-report-html-btd68.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-btd68\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-btd68\",\"startedAt\":\"2025-05-13T04:41:34Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-btd68\" namespace=\"kubeflow-user-example-com\" runId=\"a293bc0a-af35-4fcd-a2b0-b5205072bea0\": Failed to fetch run a293bc0a-af35-4fcd-a2b0-b5205072bea0: ResourceNotFoundError: Run a293bc0a-af35-4fcd-a2b0-b5205072bea0 not found"
time="2025-05-13T04:41:35Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-btd68): CustomError (code: 1): Workflow (kubeflow-user-example-com/kubeflow-cluster-report-html-btd68) in work queue no longer exists: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: Error retrieving workflow (kubeflow-cluster-report-html-btd68) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-btd68\" not found"
time="2025-05-13T04:46:14Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-kd6xq): CustomError (code: 1): Syncing Workflow (kubeflow-cluster-report-html-kd6xq): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-kd6xq\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"9b130534-ebfc-4339-88bf-fcad105e996f\",\"resourceVersion\":\"8941562\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:46:13Z\",\"labels\":{\"pipeline/runid\":\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:41:18.708Z (477f9)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:46:13Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:46:13Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-kd6xq\":{\"id\":\"kubeflow-cluster-report-html-kd6xq\",\"name\":\"kubeflow-cluster-report-html-kd6xq\",\"displayName\":\"kubeflow-cluster-report-html-kd6xq\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-kd6xq\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-kd6xq-1485270372\"]},\"kubeflow-cluster-report-html-kd6xq-1485270372\":{\"id\":\"kubeflow-cluster-report-html-kd6xq-1485270372\",\"name\":\"kubeflow-cluster-report-html-kd6xq.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-kd6xq\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-kd6xq\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-kd6xq\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"9b130534-ebfc-4339-88bf-fcad105e996f\",\"resourceVersion\":\"8941562\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:46:13Z\",\"labels\":{\"pipeline/runid\":\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,fail,error\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash,fail,error\\\\\\\", event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Error\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:41:18.708Z (477f9)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:46:13Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:46:13Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-kd6xq\":{\"id\":\"kubeflow-cluster-report-html-kd6xq\",\"name\":\"kubeflow-cluster-report-html-kd6xq\",\"displayName\":\"kubeflow-cluster-report-html-kd6xq\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-kd6xq\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-kd6xq-1485270372\"]},\"kubeflow-cluster-report-html-kd6xq-1485270372\":{\"id\":\"kubeflow-cluster-report-html-kd6xq-1485270372\",\"name\":\"kubeflow-cluster-report-html-kd6xq.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-kd6xq\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-kd6xq\",\"startedAt\":\"2025-05-13T04:46:13Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"CrashLoopBackOff,Failed,Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash,error,fail\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-kd6xq\" namespace=\"kubeflow-user-example-com\" runId=\"eae4d21d-4304-4cee-815c-dd7e9dbc1514\": Failed to fetch run eae4d21d-4304-4cee-815c-dd7e9dbc1514: ResourceNotFoundError: Run eae4d21d-4304-4cee-815c-dd7e9dbc1514 not found"
time="2025-05-13T04:46:14Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-kd6xq): CustomError (code: 1): Workflow (kubeflow-user-example-com/kubeflow-cluster-report-html-kd6xq) in work queue no longer exists: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: Error retrieving workflow (kubeflow-cluster-report-html-kd6xq) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-kd6xq\" not found"
time="2025-05-13T04:50:21Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-tmfr9): CustomError (code: 1): Syncing Workflow (kubeflow-cluster-report-html-tmfr9): permanent failure: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-tmfr9\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"8ad44c22-f7f7-4942-bbdf-fe7223b13247\",\"resourceVersion\":\"8942982\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:50:20Z\",\"labels\":{\"pipeline/runid\":\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash\\\\\\\", event_keywords: str = \\\\\\\"Unhealthy\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:50:06.614Z (3ebf6)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:50:20Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:50:20Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-tmfr9\":{\"id\":\"kubeflow-cluster-report-html-tmfr9\",\"name\":\"kubeflow-cluster-report-html-tmfr9\",\"displayName\":\"kubeflow-cluster-report-html-tmfr9\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-tmfr9\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-tmfr9-3698067426\"]},\"kubeflow-cluster-report-html-tmfr9-3698067426\":{\"id\":\"kubeflow-cluster-report-html-tmfr9-3698067426\",\"name\":\"kubeflow-cluster-report-html-tmfr9.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-tmfr9\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-tmfr9\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found: CustomError (code: 1): Error while reporting workflow resource (code: NotFound, message: Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found): rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found, {\"metadata\":{\"name\":\"kubeflow-cluster-report-html-tmfr9\",\"generateName\":\"kubeflow-cluster-report-html-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"8ad44c22-f7f7-4942-bbdf-fe7223b13247\",\"resourceVersion\":\"8942982\",\"generation\":2,\"creationTimestamp\":\"2025-05-13T04:50:20Z\",\"labels\":{\"pipeline/runid\":\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset], log_keywords: str = \\\\\\\"crash\\\\\\\", event_keywords: str = \\\\\\\"Unhealthy\\\\\\\"):\\\\n    import shutil\\\\n    import subprocess\\\\n    import os\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n\\\\n    keyword_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_keyword_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    # 디버그 출력\\\\n    print(\\\\\\\"Log Keywords:\\\\\\\", keyword_list)\\\\n    print(\\\\\\\"Event Keywords:\\\\\\\", event_keyword_list)\\\\n\\\\n\\\\n    # 디버깅: 키워드 확인\\\\n    print(\\\\\\\"Using keywords:\\\\\\\", keyword_list)\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        # HTML 시작\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; }}\\\\n                h3 {{ color: #2d3436; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e입력된 키워드: \\\\u003ccode\\\\u003e{}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003c/section\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(\\\\\\\", \\\\\\\".join(keyword_list)))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            # 상태 정보\\\\n            pod_status = subprocess.getoutput(f\\\\\\\"kubectl get pod {pod_name} -n {namespace} -o jsonpath='{{.status.phase}}'\\\\\\\")\\\\n            if pod_status.lower() not in [\\\\\\\"running\\\\\\\", \\\\\\\"succeeded\\\\\\\"]:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e⚠️ 문제 상태 Pod: \\\\u003ccode\\\\u003e{pod_name}\\\\u003c/code\\\\u003e (Namespace: \\\\u003ccode\\\\u003e{namespace}\\\\u003c/code\\\\u003e)\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"\\\\u003ch3\\\\u003eStatus: \\\\u003ccode\\\\u003e{pod_status}\\\\u003c/code\\\\u003e\\\\u003c/h3\\\\u003e\\\\\\\")\\\\n\\\\n                describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n                logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n                matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l.lower() for k in keyword_list)])\\\\n                matched_logs_lines = [l for l in logs.splitlines() if any(k in l.lower() for k in keyword_list)]\\\\n                matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_lines[-10:])  # 마지막 10줄\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_describe}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{matched_logs}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            # 이벤트 확인 (namespace별 1회)\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l.lower() for k in event_keyword_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        # 네임스페이스 이벤트 정리\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003e📋 Namespace 이벤트: \\\\u003ccode\\\\u003e{ns}\\\\u003c/code\\\\u003e\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{events}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        # HTML 종료\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-13T04:50:06.614Z (3ebf6)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:50:20Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-13T04:50:20Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"kubeflow-cluster-report-html\",\"--run_id\",\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"296e1450-f20b-4ffc-b682-466f23a8cc83\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"kubeflow-cluster-report-html-tmfr9\":{\"id\":\"kubeflow-cluster-report-html-tmfr9\",\"name\":\"kubeflow-cluster-report-html-tmfr9\",\"displayName\":\"kubeflow-cluster-report-html-tmfr9\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/kubeflow-cluster-report-html-tmfr9\",\"phase\":\"Running\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"kubeflow-cluster-report-html-tmfr9-3698067426\"]},\"kubeflow-cluster-report-html-tmfr9-3698067426\":{\"id\":\"kubeflow-cluster-report-html-tmfr9-3698067426\",\"name\":\"kubeflow-cluster-report-html-tmfr9.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/kubeflow-cluster-report-html-tmfr9\",\"phase\":\"Pending\",\"boundaryID\":\"kubeflow-cluster-report-html-tmfr9\",\"startedAt\":\"2025-05-13T04:50:20Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{\\\"enableCache\\\":true},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"Unhealthy\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"Unhealthy\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"crash\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = NotFound desc = Failed to report workflow: Failed to report workflow name=\"kubeflow-cluster-report-html-tmfr9\" namespace=\"kubeflow-user-example-com\" runId=\"296e1450-f20b-4ffc-b682-466f23a8cc83\": Failed to fetch run 296e1450-f20b-4ffc-b682-466f23a8cc83: ResourceNotFoundError: Run 296e1450-f20b-4ffc-b682-466f23a8cc83 not found"
time="2025-05-13T04:50:21Z" level=error msg="Permanent failure while syncing resource (kubeflow-user-example-com/kubeflow-cluster-report-html-tmfr9): CustomError (code: 1): Workflow (kubeflow-user-example-com/kubeflow-cluster-report-html-tmfr9) in work queue no longer exists: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: CustomError (code: 2): Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: Error retrieving workflow (kubeflow-cluster-report-html-tmfr9) in namespace (kubeflow-user-example-com): workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found: workflow.argoproj.io \"kubeflow-cluster-report-html-tmfr9\" not found"</pre></section><section><h2>Pod: ml-pipeline-scheduledworkflow-658b675548-8pcf8 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>W0428 06:44:49.070450       1 reflector.go:424] pkg/mod/k8s.io/client-go@v0.25.9/tools/cache/reflector.go:169: failed to list *v1beta1.ScheduledWorkflow: Get "https://10.96.0.1:443/apis/kubeflow.org/v1beta1/scheduledworkflows?limit=500&resourceVersion=0": dial tcp 10.96.0.1:443: connect: connection refused
E0428 06:44:49.070569       1 reflector.go:140] pkg/mod/k8s.io/client-go@v0.25.9/tools/cache/reflector.go:169: Failed to watch *v1beta1.ScheduledWorkflow: failed to list *v1beta1.ScheduledWorkflow: Get "https://10.96.0.1:443/apis/kubeflow.org/v1beta1/scheduledworkflows?limit=500&resourceVersion=0": dial tcp 10.96.0.1:443: connect: connection refused
W0428 06:44:49.070653       1 reflector.go:424] pkg/mod/k8s.io/client-go@v0.25.9/tools/cache/reflector.go:169: failed to list *v1alpha1.Workflow: Get "https://10.96.0.1:443/apis/argoproj.io/v1alpha1/workflows?limit=500&resourceVersion=0": dial tcp 10.96.0.1:443: connect: connection refused
E0428 06:44:49.070755       1 reflector.go:140] pkg/mod/k8s.io/client-go@v0.25.9/tools/cache/reflector.go:169: Failed to watch *v1alpha1.Workflow: failed to list *v1alpha1.Workflow: Get "https://10.96.0.1:443/apis/argoproj.io/v1alpha1/workflows?limit=500&resourceVersion=0": dial tcp 10.96.0.1:443: connect: connection refused</pre></section><section><h2>Pod: ml-pipeline-ui-5c66bf88b5-fdzr2 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:   exec [wget -q -S -O - http://localhost:3000/apis/v1beta1/healthz] delay=3s timeout=2s period=5s #success=1 #failure=3
    Readiness:  exec [wget -q -S -O - http://localhost:3000/apis/v1beta1/healthz] delay=3s timeout=2s period=5s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>(node:1) UnhandledPromiseRejectionWarning: FetchError: request to http://metadata/computeMetadata/v1/project/project-id failed, reason: getaddrinfo ENOTFOUND metadata
(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 37)
(node:1) UnhandledPromiseRejectionWarning: FetchError: request to http://metadata/computeMetadata/v1/instance/attributes/cluster-name failed, reason: getaddrinfo ENOTFOUND metadata
(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 38)
(node:1) UnhandledPromiseRejectionWarning: FetchError: request to http://metadata/computeMetadata/v1/project/project-id failed, reason: getaddrinfo ENOTFOUND metadata
(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 39)
(node:1) UnhandledPromiseRejectionWarning: FetchError: request to http://metadata/computeMetadata/v1/project/project-id failed, reason: getaddrinfo ENOTFOUND metadata
(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 40)
(node:1) UnhandledPromiseRejectionWarning: FetchError: request to http://metadata/computeMetadata/v1/instance/attributes/cluster-name failed, reason: getaddrinfo ENOTFOUND metadata
(node:1) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 41)</pre></section><section><h2>Pod: ml-pipeline-viewer-crd-c7b78c8c-bldlh (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: ml-pipeline-visualizationserver-7c678699d-xz9dk (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:     exec [wget -q -S -O - http://localhost:8888/] delay=3s timeout=2s period=5s #success=1 #failure=3
    Readiness:    exec [wget -q -S -O - http://localhost:8888/] delay=3s timeout=2s period=5s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: mysql-5b446b5744-jlr4m (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: notebook-controller-deployment-5458bf988b-dh2kj (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:15020/app-health/manager/livez delay=5s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:15020/app-health/manager/readyz delay=5s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: profiles-deployment-79f5cf977d-6jvns (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:15020/app-health/kfam/livez delay=30s timeout=1s period=30s #success=1 #failure=3
    Liveness:       http-get http://:15020/app-health/manager/livez delay=15s timeout=1s period=20s #success=1 #failure=3
    Readiness:      http-get http://:15020/app-health/manager/readyz delay=5s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: pvcviewer-controller-manager-5b8c866b58-qz2hj (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:     http-get http://:15020/app-health/manager/livez delay=15s timeout=1s period=20s #success=1 #failure=3
    Readiness:    http-get http://:15020/app-health/manager/readyz delay=5s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>E0428 06:49:44.163936       1 leaderelection.go:332] error retrieving resource lock kubeflow/57a72bdf.kubeflow.org: Get "https://10.96.0.1:443/apis/coordination.k8s.io/v1/namespaces/kubeflow/leases/57a72bdf.kubeflow.org": dial tcp 10.96.0.1:443: connect: connection refused</pre></section><section><h2>Pod: tensorboard-controller-deployment-78f5598f4b-wrbqb (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:   http-get http://:15020/app-health/manager/livez delay=15s timeout=1s period=20s #success=1 #failure=3
    Readiness:  http-get http://:15020/app-health/manager/readyz delay=5s timeout=1s period=10s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: tensorboards-web-app-deployment-568fc5687-2pdk5 (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: training-operator-7b99976c6-c2dfm (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:8081/healthz delay=15s timeout=3s period=20s #success=1 #failure=3
    Readiness:      http-get http://:8081/readyz delay=10s timeout=3s period=15s #success=1 #failure=3</pre><h3>Logs (Last 10 lines)</h3><pre>2025-04-28T06:51:00Z	ERROR	cert-rotation	could not refresh CA and server certs	{"error": "Operation cannot be fulfilled on secrets \"training-operator-webhook-cert\": the object has been modified; please apply your changes to the latest version and try again"}
2025-04-28T06:51:00Z	ERROR	cert-rotation	secret is not well-formed, cannot update webhook configurations	{"error": "Cert secret is not well-formed, missing ca.crt", "errorVerbose": "Cert secret is not well-formed, missing ca.crt\ngithub.com/open-policy-agent/cert-controller/pkg/rotator.buildArtifactsFromSecret\n\t/go/pkg/mod/github.com/open-policy-agent/cert-controller@v0.10.1/pkg/rotator/rotator.go:501\ngithub.com/open-policy-agent/cert-controller/pkg/rotator.(*ReconcileWH).Reconcile\n\t/go/pkg/mod/github.com/open-policy-agent/cert-controller@v0.10.1/pkg/rotator/rotator.go:778\nsigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Reconcile\n\t/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.17.2/pkg/internal/controller/controller.go:119\nsigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).reconcileHandler\n\t/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.17.2/pkg/internal/controller/controller.go:316\nsigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).processNextWorkItem\n\t/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.17.2/pkg/internal/controller/controller.go:266\nsigs.k8s.io/controller-runtime/pkg/internal/controller.(*Controller).Start.func2.2\n\t/go/pkg/mod/sigs.k8s.io/controller-runtime@v0.17.2/pkg/internal/controller/controller.go:227\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1695"}</pre></section><section><h2>Pod: volumes-web-app-deployment-6b9bd6bb8f-nf6fj (Namespace: kubeflow)</h2><h3>Describe</h3><pre>      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre></section><section><h2>Pod: workflow-controller-68d76bcb8b-d4nps (Namespace: kubeflow)</h2><h3>Describe</h3><pre>    Liveness:  http-get http://:15020/app-health/workflow-controller/livez delay=90s timeout=30s period=60s #success=1 #failure=3
      --proxyComponentLogLevel=misc:error
    Readiness:  http-get http://:15021/healthz/ready delay=0s timeout=3s period=15s #success=1 #failure=4
    Startup:    http-get http://:15021/healthz/ready delay=0s timeout=3s period=1s #success=1 #failure=600</pre><h3>Logs (Last 10 lines)</h3><pre>time="2025-05-13T01:30:04.562Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T01:31:58.847Z" level=info msg="Pod failed: Error (exit code 1)" displayName=executor namespace=kubeflow-user-example-com pod=pod-log-to-github-49hjk-system-container-impl-2852792872 templateName=system-container-impl workflow=pod-log-to-github-49hjk
time="2025-05-13T01:33:02.090Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T02:08:24.461Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T02:08:30.949Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T04:12:44.918Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T04:41:34.536Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T04:46:13.513Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T04:50:20.421Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"
time="2025-05-13T04:58:32.917Z" level=warning msg="Non-transient error: configmaps \"artifact-repositories\" not found"</pre></section><section><h2>Pod: local-path-provisioner-6548cc785f-xnkv4 (Namespace: local-path-storage)</h2><h3>Logs (Last 10 lines)</h3><pre>E0513 04:34:27.886241       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:39:22.007292       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:39:31.450681       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:39:44.888423       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:44:40.009847       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:44:47.890200       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:49:02.452551       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:52:38.892478       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:54:25.012227       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory
E0513 04:57:43.454774       1 token_source.go:185] Unable to rotate token: failed to read token file "/var/run/secrets/kubernetes.io/serviceaccount/token": open /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory</pre></section><section><h2>Pod: oauth2-proxy-59bd7c7db6-4hsw2 (Namespace: oauth2-proxy)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:http/ping delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:http/ping delay=0s timeout=1s period=10s #success=1 #failure=3</pre></section><section><h2>Pod: oauth2-proxy-59bd7c7db6-gfwh5 (Namespace: oauth2-proxy)</h2><h3>Describe</h3><pre>    Liveness:       http-get http://:http/ping delay=0s timeout=1s period=10s #success=1 #failure=3
    Readiness:      http-get http://:http/ping delay=0s timeout=1s period=10s #success=1 #failure=3</pre></section><section><h3>Events in Namespace: istio-system</h3><pre>5m          Warning   FailedGetResourceMetric   horizontalpodautoscaler/cluster-local-gateway       failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)
44s         Warning   FailedGetResourceMetric   horizontalpodautoscaler/istio-ingressgateway        failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)
44s         Warning   FailedGetResourceMetric   horizontalpodautoscaler/istiod                      failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)</pre></section><section><h3>Events in Namespace: knative-serving</h3><pre>1s          Warning   FailedGetResourceMetric   horizontalpodautoscaler/activator   failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)
1s          Warning   FailedGetResourceMetric   horizontalpodautoscaler/webhook     failed to get cpu utilization: unable to get metrics for resource cpu: unable to fetch metrics from resource metrics API: the server could not find the requested resource (get pods.metrics.k8s.io)</pre></section></body></html>