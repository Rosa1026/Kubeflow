
        <html>
        <head>
            <meta charset="UTF-8">
            <style>
                body { font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }
                h1 { color: #2c3e50; }
                h2 { color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
                h3 { color: #2980b9; }
                pre { background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }
                section { margin-bottom: 30px; }
                .keyword { color: red; font-weight: bold; }
            </style>
        </head>
        <body>
        <h1>Kubernetes 장애 점검 리포트</h1>
        <section><h2>Pod: etcd-k8s-kubeflow-master01 (Namespace: kube-system) - 감지된 키워드: deadline exceeded</h2>
<h3>Log 결과 (최근 10줄)</h3><pre>{"level":"warn","ts":"2025-04-25T06:04:16.458245Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.002736949s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:09:16.452199Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.007711416s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:14:16.445792Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.000352598s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:24:17.342252Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"2.000196896s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
{"level":"warn","ts":"2025-04-25T06:24:17.444017Z","caller":"etcdserver/util.go:170","msg":"apply request took too long","took":"1.999925858s","expected-duration":"100ms","prefix":"read-only range ","request":"key:\"/registry/health\" ","response":"","error":"context <span class='keyword'>deadline exceeded</span>"}
</pre>
</section>
<section><h2>Pod: ml-pipeline-persistenceagent-7655ddbcfb-mnjmg (Namespace: kubeflow) - 감지된 키워드: evicted, deadline exceeded, failed to start, oomkilled, crashloopbackoff, node not ready</h2>
<h3>Log 결과 (최근 10줄)</h3><pre>time="2025-05-14T00:37:56Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-fk9fm): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-fk9fm): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345350\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:51Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345350\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:51Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:38:04Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-fk9fm): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-fk9fm): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345426\",\"generation\":3,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:38:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-4150106503\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-4150106503\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"241\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}},\"pod-log-pipeline-advance-version-fk9fm-477768174\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"241\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-4150106503\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":\"2025-05-14T00:37:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"241\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-dag-driver-661576027/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-477768174\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345426\",\"generation\":3,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:38:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-4150106503\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-4150106503\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"241\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}},\"pod-log-pipeline-advance-version-fk9fm-477768174\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"241\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-4150106503\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":\"2025-05-14T00:37:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"241\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-dag-driver-661576027/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-477768174\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:38:14Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-5nw44): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-5nw44): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-5nw44\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"f589cec9-5545-41fe-87ab-a38e6790cb33\",\"resourceVersion\":\"9341090\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:23:41Z\",\"labels\":{\"pipeline/runid\":\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:23:41Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:25:59Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-5nw44\":{\"id\":\"pod-log-pipeline-advance-version-5nw44\",\"name\":\"pod-log-pipeline-advance-version-5nw44\",\"displayName\":\"pod-log-pipeline-advance-version-5nw44\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":175,\"memory\":172},\"children\":[\"pod-log-pipeline-advance-version-5nw44-92227836\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-2312877464\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2312877464\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:25:33Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":26,\"memory\":26},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-2407325076\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2407325076\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:23:51Z\",\"finishedAt\":\"2025-05-14T00:23:55Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"232\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-driver-2407325076/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-298533763\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-2856536475\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44\",\"startedAt\":\"2025-05-14T00:23:51Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":171,\"memory\":169},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"232\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2407325076\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-298533763\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-298533763\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:24:01Z\",\"finishedAt\":\"2025-05-14T00:25:23Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":167,\"memory\":166},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-4123328826\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-4123328826\"]},\"pod-log-pipeline-advance-version-5nw44-4123328826\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-4123328826\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-298533763\",\"startedAt\":\"2025-05-14T00:24:01Z\",\"finishedAt\":\"2025-05-14T00:25:13Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":138,\"memory\":138},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-impl-4123328826/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-840634021\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-840634021\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-840634021\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:25:23Z\",\"finishedAt\":\"2025-05-14T00:25:27Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"232\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-driver-840634021/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2312877464\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-911930307\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-911930307\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2312877464\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T00:25:33Z\",\"finishedAt\":\"2025-05-14T00:25:49Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":26,\"memory\":26},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-impl-911930307/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-92227836\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-92227836\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:23:45Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"232\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-dag-driver-92227836/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2856536475\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":175,\"memory\":172},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-5nw44\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"f589cec9-5545-41fe-87ab-a38e6790cb33\",\"resourceVersion\":\"9341090\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:23:41Z\",\"labels\":{\"pipeline/runid\":\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:23:41Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:25:59Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"2c4a0994-92f0-4682-9289-dda2e308be96\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-5nw44\":{\"id\":\"pod-log-pipeline-advance-version-5nw44\",\"name\":\"pod-log-pipeline-advance-version-5nw44\",\"displayName\":\"pod-log-pipeline-advance-version-5nw44\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":175,\"memory\":172},\"children\":[\"pod-log-pipeline-advance-version-5nw44-92227836\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-2312877464\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2312877464\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:25:33Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":26,\"memory\":26},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-2407325076\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2407325076\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:23:51Z\",\"finishedAt\":\"2025-05-14T00:23:55Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"232\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-driver-2407325076/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-298533763\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-2856536475\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44\",\"startedAt\":\"2025-05-14T00:23:51Z\",\"finishedAt\":\"2025-05-14T00:25:59Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":171,\"memory\":169},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"232\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2407325076\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-911930307\"]},\"pod-log-pipeline-advance-version-5nw44-298533763\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-298533763\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:24:01Z\",\"finishedAt\":\"2025-05-14T00:25:23Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":167,\"memory\":166},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-5nw44-4123328826\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-5nw44-4123328826\"]},\"pod-log-pipeline-advance-version-5nw44-4123328826\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-4123328826\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-298533763\",\"startedAt\":\"2025-05-14T00:24:01Z\",\"finishedAt\":\"2025-05-14T00:25:13Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":138,\"memory\":138},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"233\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-impl-4123328826/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-840634021\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-840634021\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-840634021\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2856536475\",\"startedAt\":\"2025-05-14T00:25:23Z\",\"finishedAt\":\"2025-05-14T00:25:27Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"232\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-driver-840634021/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2312877464\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-911930307\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-911930307\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44-2312877464\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T00:25:33Z\",\"finishedAt\":\"2025-05-14T00:25:49Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":26,\"memory\":26},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"2c4a0994-92f0-4682-9289-dda2e308be96\\\",\\\"--execution_id\\\",\\\"234\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"45\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/2c4a0994-92f0-4682-9289-dda2e308be96/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-container-impl-911930307/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-5nw44-92227836\":{\"id\":\"pod-log-pipeline-advance-version-5nw44-92227836\",\"name\":\"pod-log-pipeline-advance-version-5nw44.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-5nw44\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-5nw44\",\"startedAt\":\"2025-05-14T00:23:41Z\",\"finishedAt\":\"2025-05-14T00:23:45Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"232\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-5nw44/2025/05/14/pod-log-pipeline-advance-version-5nw44-system-dag-driver-92227836/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-5nw44-2856536475\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":175,\"memory\":172},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:38:36Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-fk9fm): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-fk9fm): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345582\",\"generation\":5,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:38:21Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-1002294818\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-1002294818\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-1220569705\"]},\"pod-log-pipeline-advance-version-fk9fm-1220569705\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-1220569705\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-1002294818\",\"startedAt\":\"2025-05-14T00:38:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-fk9fm-4150106503\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-4150106503\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":\"2025-05-14T00:38:04Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"241\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-container-driver-4150106503/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-1002294818\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-fk9fm-477768174\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"241\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-4150106503\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":\"2025-05-14T00:37:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"241\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-dag-driver-661576027/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-477768174\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":6,\"memory\":4},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"e7ef528f-ac75-4f3b-bcd1-1d3c939a4591\",\"resourceVersion\":\"9345582\",\"generation\":5,\"creationTimestamp\":\"2025-05-14T00:37:50Z\",\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:37:50Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:38:21Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"nodes\":{\"pod-log-pipeline-advance-version-fk9fm\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm\",\"name\":\"pod-log-pipeline-advance-version-fk9fm\",\"displayName\":\"pod-log-pipeline-advance-version-fk9fm\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"children\":[\"pod-log-pipeline-advance-version-fk9fm-661576027\"]},\"pod-log-pipeline-advance-version-fk9fm-1002294818\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-1002294818\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-1220569705\"]},\"pod-log-pipeline-advance-version-fk9fm-1220569705\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-1220569705\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-1002294818\",\"startedAt\":\"2025-05-14T00:38:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-fk9fm-4150106503\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-4150106503\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":\"2025-05-14T00:38:04Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"241\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"aba0f724-02d7-4e69-be02-d1c6eb4edbef\\\",\\\"--execution_id\\\",\\\"242\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/aba0f724-02d7-4e69-be02-d1c6eb4edbef/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-container-driver-4150106503/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-1002294818\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-fk9fm-477768174\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-477768174\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:38:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"241\"}]},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-4150106503\"]},\"pod-log-pipeline-advance-version-fk9fm-661576027\":{\"id\":\"pod-log-pipeline-advance-version-fk9fm-661576027\",\"name\":\"pod-log-pipeline-advance-version-fk9fm.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-fk9fm\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-fk9fm\",\"startedAt\":\"2025-05-14T00:37:51Z\",\"finishedAt\":\"2025-05-14T00:37:54Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"241\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-fk9fm/2025/05/14/pod-log-pipeline-advance-version-fk9fm-system-dag-driver-661576027/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-fk9fm-477768174\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":6,\"memory\":4},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:38:42Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-r84g4): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-r84g4): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-r84g4\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"ca7c0d8d-aa00-4f03-8ed2-a8ddc7cc8385\",\"resourceVersion\":\"9339878\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:19:57Z\",\"labels\":{\"pipeline/runid\":\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:19:57Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:22:49Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-r84g4\":{\"id\":\"pod-log-pipeline-advance-version-r84g4\",\"name\":\"pod-log-pipeline-advance-version-r84g4\",\"displayName\":\"pod-log-pipeline-advance-version-r84g4\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":246,\"memory\":243},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2332657773\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-1438550108\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1438550108\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-2308723081\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T00:22:24Z\",\"finishedAt\":\"2025-05-14T00:22:39Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-impl-1438550108/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-1580615280\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4\",\"startedAt\":\"2025-05-14T00:20:07Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":241,\"memory\":239},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"229\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-3520029909\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-1731727560\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1731727560\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:20:17Z\",\"finishedAt\":\"2025-05-14T00:22:14Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":236,\"memory\":235},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2405826195\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-2405826195\"]},\"pod-log-pipeline-advance-version-r84g4-2308723081\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2308723081\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:22:24Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-2332657773\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2332657773\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:20:00Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"229\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-dag-driver-2332657773/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1580615280\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-2405826195\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2405826195\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1731727560\",\"startedAt\":\"2025-05-14T00:20:17Z\",\"finishedAt\":\"2025-05-14T00:22:04Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":208,\"memory\":208},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-impl-2405826195/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-3350171954\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-3350171954\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-3350171954\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:22:14Z\",\"finishedAt\":\"2025-05-14T00:22:18Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"229\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-driver-3350171954/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2308723081\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-3520029909\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-3520029909\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:20:07Z\",\"finishedAt\":\"2025-05-14T00:20:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"229\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-driver-3520029909/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1731727560\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":246,\"memory\":243},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-r84g4\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"ca7c0d8d-aa00-4f03-8ed2-a8ddc7cc8385\",\"resourceVersion\":\"9339878\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:19:57Z\",\"labels\":{\"pipeline/runid\":\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Failed\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:19:57Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:22:49Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"4/5\",\"nodes\":{\"pod-log-pipeline-advance-version-r84g4\":{\"id\":\"pod-log-pipeline-advance-version-r84g4\",\"name\":\"pod-log-pipeline-advance-version-r84g4\",\"displayName\":\"pod-log-pipeline-advance-version-r84g4\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"4/5\",\"resourcesDuration\":{\"cpu\":246,\"memory\":243},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2332657773\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-1438550108\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1438550108\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-2308723081\",\"message\":\"Error (exit code 1)\",\"startedAt\":\"2025-05-14T00:22:24Z\",\"finishedAt\":\"2025-05-14T00:22:39Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-impl-1438550108/main.log\"}}],\"exitCode\":\"1\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-1580615280\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4\",\"startedAt\":\"2025-05-14T00:20:07Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"3/4\",\"resourcesDuration\":{\"cpu\":241,\"memory\":239},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"229\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-3520029909\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-1731727560\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-1731727560\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:20:17Z\",\"finishedAt\":\"2025-05-14T00:22:14Z\",\"progress\":\"2/3\",\"resourcesDuration\":{\"cpu\":236,\"memory\":235},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2405826195\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-2405826195\"]},\"pod-log-pipeline-advance-version-r84g4-2308723081\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2308723081\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Failed\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:22:24Z\",\"finishedAt\":\"2025-05-14T00:22:49Z\",\"progress\":\"0/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-r84g4-1438550108\"]},\"pod-log-pipeline-advance-version-r84g4-2332657773\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2332657773\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4\",\"startedAt\":\"2025-05-14T00:19:57Z\",\"finishedAt\":\"2025-05-14T00:20:00Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"229\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-dag-driver-2332657773/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1580615280\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-2405826195\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-2405826195\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1731727560\",\"startedAt\":\"2025-05-14T00:20:17Z\",\"finishedAt\":\"2025-05-14T00:22:04Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":208,\"memory\":208},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-impl-2405826195/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-3350171954\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-3350171954\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-3350171954\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:22:14Z\",\"finishedAt\":\"2025-05-14T00:22:18Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"229\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"231\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"44\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-driver-3350171954/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-2308723081\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-r84g4-3520029909\":{\"id\":\"pod-log-pipeline-advance-version-r84g4-3520029909\",\"name\":\"pod-log-pipeline-advance-version-r84g4.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-r84g4\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-r84g4-1580615280\",\"startedAt\":\"2025-05-14T00:20:07Z\",\"finishedAt\":\"2025-05-14T00:20:11Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"229\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"cf5cfd83-7f07-4398-9bc4-7e2b52d92a24\\\",\\\"--execution_id\\\",\\\"230\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/cf5cfd83-7f07-4398-9bc4-7e2b52d92a24/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-r84g4/2025/05/14/pod-log-pipeline-advance-version-r84g4-system-container-driver-3520029909/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-r84g4-1731727560\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":246,\"memory\":243},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:40:02Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-74xtx): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-74xtx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346218\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346218\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:40:06Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-74xtx): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-74xtx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346218\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346218\",\"generation\":2,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]}}},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:40:14Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-74xtx): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-74xtx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346314\",\"generation\":3,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:11Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":\"2025-05-14T00:40:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"244\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-dag-driver-2659084121/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-308162292\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-308162292\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"244\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-742130297\"]},\"pod-log-pipeline-advance-version-74xtx-742130297\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-742130297\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"244\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346314\",\"generation\":3,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:11Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":\"2025-05-14T00:40:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"244\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-dag-driver-2659084121/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-308162292\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-308162292\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"244\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-742130297\"]},\"pod-log-pipeline-advance-version-74xtx-742130297\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-742130297\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Pending\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"244\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]}}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"}],\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:40:44Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-xr85j): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-xr85j): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-xr85j\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"8af6b44a-3a5d-40d2-bcfa-91ed64bd59f0\",\"resourceVersion\":\"9342048\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:26:11Z\",\"labels\":{\"pipeline/runid\":\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Succeeded\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:26:11Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:28:27Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"5/5\",\"nodes\":{\"pod-log-pipeline-advance-version-xr85j\":{\"id\":\"pod-log-pipeline-advance-version-xr85j\",\"name\":\"pod-log-pipeline-advance-version-xr85j\",\"displayName\":\"pod-log-pipeline-advance-version-xr85j\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"5/5\",\"resourcesDuration\":{\"cpu\":172,\"memory\":169},\"children\":[\"pod-log-pipeline-advance-version-xr85j-4218789953\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-1074076446\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-1074076446\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:27:52Z\",\"finishedAt\":\"2025-05-14T00:27:56Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"235\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-driver-1074076446/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-3383435085\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-1664075631\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-1664075631\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-2740386764\",\"startedAt\":\"2025-05-14T00:26:31Z\",\"finishedAt\":\"2025-05-14T00:27:43Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":138,\"memory\":138},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-impl-1664075631/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-1074076446\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-2740386764\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-2740386764\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:26:31Z\",\"finishedAt\":\"2025-05-14T00:27:52Z\",\"progress\":\"3/3\",\"resourcesDuration\":{\"cpu\":165,\"memory\":164},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-1664075631\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-1664075631\"]},\"pod-log-pipeline-advance-version-xr85j-319900280\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-319900280\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3383435085\",\"startedAt\":\"2025-05-14T00:28:03Z\",\"finishedAt\":\"2025-05-14T00:28:18Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-impl-319900280/main.log\"}}],\"exitCode\":\"0\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-3383435085\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-3383435085\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:28:03Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-3485488908\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j\",\"startedAt\":\"2025-05-14T00:26:21Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"4/4\",\"resourcesDuration\":{\"cpu\":169,\"memory\":167},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"235\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-649163649\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-4218789953\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-4218789953\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:26:14Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"235\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-dag-driver-4218789953/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-3485488908\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-649163649\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-649163649\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:26:21Z\",\"finishedAt\":\"2025-05-14T00:26:24Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"235\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-driver-649163649/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-2740386764\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":172,\"memory\":169},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-xr85j\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"8af6b44a-3a5d-40d2-bcfa-91ed64bd59f0\",\"resourceVersion\":\"9342048\",\"generation\":9,\"creationTimestamp\":\"2025-05-14T00:26:11Z\",\"labels\":{\"pipeline/runid\":\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"workflows.argoproj.io/completed\":\"true\",\"workflows.argoproj.io/phase\":\"Succeeded\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:19:37.250Z (bb82d)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:26:11Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:28:27Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/completed\":{},\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"5/5\",\"nodes\":{\"pod-log-pipeline-advance-version-xr85j\":{\"id\":\"pod-log-pipeline-advance-version-xr85j\",\"name\":\"pod-log-pipeline-advance-version-xr85j\",\"displayName\":\"pod-log-pipeline-advance-version-xr85j\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"5/5\",\"resourcesDuration\":{\"cpu\":172,\"memory\":169},\"children\":[\"pod-log-pipeline-advance-version-xr85j-4218789953\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-1074076446\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-1074076446\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github-driver\",\"displayName\":\"upload-to-github-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:27:52Z\",\"finishedAt\":\"2025-05-14T00:27:56Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"235\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-driver-1074076446/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-3383435085\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-1664075631\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-1664075631\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-2740386764\",\"startedAt\":\"2025-05-14T00:26:31Z\",\"finishedAt\":\"2025-05-14T00:27:43Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":138,\"memory\":138},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-impl-1664075631/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-1074076446\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-2740386764\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-2740386764\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:26:31Z\",\"finishedAt\":\"2025-05-14T00:27:52Z\",\"progress\":\"3/3\",\"resourcesDuration\":{\"cpu\":165,\"memory\":164},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-1664075631\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-1664075631\"]},\"pod-log-pipeline-advance-version-xr85j-319900280\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-319900280\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3383435085\",\"startedAt\":\"2025-05-14T00:28:03Z\",\"finishedAt\":\"2025-05-14T00:28:18Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"}]},\"outputs\":{\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-impl-319900280/main.log\"}}],\"exitCode\":\"0\"},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-3383435085\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-3383435085\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.upload-to-github\",\"displayName\":\"upload-to-github\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:28:03Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":24,\"memory\":24},\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"237\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"name\\\\\\\":\\\\\\\"46\\\\\\\", \\\\\\\"type\\\\\\\":{\\\\\\\"instanceSchema\\\\\\\":\\\\\\\"\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\", \\\\\\\"metadata\\\\\\\":{\\\\\\\"display_name\\\\\\\":\\\\\\\"output_report\\\\\\\"}}]}}, \\\\\\\"parameterValues\\\\\\\":{\\\\\\\"branch\\\\\\\":\\\\\\\"report\\\\\\\", \\\\\\\"github_token\\\\\\\":\\\\\\\"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\\\\\\\", \\\\\\\"repo_url\\\\\\\":\\\\\\\"https://github.com/Rosa1026/Kubeflow.git\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"report_file\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}, \\\\\\\"parameters\\\\\\\":{\\\\\\\"branch\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"github_token\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}, \\\\\\\"repo_url\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\"}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-upload-to-github\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-3485488908\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j\",\"startedAt\":\"2025-05-14T00:26:21Z\",\"finishedAt\":\"2025-05-14T00:28:27Z\",\"progress\":\"4/4\",\"resourcesDuration\":{\"cpu\":169,\"memory\":167},\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"235\"}]},\"children\":[\"pod-log-pipeline-advance-version-xr85j-649163649\"],\"outboundNodes\":[\"pod-log-pipeline-advance-version-xr85j-319900280\"]},\"pod-log-pipeline-advance-version-xr85j-4218789953\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-4218789953\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j\",\"startedAt\":\"2025-05-14T00:26:11Z\",\"finishedAt\":\"2025-05-14T00:26:14Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"235\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-dag-driver-4218789953/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-3485488908\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-xr85j-649163649\":{\"id\":\"pod-log-pipeline-advance-version-xr85j-649163649\",\"name\":\"pod-log-pipeline-advance-version-xr85j.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-xr85j\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-xr85j-3485488908\",\"startedAt\":\"2025-05-14T00:26:21Z\",\"finishedAt\":\"2025-05-14T00:26:24Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":4,\"memory\":3},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"235\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8daa4a6b-1876-4070-882c-ccc8e2a43d5d\\\",\\\"--execution_id\\\",\\\"236\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8daa4a6b-1876-4070-882c-ccc8e2a43d5d/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(output_report: Output[Dataset],\\\\n                          log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n                          event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,NodeNotReady,OOMKilled\\\\\\\"):\\\\n\\\\n    import os\\\\n    import subprocess\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    log_kw_list = [k.strip() for k in log_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n    event_kw_list = [k.strip() for k in event_keywords.split(\\\\\\\",\\\\\\\") if k.strip()]\\\\n\\\\n    def highlight_keywords(text, keywords):\\\\n        for kw in keywords:\\\\n            text = text.replace(kw, f\\\\\\\"\\\\u003cspan class='highlight'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n        return text\\\\n\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    pods_output = subprocess.getoutput(\\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\")\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: 'Segoe UI', sans-serif; background-color: #f9f9f9; padding: 40px; color: #333; }}\\\\n                h1 {{ color: #2c3e50; border-bottom: 2px solid #ccc; padding-bottom: 10px; }}\\\\n                h2 {{ color: #34495e; margin-top: 40px; }}\\\\n                h3 {{ margin-top: 20px; color: #2e86de; }}\\\\n                pre {{\\\\n                    background-color: #f0f4f8;\\\\n                    padding: 12px;\\\\n                    border-left: 5px solid #3498db;\\\\n                    overflow-x: auto;\\\\n                    white-space: pre-wrap;\\\\n                }}\\\\n                section {{ margin-bottom: 40px; }}\\\\n                .highlight {{\\\\n                    color: red;\\\\n                    font-weight: bold;\\\\n                    background-color: #ffe6e6;\\\\n                    padding: 2px 4px;\\\\n                    border-radius: 4px;\\\\n                }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\u003cp\\\\u003eGenerated at: {}\\\\u003c/p\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format(datetime.now().strftime(\\\\\\\"%Y-%m-%d %H:%M:%S\\\\\\\")))\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            print(f\\\\\\\"Checking pod: {pod_name} in namespace: {namespace}\\\\\\\")\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in describe.splitlines() if any(k in l for k in log_kw_list)])\\\\n            matched_logs_raw = [l for l in logs.splitlines() if any(k in l for k in log_kw_list)]\\\\n            matched_logs = \\\\\\\"\\\\\\\\n\\\\\\\".join(matched_logs_raw[-10:])  # 최신 10줄만 표시\\\\n\\\\n            if matched_describe or matched_logs:\\\\n                found_keywords = set()\\\\n                for kw in log_kw_list:\\\\n                    if kw in matched_describe or any(kw in l for l in matched_logs_raw):\\\\n                        found_keywords.add(kw)\\\\n\\\\n                keyword_display = \\\\\\\", \\\\\\\".join(sorted(found_keywords))\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace})\\\\u003cbr\\\\u003e\\\\u003csmall\\\\u003eDetected keywords: {keyword_display}\\\\u003c/small\\\\u003e\\\\u003c/h2\\\\u003e\\\\\\\")\\\\n\\\\n                if matched_describe:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eDescribe\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_describe, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                if matched_logs:\\\\n                    f.write(f\\\\\\\"\\\\u003ch3\\\\u003eLogs (latest 10 matches)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(matched_logs, log_kw_list)}\\\\u003c/pre\\\\u003e\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = \\\\\\\"\\\\\\\\n\\\\\\\".join([l for l in events.splitlines() if any(k in l for k in event_kw_list)])\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eEvents in Namespace: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e{highlight_keywords(events, event_kw_list)}\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-xr85j/2025/05/14/pod-log-pipeline-advance-version-xr85j-system-container-driver-649163649/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-xr85j-2740386764\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"False\"},{\"type\":\"Completed\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":172,\"memory\":169},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
time="2025-05-14T00:41:18Z" level=error msg="Transient failure while syncing resource (kubeflow-user-example-com/pod-log-pipeline-advance-version-74xtx): CustomError (code: 0): Syncing Workflow (pod-log-pipeline-advance-version-74xtx): transient failure: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346466\",\"generation\":5,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:31Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":\"2025-05-14T00:40:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"244\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-dag-driver-2659084121/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-308162292\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-308162292\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"244\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-742130297\"]},\"pod-log-pipeline-advance-version-74xtx-4251627927\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-4251627927\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-908295188\",\"startedAt\":\"2025-05-14T00:40:21Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-742130297\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-742130297\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":\"2025-05-14T00:40:15Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"244\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-container-driver-742130297/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-908295188\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-908295188\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-908295188\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:21Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-4251627927\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":8,\"memory\":6},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired: CustomError (code: 0): Error while reporting workflow resource (code: Unauthenticated, message: Jwt is expired): rpc error: code = Unauthenticated desc = Jwt is expired, {\"metadata\":{\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"generateName\":\"pod-log-pipeline-advance-version-\",\"namespace\":\"kubeflow-user-example-com\",\"uid\":\"5e0c7478-1569-42ee-90ef-a9b890134317\",\"resourceVersion\":\"9346466\",\"generation\":5,\"creationTimestamp\":\"2025-05-14T00:40:01Z\",\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"workflows.argoproj.io/phase\":\"Running\"},\"annotations\":{\"pipelines.kubeflow.org/components-comp-collect-filtered-logs\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\",\"pipelines.kubeflow.org/components-comp-upload-to-github\":\"{\\\"executorLabel\\\":\\\"exec-upload-to-github\\\",\\\"inputDefinitions\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/components-root\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\",\"pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/implementations-comp-upload-to-github\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"upload_to_github\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"'  \\\\u0026\\\\u0026  python3 -m pip install --quiet --no-warn-script-location 'gitpython' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef upload_to_github(\\\\n    report_file: Input[Dataset],\\\\n    repo_url: str,\\\\n    github_token: str,\\\\n    branch: str\\\\n):\\\\n\\\\n    import subprocess\\\\n    import shutil\\\\n    import os\\\\n    from datetime import datetime\\\\n\\\\n    os.environ[\\\\\\\"GIT_ASKPASS\\\\\\\"] = \\\\\\\"echo\\\\\\\"\\\\n\\\\n    report_path = report_file.path\\\\n    print(\\\\\\\"Checking if report exists at:\\\\\\\", report_path)\\\\n    if not os.path.exists(report_path):\\\\n        raise FileNotFoundError(f\\\\\\\"{report_path} does not exist\\\\\\\")\\\\n\\\\n    # HTML 파일 이름 만들기\\\\n    timestamp = datetime.now().strftime(\\\\\\\"report-%Y%m%d-%H%M%S.html\\\\\\\")\\\\n    safe_repo_url = repo_url.replace(\\\\\\\"https://\\\\\\\", f\\\\\\\"https://{github_token}@\\\\\\\")\\\\n    repo_dir = \\\\\\\"/tmp/repo\\\\\\\"\\\\n    report_target_path = os.path.join(repo_dir, timestamp)\\\\n\\\\n    # Git clone\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"clone\\\\\\\", \\\\\\\"--branch\\\\\\\", branch, safe_repo_url, repo_dir], check=True)\\\\n    shutil.copyfile(report_path, report_target_path)\\\\n\\\\n    # Git config\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.email\\\\\\\", \\\\\\\"ci@example.com\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"config\\\\\\\", \\\\\\\"user.name\\\\\\\", \\\\\\\"CI Bot\\\\\\\"], check=True)\\\\n\\\\n    # Git commit \\\\u0026 push\\\\n    subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"add\\\\\\\", \\\\\\\".\\\\\\\"], check=True)\\\\n    result = subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"status\\\\\\\", \\\\\\\"--porcelain\\\\\\\"], capture_output=True, text=True)\\\\n\\\\n    if result.stdout.strip():\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"commit\\\\\\\", \\\\\\\"-m\\\\\\\", f\\\\\\\"Add {timestamp}\\\\\\\"], check=True)\\\\n        subprocess.run([\\\\\\\"git\\\\\\\", \\\\\\\"-C\\\\\\\", repo_dir, \\\\\\\"push\\\\\\\"], check=True)\\\\n        print(f\\\\\\\"Report committed and pushed to GitHub as {timestamp}.\\\\\\\")\\\\n    else:\\\\n        print(\\\\\\\"No changes to commit. Skipping.\\\\\\\")\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\",\"pipelines.kubeflow.org/run_name\":\"Clone of Clone of Run of pod_log_pipeline_advance_version_at_2025-05-14T00:35:04.495Z (04e57)\",\"workflows.argoproj.io/pod-name-format\":\"v2\"},\"managedFields\":[{\"manager\":\"apiserver\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:01Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\".\":{},\"f:pipelines.kubeflow.org/components-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/components-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/components-root\":{},\"f:pipelines.kubeflow.org/implementations-comp-collect-filtered-logs\":{},\"f:pipelines.kubeflow.org/implementations-comp-upload-to-github\":{},\"f:pipelines.kubeflow.org/run_name\":{}},\"f:generateName\":{},\"f:labels\":{\".\":{},\"f:pipeline/runid\":{}}},\"f:spec\":{}}},{\"manager\":\"workflow-controller\",\"operation\":\"Update\",\"apiVersion\":\"argoproj.io/v1alpha1\",\"time\":\"2025-05-14T00:40:31Z\",\"fieldsType\":\"FieldsV1\",\"fieldsV1\":{\"f:metadata\":{\"f:annotations\":{\"f:workflows.argoproj.io/pod-name-format\":{}},\"f:labels\":{\"f:workflows.argoproj.io/phase\":{}}},\"f:status\":{}}}]},\"spec\":{\"templates\":[{\"name\":\"system-container-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"task\"},{\"name\":\"container\"},{\"name\":\"parent-dag-id\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"CONTAINER\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--container\",\"{{inputs.parameters.container}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--cached_decision_path\",\"{{outputs.parameters.cached-decision.path}}\",\"--pod_spec_patch_path\",\"{{outputs.parameters.pod-spec-patch.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\",\"--kubernetes_config\",\"{{inputs.parameters.kubernetes-config}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"system-container-executor\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"},{\"name\":\"cached-decision\",\"default\":\"false\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"executor\",\"template\":\"system-container-impl\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{inputs.parameters.pod-spec-patch}}\"}]},\"when\":\"{{inputs.parameters.cached-decision}} != true\"}]}},{\"name\":\"system-container-impl\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/should-be-overridden-during-runtime\",\"command\":[\"should-be-overridden-during-runtime\"],\"envFrom\":[{\"configMapRef\":{\"name\":\"metadata-grpc-configmap\",\"optional\":true}}],\"env\":[{\"name\":\"KFP_POD_NAME\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.name\"}}},{\"name\":\"KFP_POD_UID\",\"valueFrom\":{\"fieldRef\":{\"fieldPath\":\"metadata.uid\"}}}],\"resources\":{},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]},\"volumes\":[{\"name\":\"kfp-launcher\",\"emptyDir\":{}}],\"initContainers\":[{\"name\":\"kfp-launcher\",\"image\":\"gcr.io/ml-pipeline/kfp-launcher@sha256:8fe5e6e4718f20b021736022ad3741ddf2abd82aa58c86ae13e89736fdc3f08f\",\"command\":[\"launcher-v2\",\"--copy\",\"/kfp-launcher/launch\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"100m\"}},\"volumeMounts\":[{\"name\":\"kfp-launcher\",\"mountPath\":\"/kfp-launcher\"}]}],\"podSpecPatch\":\"{{inputs.parameters.pod-spec-patch}}\"},{\"name\":\"root\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\"}]},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"collect-filtered-logs-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-collect-filtered-logs}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-collect-filtered-logs}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]}},{\"name\":\"collect-filtered-logs\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.collect-filtered-logs-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"collect-filtered-logs-driver.Succeeded\"},{\"name\":\"upload-to-github-driver\",\"template\":\"system-container-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-comp-upload-to-github}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}\"},{\"name\":\"container\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/implementations-comp-upload-to-github}}\"},{\"name\":\"parent-dag-id\",\"value\":\"{{inputs.parameters.parent-dag-id}}\"}]},\"depends\":\"collect-filtered-logs.Succeeded\"},{\"name\":\"upload-to-github\",\"template\":\"system-container-executor\",\"arguments\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.pod-spec-patch}}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"{{tasks.upload-to-github-driver.outputs.parameters.cached-decision}}\"}]},\"depends\":\"upload-to-github-driver.Succeeded\"}]}},{\"name\":\"system-dag-driver\",\"inputs\":{\"parameters\":[{\"name\":\"component\"},{\"name\":\"runtime-config\",\"default\":\"\"},{\"name\":\"task\",\"default\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}]},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"container\":{\"name\":\"\",\"image\":\"gcr.io/ml-pipeline/kfp-driver@sha256:3c0665cd36aa87e4359a4c8b6271dcba5bdd817815cd0496ed12eb5dde5fd2ec\",\"command\":[\"driver\"],\"args\":[\"--type\",\"{{inputs.parameters.driver-type}}\",\"--pipeline_name\",\"pod-log-pipeline-advance-version\",\"--run_id\",\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"--dag_execution_id\",\"{{inputs.parameters.parent-dag-id}}\",\"--component\",\"{{inputs.parameters.component}}\",\"--task\",\"{{inputs.parameters.task}}\",\"--runtime_config\",\"{{inputs.parameters.runtime-config}}\",\"--iteration_index\",\"{{inputs.parameters.iteration-index}}\",\"--execution_id_path\",\"{{outputs.parameters.execution-id.path}}\",\"--iteration_count_path\",\"{{outputs.parameters.iteration-count.path}}\",\"--condition_path\",\"{{outputs.parameters.condition.path}}\"],\"resources\":{\"limits\":{\"cpu\":\"500m\",\"memory\":\"512Mi\"},\"requests\":{\"cpu\":\"100m\",\"memory\":\"64Mi\"}}}},{\"name\":\"entrypoint\",\"inputs\":{},\"outputs\":{},\"metadata\":{\"annotations\":{\"sidecar.istio.io/inject\":\"false\"}},\"dag\":{\"tasks\":[{\"name\":\"root-driver\",\"template\":\"system-dag-driver\",\"arguments\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{{workflow.annotations.pipelines.kubeflow.org/components-root}}\"},{\"name\":\"runtime-config\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"driver-type\",\"value\":\"ROOT_DAG\"}]}},{\"name\":\"root\",\"template\":\"root\",\"arguments\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"{{tasks.root-driver.outputs.parameters.execution-id}}\"},{\"name\":\"condition\",\"value\":\"\"}]},\"depends\":\"root-driver.Succeeded\"}]}}],\"entrypoint\":\"entrypoint\",\"arguments\":{},\"serviceAccountName\":\"default-editor\",\"podMetadata\":{\"annotations\":{\"pipelines.kubeflow.org/v2_component\":\"true\"},\"labels\":{\"pipeline/runid\":\"8aac2bae-c4fb-4313-90ff-033bc305c661\",\"pipelines.kubeflow.org/v2_component\":\"true\"}}},\"status\":{\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"nodes\":{\"pod-log-pipeline-advance-version-74xtx\":{\"id\":\"pod-log-pipeline-advance-version-74xtx\",\"name\":\"pod-log-pipeline-advance-version-74xtx\",\"displayName\":\"pod-log-pipeline-advance-version-74xtx\",\"type\":\"DAG\",\"templateName\":\"entrypoint\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":null,\"progress\":\"2/3\",\"children\":[\"pod-log-pipeline-advance-version-74xtx-2659084121\"]},\"pod-log-pipeline-advance-version-74xtx-2659084121\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-2659084121\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root-driver\",\"displayName\":\"root-driver\",\"type\":\"Pod\",\"templateName\":\"system-dag-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:01Z\",\"finishedAt\":\"2025-05-14T00:40:05Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":5,\"memory\":4},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"dag\\\":{\\\"tasks\\\":{\\\"collect-filtered-logs\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}},\\\"upload-to-github\\\":{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-upload-to-github\\\"},\\\"dependentTasks\\\":[\\\"collect-filtered-logs\\\"],\\\"inputs\\\":{\\\"artifacts\\\":{\\\"report_file\\\":{\\\"taskOutputArtifact\\\":{\\\"outputArtifactKey\\\":\\\"output_report\\\",\\\"producerTask\\\":\\\"collect-filtered-logs\\\"}}},\\\"parameters\\\":{\\\"branch\\\":{\\\"componentInputParameter\\\":\\\"branch\\\"},\\\"github_token\\\":{\\\"componentInputParameter\\\":\\\"github_token\\\"},\\\"repo_url\\\":{\\\"componentInputParameter\\\":\\\"repo_url\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"upload-to-github\\\"}}}},\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"branch\\\":{\\\"defaultValue\\\":\\\"report\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"github_token\\\":{\\\"defaultValue\\\":\\\"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\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"repo_url\\\":{\\\"defaultValue\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}}}\"},{\"name\":\"runtime-config\",\"default\":\"\",\"value\":\"{\\\"parameterValues\\\":{\\\"branch\\\":\\\"report\\\",\\\"event_keywords\\\":\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\",\\\"github_token\\\":\\\"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\\\",\\\"log_keywords\\\":\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\",\\\"repo_url\\\":\\\"https://github.com/Rosa1026/Kubeflow.git\\\"}}\"},{\"name\":\"task\",\"default\":\"\",\"value\":\"\"},{\"name\":\"parent-dag-id\",\"default\":\"0\",\"value\":\"0\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"driver-type\",\"default\":\"DAG\",\"value\":\"ROOT_DAG\"}]},\"outputs\":{\"parameters\":[{\"name\":\"execution-id\",\"value\":\"244\",\"valueFrom\":{\"path\":\"/tmp/outputs/execution-id\"}},{\"name\":\"iteration-count\",\"value\":\"0\",\"valueFrom\":{\"path\":\"/tmp/outputs/iteration-count\",\"default\":\"0\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-dag-driver-2659084121/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-308162292\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-308162292\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root\",\"displayName\":\"root\",\"type\":\"DAG\",\"templateName\":\"root\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":null,\"progress\":\"1/2\",\"inputs\":{\"parameters\":[{\"name\":\"parent-dag-id\",\"value\":\"244\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-742130297\"]},\"pod-log-pipeline-advance-version-74xtx-4251627927\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-4251627927\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs.executor\",\"displayName\":\"executor\",\"type\":\"Pod\",\"templateName\":\"system-container-impl\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-908295188\",\"startedAt\":\"2025-05-14T00:40:21Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"}]},\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-742130297\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-742130297\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs-driver\",\"displayName\":\"collect-filtered-logs-driver\",\"type\":\"Pod\",\"templateName\":\"system-container-driver\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Succeeded\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:11Z\",\"finishedAt\":\"2025-05-14T00:40:15Z\",\"progress\":\"1/1\",\"resourcesDuration\":{\"cpu\":3,\"memory\":2},\"inputs\":{\"parameters\":[{\"name\":\"component\",\"value\":\"{\\\"executorLabel\\\":\\\"exec-collect-filtered-logs\\\",\\\"inputDefinitions\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"defaultValue\\\":\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"},\\\"log_keywords\\\":{\\\"defaultValue\\\":\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\",\\\"isOptional\\\":true,\\\"parameterType\\\":\\\"STRING\\\"}}},\\\"outputDefinitions\\\":{\\\"artifacts\\\":{\\\"output_report\\\":{\\\"artifactType\\\":{\\\"schemaTitle\\\":\\\"system.Dataset\\\",\\\"schemaVersion\\\":\\\"0.0.1\\\"}}}}}\"},{\"name\":\"task\",\"value\":\"{\\\"cachingOptions\\\":{},\\\"componentRef\\\":{\\\"name\\\":\\\"comp-collect-filtered-logs\\\"},\\\"inputs\\\":{\\\"parameters\\\":{\\\"event_keywords\\\":{\\\"componentInputParameter\\\":\\\"event_keywords\\\"},\\\"log_keywords\\\":{\\\"componentInputParameter\\\":\\\"log_keywords\\\"}}},\\\"taskInfo\\\":{\\\"name\\\":\\\"collect-filtered-logs\\\"}}\"},{\"name\":\"container\",\"value\":\"{\\\"args\\\":[\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"command\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\"],\\\"image\\\":\\\"python:3.9\\\"}\"},{\"name\":\"parent-dag-id\",\"value\":\"244\"},{\"name\":\"iteration-index\",\"default\":\"-1\",\"value\":\"-1\"},{\"name\":\"kubernetes-config\",\"default\":\"\",\"value\":\"\"}]},\"outputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\",\"valueFrom\":{\"path\":\"/tmp/outputs/pod-spec-patch\",\"default\":\"\"}},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\",\"valueFrom\":{\"path\":\"/tmp/outputs/cached-decision\",\"default\":\"false\"}},{\"name\":\"condition\",\"value\":\"nil\",\"valueFrom\":{\"path\":\"/tmp/outputs/condition\",\"default\":\"true\"}}],\"artifacts\":[{\"name\":\"main-logs\",\"s3\":{\"key\":\"artifacts/pod-log-pipeline-advance-version-74xtx/2025/05/14/pod-log-pipeline-advance-version-74xtx-system-container-driver-742130297/main.log\"}}],\"exitCode\":\"0\"},\"children\":[\"pod-log-pipeline-advance-version-74xtx-908295188\"],\"hostNodeName\":\"k8s-kubeflow-worker01\"},\"pod-log-pipeline-advance-version-74xtx-908295188\":{\"id\":\"pod-log-pipeline-advance-version-74xtx-908295188\",\"name\":\"pod-log-pipeline-advance-version-74xtx.root.collect-filtered-logs\",\"displayName\":\"collect-filtered-logs\",\"type\":\"DAG\",\"templateName\":\"system-container-executor\",\"templateScope\":\"local/pod-log-pipeline-advance-version-74xtx\",\"phase\":\"Running\",\"boundaryID\":\"pod-log-pipeline-advance-version-74xtx-308162292\",\"startedAt\":\"2025-05-14T00:40:21Z\",\"finishedAt\":null,\"progress\":\"0/1\",\"inputs\":{\"parameters\":[{\"name\":\"pod-spec-patch\",\"value\":\"{\\\"containers\\\":[{\\\"name\\\":\\\"main\\\",\\\"image\\\":\\\"python:3.9\\\",\\\"command\\\":[\\\"/var/run/argo/argoexec\\\",\\\"emissary\\\",\\\"--\\\",\\\"/kfp-launcher/launch\\\",\\\"--pipeline_name\\\",\\\"pod-log-pipeline-advance-version\\\",\\\"--run_id\\\",\\\"8aac2bae-c4fb-4313-90ff-033bc305c661\\\",\\\"--execution_id\\\",\\\"245\\\",\\\"--executor_input\\\",\\\"{\\\\\\\"inputs\\\\\\\":{\\\\\\\"parameterValues\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":\\\\\\\"BackOff,FailedScheduling,NodeNotReady,Evicted,OutOfmemory\\\\\\\", \\\\\\\"log_keywords\\\\\\\":\\\\\\\"CrashLoopBackOff,OOMKilled,<span class='keyword'>evicted</span>,<span class='keyword'>failed to start</span>,<span class='keyword'>deadline exceeded</span>,<span class='keyword'>node not ready</span>\\\\\\\"}}, \\\\\\\"outputs\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifacts\\\\\\\":[{\\\\\\\"type\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}, \\\\\\\"uri\\\\\\\":\\\\\\\"minio://mlpipeline/v2/artifacts/pod-log-pipeline-advance-version/8aac2bae-c4fb-4313-90ff-033bc305c661/collect-filtered-logs/output_report\\\\\\\"}]}}, \\\\\\\"outputFile\\\\\\\":\\\\\\\"/tmp/kfp_outputs/output_metadata.json\\\\\\\"}}\\\",\\\"--component_spec\\\",\\\"{\\\\\\\"inputDefinitions\\\\\\\":{\\\\\\\"parameters\\\\\\\":{\\\\\\\"event_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}, \\\\\\\"log_keywords\\\\\\\":{\\\\\\\"parameterType\\\\\\\":\\\\\\\"STRING\\\\\\\", \\\\\\\"defaultValue\\\\\\\":\\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\", \\\\\\\"isOptional\\\\\\\":true}}}, \\\\\\\"outputDefinitions\\\\\\\":{\\\\\\\"artifacts\\\\\\\":{\\\\\\\"output_report\\\\\\\":{\\\\\\\"artifactType\\\\\\\":{\\\\\\\"schemaTitle\\\\\\\":\\\\\\\"system.Dataset\\\\\\\", \\\\\\\"schemaVersion\\\\\\\":\\\\\\\"0.0.1\\\\\\\"}}}}, \\\\\\\"executorLabel\\\\\\\":\\\\\\\"exec-collect-filtered-logs\\\\\\\"}\\\",\\\"--pod_name\\\",\\\"$(KFP_POD_NAME)\\\",\\\"--pod_uid\\\",\\\"$(KFP_POD_UID)\\\",\\\"--mlmd_server_address\\\",\\\"$(METADATA_GRPC_SERVICE_HOST)\\\",\\\"--mlmd_server_port\\\",\\\"$(METADATA_GRPC_SERVICE_PORT)\\\",\\\"--\\\"],\\\"args\\\":[\\\"sh\\\",\\\"-c\\\",\\\"\\\\nif ! [ -x \\\\\\\"$(command -v pip)\\\\\\\" ]; then\\\\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\\\\nfi\\\\n\\\\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet --no-warn-script-location 'kfp==2.13.0' '--no-deps' 'typing-extensions\\\\u003e=3.7.4,\\\\u003c5; python_version\\\\u003c\\\\\\\"3.9\\\\\\\"' \\\\u0026\\\\u0026 \\\\\\\"$0\\\\\\\" \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"sh\\\",\\\"-ec\\\",\\\"program_path=$(mktemp -d)\\\\n\\\\nprintf \\\\\\\"%s\\\\\\\" \\\\\\\"$0\\\\\\\" \\\\u003e \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"\\\\n_KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         \\\\\\\"$program_path/ephemeral_component.py\\\\\\\"                         \\\\\\\"$@\\\\\\\"\\\\n\\\",\\\"\\\\nimport kfp\\\\nfrom kfp import dsl\\\\nfrom kfp.dsl import *\\\\nfrom typing import *\\\\n\\\\ndef collect_filtered_logs(\\\\n    output_report: Output[Dataset],\\\\n    log_keywords: str = \\\\\\\"crash,error,fail,<span class='keyword'>oomkilled</span>,<span class='keyword'>evicted</span>\\\\\\\",\\\\n    event_keywords: str = \\\\\\\"CrashLoopBackOff,Failed,Unhealthy,Evicted,OOME\\\\\\\"\\\\n):\\\\n    import subprocess\\\\n    import os\\\\n    import json\\\\n    from datetime import datetime\\\\n\\\\n    tmp_report_path = \\\\\\\"/tmp/report.html\\\\\\\"\\\\n    excluded_namespace = \\\\\\\"kubeflow-user-example-com\\\\\\\"\\\\n\\\\n    # kubectl 설치\\\\n    subprocess.run([\\\\\\\"apt-get\\\\\\\", \\\\\\\"update\\\\\\\", \\\\\\\"-y\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\n        \\\\\\\"curl\\\\\\\", \\\\\\\"-LO\\\\\\\", \\\\\\\"https://storage.googleapis.com/kubernetes-release/release/v1.24.0/bin/linux/amd64/kubectl\\\\\\\"\\\\n    ], check=True)\\\\n    subprocess.run([\\\\\\\"chmod\\\\\\\", \\\\\\\"+x\\\\\\\", \\\\\\\"kubectl\\\\\\\"], check=True)\\\\n    subprocess.run([\\\\\\\"mv\\\\\\\", \\\\\\\"kubectl\\\\\\\", \\\\\\\"/usr/local/bin/\\\\\\\"], check=True)\\\\n\\\\n    log_kw_list = [k.strip().lower() for k in log_keywords.split(\\\\\\\",\\\\\\\")]\\\\n    event_kw_list = [k.strip().lower() for k in event_keywords.split(\\\\\\\",\\\\\\\")]\\\\n\\\\n    seen_namespaces = set()\\\\n    namespace_events = {}\\\\n\\\\n    # Pod 목록 수집\\\\n    pods_output = subprocess.getoutput(\\\\n        \\\\\\\"kubectl get pods --all-namespaces -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name' --no-headers\\\\\\\"\\\\n    )\\\\n    pod_lines = pods_output.strip().split(\\\\\\\"\\\\\\\\n\\\\\\\")\\\\n\\\\n    # HTML 작성 시작\\\\n    with open(tmp_report_path, \\\\\\\"w\\\\\\\") as f:\\\\n        f.write(\\\\\\\"\\\\\\\"\\\\\\\"\\\\n        \\\\u003chtml\\\\u003e\\\\n        \\\\u003chead\\\\u003e\\\\n            \\\\u003cmeta charset=\\\\\\\"UTF-8\\\\\\\"\\\\u003e\\\\n            \\\\u003cstyle\\\\u003e\\\\n                body {{ font-family: Arial, sans-serif; background-color: #f9f9f9; padding: 20px; }}\\\\n                h1 {{ color: #2c3e50; }}\\\\n                h2 {{ color: #34495e; border-bottom: 1px solid #ccc; padding-bottom: 5px; }}\\\\n                h3 {{ color: #2980b9; }}\\\\n                pre {{ background-color: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; white-space: pre-wrap; word-wrap: break-word; }}\\\\n                section {{ margin-bottom: 30px; }}\\\\n                .keyword {{ color: red; font-weight: bold; }}\\\\n            \\\\u003c/style\\\\u003e\\\\n        \\\\u003c/head\\\\u003e\\\\n        \\\\u003cbody\\\\u003e\\\\n        \\\\u003ch1\\\\u003eKubernetes 장애 점검 리포트\\\\u003c/h1\\\\u003e\\\\n        \\\\\\\"\\\\\\\"\\\\\\\".format())\\\\n\\\\n        for line in pod_lines:\\\\n            if not line.strip():\\\\n                continue\\\\n            try:\\\\n                namespace, pod_name = line.split()\\\\n            except ValueError:\\\\n                continue\\\\n\\\\n            if namespace == excluded_namespace:\\\\n                continue\\\\n\\\\n            describe = subprocess.getoutput(f\\\\\\\"kubectl describe pod {pod_name} -n {namespace}\\\\\\\")\\\\n            logs = subprocess.getoutput(f\\\\\\\"kubectl logs {pod_name} -n {namespace}\\\\\\\")\\\\n\\\\n            matched_describe_lines = [\\\\n                l for l in describe.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ]\\\\n            matched_log_lines = [\\\\n                l for l in logs.splitlines()\\\\n                if any(k in l.lower() for k in log_kw_list)\\\\n            ][-10:]  # 최근 10줄\\\\n\\\\n            matched_keywords = set()\\\\n            for line in matched_describe_lines + matched_log_lines:\\\\n                for kw in log_kw_list:\\\\n                    if kw in line.lower():\\\\n                        matched_keywords.add(kw)\\\\n\\\\n            if matched_describe_lines or matched_log_lines:\\\\n                f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003ePod: {pod_name} (Namespace: {namespace}) - 감지된 키워드: {', '.join(matched_keywords)}\\\\u003c/h2\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_describe_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eDescribe 결과\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_describe_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                if matched_log_lines:\\\\n                    f.write(\\\\\\\"\\\\u003ch3\\\\u003eLog 결과 (최근 10줄)\\\\u003c/h3\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n                    for line in matched_log_lines:\\\\n                        for kw in log_kw_list:\\\\n                            if kw in line.lower():\\\\n                                line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                        f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n                    f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\\\\\n\\\\\\\")\\\\n                f.write(\\\\\\\"\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n            if namespace not in seen_namespaces:\\\\n                events = subprocess.getoutput(f\\\\\\\"kubectl get events -n {namespace}\\\\\\\")\\\\n                matched_events = [\\\\n                    l for l in events.splitlines()\\\\n                    if any(k in l.lower() for k in event_kw_list)\\\\n                ]\\\\n                if matched_events:\\\\n                    namespace_events[namespace] = matched_events\\\\n                seen_namespaces.add(namespace)\\\\n\\\\n        for ns, events in namespace_events.items():\\\\n            f.write(f\\\\\\\"\\\\u003csection\\\\u003e\\\\u003ch2\\\\u003eNamespace 이벤트: {ns}\\\\u003c/h2\\\\u003e\\\\u003cpre\\\\u003e\\\\\\\")\\\\n            for line in events:\\\\n                for kw in event_kw_list:\\\\n                    if kw in line.lower():\\\\n                        line = line.replace(kw, f\\\\\\\"\\\\u003cspan class='keyword'\\\\u003e{kw}\\\\u003c/span\\\\u003e\\\\\\\")\\\\n                f.write(f\\\\\\\"{line}\\\\\\\\n\\\\\\\")\\\\n            f.write(\\\\\\\"\\\\u003c/pre\\\\u003e\\\\u003c/section\\\\u003e\\\\\\\\n\\\\\\\")\\\\n\\\\n        f.write(\\\\\\\"\\\\u003c/body\\\\u003e\\\\u003c/html\\\\u003e\\\\\\\")\\\\n\\\\n    subprocess.run([\\\\\\\"cp\\\\\\\", tmp_report_path, output_report.path], check=True)\\\\n\\\\n\\\",\\\"--executor_input\\\",\\\"{{$}}\\\",\\\"--function_to_execute\\\",\\\"collect_filtered_logs\\\"],\\\"resources\\\":{}}]}\"},{\"name\":\"cached-decision\",\"default\":\"false\",\"value\":\"false\"}]},\"children\":[\"pod-log-pipeline-advance-version-74xtx-4251627927\"]}},\"conditions\":[{\"type\":\"PodRunning\",\"status\":\"True\"}],\"resourcesDuration\":{\"cpu\":8,\"memory\":6},\"artifactRepositoryRef\":{\"default\":true,\"artifactRepository\":{\"archiveLogs\":true,\"s3\":{\"endpoint\":\"minio-service.kubeflow:9000\",\"bucket\":\"mlpipeline\",\"insecure\":true,\"accessKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"accesskey\"},\"secretKeySecret\":{\"name\":\"mlpipeline-minio-artifact\",\"key\":\"secretkey\"},\"keyFormat\":\"artifacts/{{workflow.name}}/{{workflow.creationTimestamp.Y}}/{{workflow.creationTimestamp.m}}/{{workflow.creationTimestamp.d}}/{{pod.name}}\"}}},\"artifactGCStatus\":{\"notSpecified\":true}}}: rpc error: code = Unauthenticated desc = Jwt is expired"
</pre>
</section>
</body></html>